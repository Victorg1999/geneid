#! /usr/local/bin/gawk -f
# rgs, imim.sb, aug 98
BEGIN{
  # input file data structure
  seqname  = 1;
  source   = 2;
  feature  = 3;
  start    = 4;
  end      = 5;
  score    = 6;
  strand   = 7;
  frame    = 8;

 # gff formatted output
 # actually blanks should be \t
  gff_format="%-10s %-10s %-10s %9d %9d %6d  %1s  %1s\n";


# output filenames
  output[1]=ARGV[1];  
  output[2]=ARGV[2];  


 cutoff=ARGV[3];
  
  ARGV[1]=ARGV[2]=ARGV[3]="";
}

substr($1,1,1)!="#"{
  split($seqname,seqname_,":");
  split($feature,feature_,":");
  split($start,start_,":");
  split($end,end_,":");
  split($frame,frame_,":");
  split($strand,strand_,":");

  if ($score > cutoff) {
    printf gff_format, seqname_[1], $source, feature_[1], start_[1], end_[1], $score, strand_[1], frame_[1]  > output[1];

    printf gff_format, seqname_[2], $source, feature_[2], start_[2], end_[2], $score, strand_[2], frame_[2] > output[2];
  }
}
