<?xml version="1.0" encoding="UTF-8"?>
<s:scufl xmlns:s="http://org.embl.ebi.escience/xscufl/0.1alpha" version="0.2" log="0">
  <s:workflowdescription lsid="urn:lsid:www.mygrid.org.uk:operation:SSAVFCN82D1" author="Arnaud Kerhornou" title="Clustering of co-expressed genes in subsets showing similar configurations of TFBSs.">Input: 
  * a list of Ensembl gene identifiers. It is also possible to give any external gene identifiers Ensembl recognizes (e.g. RefSeq ids)
  * a namespace.

Output: 
  * a list of gene sub-clusters
  * foreach cluster, a TF alignment map that defines a consensus transcriptional regulatory pattern.

See, http://genome.imim.es/webservices/workflows.html page for more details.</s:workflowdescription>
  <s:processor name="parse_moby_meta">
    <s:local>org.embl.ebi.escience.scuflworkers.biomoby.ExtractMobyData</s:local>
  </s:processor>
  <s:processor name="parse_moby_upstream_sequences">
    <s:local>org.biomoby.client.taverna.plugin.ExtractMobyData</s:local>
  </s:processor>
  <s:processor name="parse_moby_gene_clusters">
    <s:local>org.biomoby.client.taverna.plugin.ExtractMobyData</s:local>
  </s:processor>
  <s:processor name="decode_image_gff2jpeg">
    <s:local>org.embl.ebi.escience.scuflworkers.java.DecodeBase64</s:local>
  </s:processor>
  <s:processor name="parse_moby_multi_meta_gff">
    <s:local>org.biomoby.client.taverna.plugin.ExtractMobyData</s:local>
  </s:processor>
  <s:processor name="parse_moby_multiple_meta">
    <s:local>org.biomoby.client.taverna.plugin.ExtractMobyData</s:local>
  </s:processor>
  <s:processor name="parse_moby_matscan_gff">
    <s:local>org.embl.ebi.escience.scuflworkers.biomoby.ExtractMobyData</s:local>
  </s:processor>
  <s:processor name="parse_moby_image_gff2jpeg">
    <s:local>org.biomoby.client.taverna.plugin.ExtractMobyData</s:local>
  </s:processor>
  <s:processor name="parse_moby_meta_gff">
    <s:local>org.biomoby.client.taverna.plugin.ExtractMobyData</s:local>
  </s:processor>
  <s:processor name="parse_moby_score_matrix">
    <s:local>org.embl.ebi.escience.scuflworkers.biomoby.ExtractMobyData</s:local>
  </s:processor>
  <s:processor name="identifier" boring="true">
    <s:stringconstant />
  </s:processor>
  <s:processor name="StringArticleName" boring="true">
    <s:stringconstant>content</s:stringconstant>
  </s:processor>
  <s:processor name="runGFF2JPEG">
    <s:description>Runs gff2ps software to vizualize a set of GFF annotations maps. It returns an encoded image in JPEG format.</s:description>
    <s:biomobywsdl>
      <s:mobyEndpoint>http://mobycentral.icapture.ubc.ca/cgi-bin/MOBY05/mobycentral.pl</s:mobyEndpoint>
      <s:serviceName>runGFF2JPEG</s:serviceName>
      <s:authorityName>genome.imim.es</s:authorityName>
    </s:biomobywsdl>
  </s:processor>
  <s:processor name="fromGenericSequenceCollectionToFASTA">
    <s:description>Converts a collection of generic sequences into FASTA sequences</s:description>
    <s:biomobywsdl>
      <s:mobyEndpoint>http://mobycentral.icapture.ubc.ca/cgi-bin/MOBY05/mobycentral.pl</s:mobyEndpoint>
      <s:serviceName>fromGenericSequenceCollectionToFASTA</s:serviceName>
      <s:authorityName>genome.imim.es</s:authorityName>
    </s:biomobywsdl>
  </s:processor>
  <s:processor name="runMultiPairwiseMetaAlignment">
    <s:description>runMultiPairwiseMetaAlignment runs Meta-alignment software on a multiple running mode, receiving a collection of maps, making pairs of them and, foreach pair, it produces alignments of sequences of TF binding sites. It returns the predictions in 'Meta-alignment' format. You can use runMatScanGFF to produce the input GFF files</s:description>
    <s:biomobywsdl>
      <s:mobyEndpoint>http://mobycentral.icapture.ubc.ca/cgi-bin/MOBY05/mobycentral.pl</s:mobyEndpoint>
      <s:serviceName>runMultiPairwiseMetaAlignment</s:serviceName>
      <s:authorityName>genome.imim.es</s:authorityName>
      <s:Parameter s:name="lamba penalty">0.1</s:Parameter>
      <s:Parameter s:name="alpha penalty">0.5</s:Parameter>
      <s:Parameter s:name="mu penalty">0.1</s:Parameter>
    </s:biomobywsdl>
  </s:processor>
  <s:processor name="runMultiPairwiseMetaAlignmentGFF">
    <s:description>Runs Meta-alignment software on a multiple running mode, receiving a collection of maps, making pairs of them and, foreach pair, producing, in GFF format, alignments of sequences of TF binding sites</s:description>
    <s:biomobywsdl>
      <s:mobyEndpoint>http://mobycentral.icapture.ubc.ca/cgi-bin/MOBY05/mobycentral.pl</s:mobyEndpoint>
      <s:serviceName>runMultiPairwiseMetaAlignmentGFF</s:serviceName>
      <s:authorityName>genome.imim.es</s:authorityName>
      <s:Parameter s:name="mu penalty">0.1</s:Parameter>
      <s:Parameter s:name="lamba penalty">0.1</s:Parameter>
      <s:Parameter s:name="alpha penalty">0.5</s:Parameter>
    </s:biomobywsdl>
  </s:processor>
  <s:processor name="runMatScanGFFCollection">
    <s:description>Reports putative predicted motifs on a given collection of DNA sequences. The motifs collections currently available are Transcription Factor binding site collections. The predicted set of motifs are reported in GFF format. If you want to give MatScan output to Meta-alignment program, you MUST use the 'log-likelihood matrix' mode.</s:description>
    <s:biomobywsdl>
      <s:mobyEndpoint>http://mobycentral.icapture.ubc.ca/cgi-bin/MOBY05/mobycentral.pl</s:mobyEndpoint>
      <s:serviceName>runMatScanGFFCollection</s:serviceName>
      <s:authorityName>genome.imim.es</s:authorityName>
      <s:Parameter s:name="matrix mode">log-likelihood</s:Parameter>
      <s:Parameter s:name="strand">Both</s:Parameter>
      <s:Parameter s:name="threshold">0.92</s:Parameter>
      <s:Parameter s:name="motif database">Transfac</s:Parameter>
    </s:biomobywsdl>
  </s:processor>
  <s:processor name="fromMetaAlignmentsToTextScoreMatrix">
    <s:description>Parses a collection of meta-alignment outputs to produce a text-formatted sequence similarity score matrix</s:description>
    <s:biomobywsdl>
      <s:mobyEndpoint>http://mobycentral.icapture.ubc.ca/cgi-bin/MOBY05/mobycentral.pl</s:mobyEndpoint>
      <s:serviceName>fromMetaAlignmentsToTextScoreMatrix</s:serviceName>
      <s:authorityName>genome.imim.es</s:authorityName>
    </s:biomobywsdl>
  </s:processor>
  <s:processor name="runMatScanGFFCollection1">
    <s:description>Analyzes a collection of DNA sequences for putative transcription factor binding sites from Transfac or Jaspar and reports them in GFF format</s:description>
    <s:biomobywsdl>
      <s:mobyEndpoint>http://mobycentral.icapture.ubc.ca/cgi-bin/MOBY05/mobycentral.pl</s:mobyEndpoint>
      <s:serviceName>runMatScanGFFCollection</s:serviceName>
      <s:authorityName>genome.imim.es</s:authorityName>
      <s:Parameter s:name="matrix mode">log-likelihood</s:Parameter>
      <s:Parameter s:name="strand">Both</s:Parameter>
      <s:Parameter s:name="threshold">0.92</s:Parameter>
      <s:Parameter s:name="motif database">Transfac</s:Parameter>
    </s:biomobywsdl>
  </s:processor>
  <s:processor name="runMultiMetaAlignmentGFF">
    <s:description>Runs Multiple-Meta-Alignment software to perform multiple non-collinear transcription factor map alignments of promoter regions. It returns the multiple-meta-alignment output in GFF format.</s:description>
    <s:biomobywsdl>
      <s:mobyEndpoint>http://mobycentral.icapture.ubc.ca/cgi-bin/MOBY05/mobycentral.pl</s:mobyEndpoint>
      <s:serviceName>runMultiMetaAlignmentGFF</s:serviceName>
      <s:authorityName>genome.imim.es</s:authorityName>
      <s:Parameter s:name="mu penalty">0.1</s:Parameter>
      <s:Parameter s:name="lamba penalty">0.1</s:Parameter>
      <s:Parameter s:name="alpha penalty">0.5</s:Parameter>
      <s:Parameter s:name="NoN-colinear penalty">100</s:Parameter>
      <s:Parameter s:name="gap penalty">-10</s:Parameter>
    </s:biomobywsdl>
  </s:processor>
  <s:processor name="getUpstreamSeqFromEnsembl1">
    <s:description>Sequence retrieval tool from Ensembl database. It returns the upstream sequence of a given set of Ensembl gene identifiers. These identifiers could be external ones, such as Refseq Ids or Affymetrix ids.</s:description>
    <s:biomobywsdl>
      <s:mobyEndpoint>http://mobycentral.icapture.ubc.ca/cgi-bin/MOBY05/mobycentral.pl</s:mobyEndpoint>
      <s:serviceName>getUpstreamSeqFromEnsembl</s:serviceName>
      <s:authorityName>genome.imim.es</s:authorityName>
      <s:Parameter s:name="upstream length">1000</s:Parameter>
      <s:Parameter s:name="intergenic only">False</s:Parameter>
      <s:Parameter s:name="downstream length" />
      <s:Parameter s:name="organism">Homo sapiens</s:Parameter>
    </s:biomobywsdl>
  </s:processor>
  <s:processor name="runMultiMetaAlignment">
    <s:description>Runs Multiple-Meta-Alignment software to perform multiple non-collinear transcription factor map alignments of promoter regions.</s:description>
    <s:biomobywsdl>
      <s:mobyEndpoint>http://mobycentral.icapture.ubc.ca/cgi-bin/MOBY05/mobycentral.pl</s:mobyEndpoint>
      <s:serviceName>runMultiMetaAlignment</s:serviceName>
      <s:authorityName>genome.imim.es</s:authorityName>
      <s:Parameter s:name="alpha penalty">0.5</s:Parameter>
      <s:Parameter s:name="lamba penalty">0.1</s:Parameter>
      <s:Parameter s:name="NoN-colinear penalty">100</s:Parameter>
      <s:Parameter s:name="gap penalty">-10</s:Parameter>
      <s:Parameter s:name="mu penalty">0.1</s:Parameter>
    </s:biomobywsdl>
  </s:processor>
  <s:processor name="getUpstreamSeqFromEnsembl">
    <s:description>Sequence retrieval tool from Ensembl database. It returns the upstream sequence of a given set of Ensembl gene identifiers. These identifiers could be external ones, such as Refseq Ids or Affymetrix ids.
 In case you select the orthologous mode, it will returns the upstream sequence of all orthologous genes of a given input gene (only one input gene identifier in that case)</s:description>
    <s:biomobywsdl>
      <s:mobyEndpoint>http://mobycentral.icapture.ubc.ca/cgi-bin/MOBY05/mobycentral.pl</s:mobyEndpoint>
      <s:serviceName>getUpstreamSeqFromEnsembl</s:serviceName>
      <s:authorityName>genome.imim.es</s:authorityName>
      <s:Parameter s:name="upstream length">1000</s:Parameter>
      <s:Parameter s:name="intergenic only">False</s:Parameter>
      <s:Parameter s:name="downstream length" />
      <s:Parameter s:name="organism">Homo sapiens</s:Parameter>
    </s:biomobywsdl>
  </s:processor>
  <s:processor name="String">
    <s:description>a string</s:description>
    <s:biomobyobject>
      <s:mobyEndpoint>http://mobycentral.icapture.ubc.ca/cgi-bin/MOBY05/mobycentral.pl</s:mobyEndpoint>
      <s:serviceName>String</s:serviceName>
      <s:authorityName />
    </s:biomobyobject>
  </s:processor>
  <s:processor name="List_Of_GeneIdentifiers">
    <s:description>Fractional solvation report</s:description>
    <s:biomobyobject>
      <s:mobyEndpoint>http://mobycentral.icapture.ubc.ca/cgi-bin/MOBY05/mobycentral.pl</s:mobyEndpoint>
      <s:serviceName>List_Text</s:serviceName>
      <s:authorityName />
    </s:biomobyobject>
  </s:processor>
  <s:processor name="runKMeansClustering">
    <s:description>Runs cluster v3.0 to that implements k-means algorithm to cluster genes together. The input is a gene score matrix represented as a MicroArrayData_Text object.</s:description>
    <s:biomobywsdl>
      <s:mobyEndpoint>http://mobycentral.icapture.ubc.ca/cgi-bin/MOBY05/mobycentral.pl</s:mobyEndpoint>
      <s:serviceName>runKMeansClustering</s:serviceName>
      <s:authorityName>genome.imim.es</s:authorityName>
      <s:Parameter s:name="iterations number">200</s:Parameter>
      <s:Parameter s:name="gene centering">None</s:Parameter>
      <s:Parameter s:name="clusters number">2</s:Parameter>
    </s:biomobywsdl>
  </s:processor>
  <s:link source="String:mobyData" sink="List_Of_GeneIdentifiers:String(content)" />
  <s:link source="StringArticleName:value" sink="String:article name" />
  <s:link source="fromGenericSequenceCollectionToFASTA:FASTA(sequences)" sink="parse_moby_upstream_sequences:mobydata" />
  <s:link source="fromMetaAlignmentsToTextScoreMatrix:MicroArrayData_Text(microarraydata)" sink="parse_moby_score_matrix:mobydata" />
  <s:link source="fromMetaAlignmentsToTextScoreMatrix:MicroArrayData_Text(microarraydata)" sink="runKMeansClustering:MicroArrayData_Text(gene_score_matrix)" />
  <s:link source="getUpstreamSeqFromEnsembl1:CommentedDNASequence(Collection - 'upstream_sequences')" sink="runMatScanGFFCollection1:DNASequence(Collection - 'sequences')" />
  <s:link source="getUpstreamSeqFromEnsembl:CommentedDNASequence(Collection - 'upstream_sequences')" sink="fromGenericSequenceCollectionToFASTA:GenericSequence(Collection - 'sequences')" />
  <s:link source="list_of_geneIdentifiers_input" sink="String:value" />
  <s:link source="getUpstreamSeqFromEnsembl:CommentedDNASequence(Collection - 'upstream_sequences')" sink="runMatScanGFFCollection:DNASequence(Collection - 'sequences')" />
  <s:link source="identifier:value" sink="List_Of_GeneIdentifiers:id" />
  <s:link source="identifier:value" sink="String:id" />
  <s:link source="namespace" sink="List_Of_GeneIdentifiers:namespace" />
  <s:link source="List_Of_GeneIdentifiers:mobyData" sink="getUpstreamSeqFromEnsembl:List_Text(genes)" />
  <s:link source="parse_moby_image_gff2jpeg:value" sink="decode_image_gff2jpeg:base64" />
  <s:link source="runGFF2JPEG:b64_encoded_jpeg(image)" sink="parse_moby_image_gff2jpeg:mobydata" />
  <s:link source="runKMeansClustering:List_Text(Collection - 'gene_clusters' As Simples)" sink="getUpstreamSeqFromEnsembl1:List_Text(genes)" />
  <s:link source="runKMeansClustering:List_Text(Collection - 'gene_clusters' As Simples)" sink="parse_moby_gene_clusters:mobydata" />
  <s:link source="runMatScanGFFCollection1:GFF(Collection - 'matscan_predictions')" sink="runMultiMetaAlignment:GFF(Collection - 'maps')" />
  <s:link source="runMatScanGFFCollection:GFF(Collection - 'matscan_predictions')" sink="runMultiPairwiseMetaAlignmentGFF:GFF(Collection - 'maps')" />
  <s:link source="runMultiPairwiseMetaAlignmentGFF:GFF(Collection - 'meta_predictions' As Simples)" sink="parse_moby_meta_gff:mobydata" />
  <s:link source="decode_image_gff2jpeg:bytes" sink="TFBSs_cluster_image" />
  <s:link source="parse_moby_gene_clusters:value" sink="gene_clusters" />
  <s:link source="parse_moby_matscan_gff:value" sink="matscan_gff" />
  <s:link source="parse_moby_meta:value" sink="meta-alignment" />
  <s:link source="parse_moby_meta_gff:value" sink="meta-alignment_gff" />
  <s:link source="parse_moby_multi_meta_gff:value" sink="MultiMeta_alignment_gff" />
  <s:link source="parse_moby_multiple_meta:value" sink="MultiMeta_alignment" />
  <s:link source="parse_moby_score_matrix:value" sink="score_matrix" />
  <s:link source="parse_moby_upstream_sequences:value" sink="upstream_sequences_fasta" />
  <s:link source="runMatScanGFFCollection1:GFF(Collection - 'matscan_predictions')" sink="runMultiMetaAlignmentGFF:GFF(Collection - 'maps')" />
  <s:link source="runMatScanGFFCollection:GFF(Collection - 'matscan_predictions' As Simples)" sink="parse_moby_matscan_gff:mobydata" />
  <s:link source="runMatScanGFFCollection:GFF(Collection - 'matscan_predictions')" sink="runMultiPairwiseMetaAlignment:GFF(Collection - 'maps')" />
  <s:link source="runMultiMetaAlignment:Meta_Alignment_Text(multi_meta_predictions)" sink="parse_moby_multiple_meta:mobydata" />
  <s:link source="runMultiMetaAlignmentGFF:GFF(multi_meta_predictions)" sink="parse_moby_multi_meta_gff:mobydata" />
  <s:link source="runMultiMetaAlignmentGFF:GFF(multi_meta_predictions)" sink="runGFF2JPEG:GFF(Collection - 'maps')" />
  <s:link source="runMultiPairwiseMetaAlignment:Meta_Alignment_Text(Collection - 'meta_predictions' As Simples)" sink="parse_moby_meta:mobydata" />
  <s:link source="runMultiPairwiseMetaAlignment:Meta_Alignment_Text(Collection - 'meta_predictions')" sink="fromMetaAlignmentsToTextScoreMatrix:Meta_Alignment_Text(Collection - 'similarity_results')" />
  <s:source name="namespace" />
  <s:source name="list_of_geneIdentifiers_input" />
  <s:sink name="matscan_gff" />
  <s:sink name="meta-alignment" />
  <s:sink name="score_matrix" />
  <s:sink name="upstream_sequences_fasta" />
  <s:sink name="gene_clusters" />
  <s:sink name="MultiMeta_alignment">
    <s:metadata>
      <s:mimeTypes>
        <s:mimeType>text/xml</s:mimeType>
      </s:mimeTypes>
    </s:metadata>
  </s:sink>
  <s:sink name="MultiMeta_alignment_gff">
    <s:metadata>
      <s:mimeTypes>
        <s:mimeType>text/xml</s:mimeType>
      </s:mimeTypes>
    </s:metadata>
  </s:sink>
  <s:sink name="TFBSs_cluster_image">
    <s:metadata>
      <s:mimeTypes>
        <s:mimeType>image/*</s:mimeType>
      </s:mimeTypes>
    </s:metadata>
  </s:sink>
  <s:sink name="meta-alignment_gff" />
</s:scufl>

