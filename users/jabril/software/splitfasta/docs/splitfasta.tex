% -*- mode: Noweb; noweb-code-mode: perl-mode; tab-width: 4 -*-
\documentclass[11pt]{article}
%
%2345678901234567890123456789012345678901234567890123456789012345678901234567890
%        1         2         3         4         5         6         7         8
%
% # $Id: splitfasta.tex,v 1.1 2001-09-06 18:26:09 jabril Exp $ 
%
\usepackage{noweb}
\usepackage[a4paper,offset={0pt,0pt},hmargin={2cm,2cm},vmargin={1cm,1cm}]{geometry}
\usepackage{graphics}
\usepackage[dvips]{graphicx}
%% pstricks
\usepackage[dvips]{pstcol}
\usepackage{pstricks}
%\usepackage{pst-node}
%\usepackage{pst-char}
%\usepackage{pst-grad}
%% bibliography
\usepackage{natbib}
%% latex2html
\usepackage{url}
\usepackage{html}     
\usepackage{htmllist} 
%% tables    
\usepackage{dcolumn}
%\usepackage{colortbl}
%\usepackage{multirow}
%\usepackage{hhline}
%\usepackage{tabularx}
%% seminar
%\usepackage{semcolor,semlayer,semrot,semhelv,sem-page,slidesec}
%% draft watermark
%\usepackage[all,dvips]{draftcopy}
%\draftcopySetGrey{0.9}
%\draftcopyName{CONFIDENTIAL}{100}
%% layout
\usepackage{fancyhdr} % Do not use \usepackage{fancybox} -> TOCs disappear
%\usepackage{lscape}
%\usepackage{rotating}
%\usepackage{multicol}
%% fonts
\usepackage{times}\fontfamily{ptm}\selectfont
\usepackage{t1enc}

% noweb options
\noweboptions{smallcode}
\def\nwendcode{\endtrivlist \endgroup} % relax page breaking scheme
\let\nwdocspar=\par                    %

\input defs.tex % from <LaTeX new definitions> chunk

%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\begin{document}
%
\nwfilename{/home/ug/jabril/development/softjabril/splitfasta/splitfasta.nw}%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
\nwbegindocs{2}\nwdocspar

\nwenddocs{}%
\nwbegindocs{4}\nwdocspar
\nwenddocs{}%
\nwbegindocs{6}\nwdocspar
\nwenddocs{}%
\nwbegindocs{8}\nwdocspar
\nwenddocs{}%
\nwbegindocs{10}\nwdocspar

\thispagestyle{empty}

\begin{titlepage}

\ \vfill
\begin{center}
\begin{bfseries}
\begin{large}
\newlength{\lttbl}\setlength{\lttbl}{0.25\linewidth}
\newlength{\rttbl}\setlength{\rttbl}{0.70\linewidth}
%\fbox{
%\vskip 2ex
\begin{tabular}{>{\scshape}r@{\quad}l}
\rule{\lttbl}{0pt} & \rule{\rttbl}{0pt} \\[2ex]
\multicolumn{2}{c}{\shortstack{\rule[0ex]{0.95\linewidth}{2pt}\\[0ex]
                               \rule[1ex]{0.95\linewidth}{2pt}}}\\[2ex]
Program Name: & {\Huge\progname}                       \\[3ex]
\multicolumn{2}{c}{\rule[0.5ex]{0.95\linewidth}{2pt}}\\[2ex]
      Author: & {\Large
                 \begin{minipage}[t]{0.95\rttbl}
                 \authorslist
                 \end{minipage}}                       \\[2ex]
     License: & {\license}                             \\[2ex]
 Last Update: & {\today}                               \\[2ex]
 Description: & {\large\mdseries
                 \begin{minipage}[t]{0.95\rttbl}
                 \description
                 \end{minipage}}                       \\[2ex]
\\
\multicolumn{2}{c}{\shortstack{\rule[0ex]{0.95\linewidth}{2pt}\\[0ex]
                               \rule[1ex]{0.95\linewidth}{2pt}}}\\[2ex]
\end{tabular}
%} % fbox
\end{large}
\end{bfseries}
\end{center}

\vfill

\begin{raggedleft}
\showaffiliation
\end{raggedleft}

\end{titlepage} %'

%
%%%%%%%%%%%%%%%%%%%% FRONTMATTER

\newpage %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\pagenumbering{roman}
\setcounter{page}{1}
\pagestyle{fancy}
% Marks redefinition must go here because pagestyle 
% resets the values to the default ones.
\renewcommand{\sectionmark}[1]{\markboth{}{\thesection.\ #1}}
\renewcommand{\subsectionmark}[1]{\markboth{}{\thesubsection.\ \textsl{#1}}}

\tableofcontents
\listoftables
\listoffigures

\vfill
\begin{center}
{\small$<$ \verb$Id: splitfasta.tex,v 1.1 2001-09-06 18:26:09 jabril Exp $$>$ }
\end{center}

%%%%%%%%%%%%%%%%%%%% MAINMATTER

\newpage %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\pagenumbering{arabic}
\setcounter{page}{1}

\sctn{Introduction}

\subsctn{Program description}

\subsctn{Input}

\subsctn{Output}

% \subsctn{Comments}

\subsctn{To Do}

\begin{itemize}
 \input todo.tex
\end{itemize}

\newpage %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\sctn{Implementation}

\subsctn{Program outline}

\nwenddocs{}\nwbegincode{11}\sublabel{NWspl11-splA-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-splA-1}}}\moddef{splitfasta~{\nwtagstyle{}\subpageref{NWspl11-splA-1}}}\endmoddef
\LA{}PERL shebang~{\nwtagstyle{}\subpageref{NWspl11-PERC-1}}\RA{}
#
# MODULES
#
\LA{}Use Modules~{\nwtagstyle{}\subpageref{NWspl11-UseB-1}}\RA{}
#
# VARIABLES
#
\LA{}Global Vars~{\nwtagstyle{}\subpageref{NWspl11-GloB-1}}\RA{}
#
# MAIN LOOP
#
\LA{}Main Loop~{\nwtagstyle{}\subpageref{NWspl11-Mai9-1}}\RA{}
#
# FUNCTIONS
#
\LA{}Functions~{\nwtagstyle{}\subpageref{NWspl11-Fun9-1}}\RA{}
#
#
\LA{}OLD IMPLEMENTATION~{\nwtagstyle{}\subpageref{NWspl11-OLDI-1}}\RA{}
\nwnotused{splitfasta}\nwendcode{}\nwbegindocs{12}\nwdocspar

\nwenddocs{}\nwbegincode{13}\sublabel{NWspl11-UseB-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-UseB-1}}}\moddef{Use Modules~{\nwtagstyle{}\subpageref{NWspl11-UseB-1}}}\endmoddef
\nwused{\\{NWspl11-splA-1}}\nwendcode{}\nwbegindocs{14}\nwdocspar

\nwenddocs{}\nwbegincode{15}\sublabel{NWspl11-GloB-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-GloB-1}}}\moddef{Global Vars~{\nwtagstyle{}\subpageref{NWspl11-GloB-1}}}\endmoddef
\nwused{\\{NWspl11-splA-1}}\nwendcode{}\nwbegindocs{16}\nwdocspar

\nwenddocs{}\nwbegincode{17}\sublabel{NWspl11-Mai9-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-Mai9-1}}}\moddef{Main Loop~{\nwtagstyle{}\subpageref{NWspl11-Mai9-1}}}\endmoddef

exit(0);
\nwused{\\{NWspl11-splA-1}}\nwendcode{}\nwbegindocs{18}\nwdocspar

\nwenddocs{}\nwbegincode{19}\sublabel{NWspl11-Fun9-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-Fun9-1}}}\moddef{Functions~{\nwtagstyle{}\subpageref{NWspl11-Fun9-1}}}\endmoddef
sub \{
\} # 
\nwused{\\{NWspl11-splA-1}}\nwendcode{}\nwbegindocs{20}\nwdocspar

\label{todo:AAA}
\nwenddocs{}%
%
\nwbegindocs{22}\nwdocspar
\nwenddocs{}%
%
\nwbegindocs{24}\nwdocspar
\todo{ \item \todoAAA } % todo

\nwenddocs{}\nwbegincode{25}\sublabel{NWspl11-OLDI-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-OLDI-1}}}\moddef{OLD IMPLEMENTATION~{\nwtagstyle{}\subpageref{NWspl11-OLDI-1}}}\endmoddef
#
# splitfastaseq.pl \\
#     seqlength overlap < fastafile > output
#
#     Breaking large fasta sequences to build 
#     databases for running tblastx faster
# 
use lib qw( /usr/lib/perl5/site_perl/5.005/ );
use Bio::Seq;
use Bio::SeqIO;
use Benchmark;
my ($T,$F) = (1,0);
my @Timer = (new Benchmark);
my $PROGRAM = 'splitfastaseq.pl';
my $DATE = localtime;
my $USER = defined($ENV\{USER\}) ? $ENV\{USER\} : '??????';
my $host = `hostname`;
chomp($host);
my $line = ('#' x 80)."\\n";
my $s = '### ';
#
my ($id,$ln,$sq) = ('',0,'');
my ($total_time,$seq);
my ($maxlen,$overlap) = @ARGV;

print STDERR << "+++EOR+++";
$line$s\\n$s Running $PROGRAM\\n$s
$s HOST: $host
$s USER: $USER
$s DATE: $DATE\\n$s\\n$line$s
+++EOR+++

&getseq();
&splitseq();

$total_time = &timing($T);
print STDERR << "+++EOR+++";
$s\\n$line$s\\n$s $PROGRAM FINISHED\\n$s
$s TOTAL TIME: $total_time\\n$line
+++EOR+++

exit(0);

sub getseq() \{ # assuming here single sequence input fasta files
    print STDERR "$s Processing fasta file.\\n";
    my $seqin = Bio::SeqIO->new(-format => 'FASTA', -fh => \\*STDIN);
    while (my $iseq = $seqin->next_seq()) \{
        $id = $iseq->display_id();
        $ln = $iseq->length();
        $sq = $iseq->seq();
        last; # to make sure that we only catch a single fasta sequence
    \}; # while next_seq
    $seq = Bio::Seq->new( -seq => $sq , -id => $id );
    print STDERR "$s Processing DONE: ".(&timing($F))."\\n$s\\n";
\} # getseq
#
sub splitseq() \{
    my ($e,$sid,$ssq,$nseq,$wseq);
    my ($t,$sqlen) = (1,($maxlen + $overlap - 1));
    print STDERR "$s Creating splitted-sequence fasta file ($ln nt).\\n";
    my $seqout = Bio::SeqIO->new(-format => 'FASTA', -fh => \\*STDOUT);
    while ($t < $ln) \{
         $e = $t + $sqlen;
         ($e > $ln) && ($e = $ln);
         $sid = "$id\\_$t\\_$e";
         print STDERR "$s --> $id : from $t to $e (".($e - $t + 1)." nt)\\n";
         $ssq = $seq->subseq($t,$e);
         $t += $maxlen;
         #
         $wseq = Bio::Seq->new( -seq => $ssq , -id => $sid );
         $seqout->write_seq($wseq);
    \}; # while  
    print STDERR "$s Splitting DONE: ".(&timing($F))."\\n$s\\n";
\} # splitseq
#
sub timing() \{
    push @Timer, (new Benchmark);
    # partial time
    $_[0] ||
        (return timestr(timediff($Timer[$#Timer],$Timer[($#Timer - 1)])));
    # total time
    return timestr(timediff($Timer[$#Timer],$Timer[0]));
\} # timing
\nwused{\\{NWspl11-splA-1}}\nwendcode{}\nwbegindocs{26}\nwdocspar

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{comment}
\end{comment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%% BACKMATTER

% \newpage %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
% \bibliographystyle{apalike}
% \bibliography{/home1/rguigo/docs/biblio/References}

\newpage %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\appendix

\sctn{empty appendix section}

\subsctn{empty appendix subsection}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{comment}
\end{comment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%
\newpage %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\sctn{Common code blocks}

\subsctn{PERL scripts}

\nwenddocs{}\nwbegincode{27}\sublabel{NWspl11-PERC-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-PERC-1}}}\moddef{PERL shebang~{\nwtagstyle{}\subpageref{NWspl11-PERC-1}}}\endmoddef
#!/usr/bin/perl -w
# This is perl, version 5.005_03 built for i386-linux
\LA{}GNU License~{\nwtagstyle{}\subpageref{NWspl11-GNUB-1}}\RA{}
\LA{}Version Control Id Tag~{\nwtagstyle{}\subpageref{NWspl11-VerM-1}}\RA{}
#
use strict;
\nwused{\\{NWspl11-splA-1}}\nwendcode{}\nwbegindocs{28}\nwdocspar

\nwenddocs{}\nwbegincode{29}\sublabel{NWspl11-GloQ-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-GloQ-1}}}\moddef{Global Constants - Boolean~{\nwtagstyle{}\subpageref{NWspl11-GloQ-1}}}\endmoddef
my ($T,$F) = (1,0); # for 'T'rue and 'F'alse
\eatline
\nwnotused{Global\ Constants\ -\ Boolean}\nwendcode{}\nwbegindocs{30}\nwdocspar
We also set here the date when the script is running and who is the user running it.

\nwenddocs{}\nwbegincode{31}\sublabel{NWspl11-GloR-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-GloR-1}}}\moddef{Global Vars - User and Date~{\nwtagstyle{}\subpageref{NWspl11-GloR-1}}}\endmoddef
my $DATE = localtime;
my $USER = $ENV\{USER\};
\eatline
\nwnotused{Global\ Vars\ -\ User\ and\ Date}\nwendcode{}\nwbegindocs{32}\nwdocspar

\subsubsctn{Timing our scripts}

The '{\tt{}Benchmark}' module encapsulates a number of routines to help to figure out how long it takes to execute a piece of code and the whole script.

\nwenddocs{}\nwbegincode{33}\sublabel{NWspl11-UseN-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-UseN-1}}}\moddef{Use Modules - Benchmark~{\nwtagstyle{}\subpageref{NWspl11-UseN-1}}}\endmoddef
use Benchmark;
  \LA{}Timer ON~{\nwtagstyle{}\subpageref{NWspl11-Tim8-1}}\RA{}
\nwnotused{Use\ Modules\ -\ Benchmark}\nwendcode{}\nwbegindocs{34}\nwdocspar

See '{\tt{}man\ Benchmark}' for further info about this package. 
We set an array to keep record of timing for each section.

\nwenddocs{}\nwbegincode{35}\sublabel{NWspl11-Tim8-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-Tim8-1}}}\moddef{Timer ON~{\nwtagstyle{}\subpageref{NWspl11-Tim8-1}}}\endmoddef
my @Timer = (new Benchmark);
\nwused{\\{NWspl11-UseN-1}}\nwendcode{}\nwbegindocs{36}\nwdocspar

\nwenddocs{}\nwbegincode{37}\sublabel{NWspl11-ComS-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-ComS-1}}}\moddef{Common PERL subs - Benchmark~{\nwtagstyle{}\subpageref{NWspl11-ComS-1}}}\endmoddef
sub timing() \{
    push @Timer, (new Benchmark);
    # partial time 
    $_[0] || 
        (return timestr(timediff($Timer[$#Timer],$Timer[($#Timer - 1)])));
    # total time
    return timestr(timediff($Timer[$#Timer],$Timer[0]));
\} # timing
\nwnotused{Common\ PERL\ subs\ -\ Benchmark}\nwendcode{}\nwbegindocs{38}\nwdocspar


\subsubsctn{Printing complex Data Structures}

With '{\tt{}Data::Dumper}' we are able to pretty print complex data structures for debugging them.


\nwenddocs{}\nwbegincode{39}\sublabel{NWspl11-UseK-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-UseK-1}}}\moddef{Use Modules - Dumper~{\nwtagstyle{}\subpageref{NWspl11-UseK-1}}}\endmoddef
use Data::Dumper;
local $Data::Dumper::Purity = 0;
local $Data::Dumper::Deepcopy = 1;
\nwnotused{Use\ Modules\ -\ Dumper}\nwendcode{}\nwbegindocs{40}\nwdocspar


\subsubsctn{Common functions}

\nwenddocs{}\nwbegincode{41}\sublabel{NWspl11-SkiV-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-SkiV-1}}}\moddef{Skip comments and empty records~{\nwtagstyle{}\subpageref{NWspl11-SkiV-1}}}\endmoddef
next if /^\\#/o;
next if /^\\s*$/o;
chomp;
\nwnotused{Skip\ comments\ and\ empty\ records}\nwendcode{}\nwbegindocs{42}\nwdocspar

\nwenddocs{}\nwbegincode{43}\sublabel{NWspl11-ComQ-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-ComQ-1}}}\moddef{Common PERL subs - Min Max~{\nwtagstyle{}\subpageref{NWspl11-ComQ-1}}}\endmoddef
#
sub max() \{
    my $z = shift @_;
    foreach my $l (@_) \{ $z = $l if $l > $z \};
    return $z;
\} # max
sub min() \{
    my $z = shift @_;
    foreach my $l (@_) \{ $z = $l if $l < $z \};
    return $z;
\} # min
\nwnotused{Common\ PERL\ subs\ -\ Min\ Max}\nwendcode{}\nwbegindocs{44}\nwdocspar

\nwenddocs{}\nwbegincode{45}\sublabel{NWspl11-ComS.2-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-ComS.2-1}}}\moddef{Common PERL subs - Text fill~{\nwtagstyle{}\subpageref{NWspl11-ComS.2-1}}}\endmoddef
#
sub fill_right() \{ $_[0].($_[2] x ($_[1] - length($_[0]))) \}
sub fill_left()  \{ ($_[2] x ($_[1] - length($_[0]))).$_[0] \}
sub fill_mid()   \{ 
    my $l = length($_[0]);
    my $k = int(($_[1] - $l)/2);
    ($_[2] x $k).$_[0].($_[2] x ($_[1] - ($l+$k)));
\} # fill_mid
\nwnotused{Common\ PERL\ subs\ -\ Text\ fill}\nwendcode{}\nwbegindocs{46}\nwdocspar

These functions are used to report to STDERR a single char for each record processed (useful for reporting parsed records).

\nwenddocs{}\nwbegincode{47}\sublabel{NWspl11-ComQ.2-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-ComQ.2-1}}}\moddef{Common PERL subs - Counter~{\nwtagstyle{}\subpageref{NWspl11-ComQ.2-1}}}\endmoddef
#
sub counter \{ # $_[0]~current_pos++ $_[1]~char
    print STDERR "$_[1]";
    (($_[0] % 50) == 0) && (print STDERR "[".&fill_left($_[0],6,"0")."]\\n");
\} # counter
#
sub counter_end \{ # $_[0]~current_pos   $_[1]~char
    (($_[0] % 50) != 0) && (print STDERR "[".&fill_left($_[0],6,"0")."]\\n");
\} # counter_end
\nwnotused{Common\ PERL\ subs\ -\ Counter}\nwendcode{}\nwbegindocs{48}\nwdocspar

\nwenddocs{}\nwbegincode{49}\sublabel{NWspl11-GloL-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-GloL-1}}}\moddef{Global Vars - Counter~{\nwtagstyle{}\subpageref{NWspl11-GloL-1}}}\endmoddef
my ($n,$c); # counter and char (for &counter function)
\eatline
\nwnotused{Global\ Vars\ -\ Counter}\nwendcode{}\nwbegindocs{50}\nwdocspar

\subsubsctn{Common functions for reporting program processes}
\label{sec:messagerpt}

Function '{\tt{}report}' requires that a hash variable '{\tt{}{\char37}MessageList}' has been set, such hash contains the strings for each report message we will need. The first parameter for '{\tt{}report}' is a key for that hash, in order to retrieve the message string, the other parameters passed are processed by the {\tt{}sprintf} function on that string.

\nwenddocs{}\nwbegincode{51}\sublabel{NWspl11-ComP-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-ComP-1}}}\moddef{Common PERL subs - STDERR~{\nwtagstyle{}\subpageref{NWspl11-ComP-1}}}\endmoddef
sub report() \{ print STDERR sprintf($MessageList\{ shift @_ \},@_) \}
\nwalsodefined{\\{NWspl11-ComP-2}}\nwnotused{Common\ PERL\ subs\ -\ STDERR}\nwendcode{}\nwbegindocs{52}\nwdocspar

The same happens to '{\tt{}warn}' function which also requires a hash variable '{\tt{}{\char37}ErrorList}' containing the error messages.

\nwenddocs{}\nwbegincode{53}\sublabel{NWspl11-ComP-2}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-ComP-2}}}\moddef{Common PERL subs - STDERR~{\nwtagstyle{}\subpageref{NWspl11-ComP-1}}}\plusendmoddef
sub warn() \{ print STDERR sprintf($ErrorList\{ shift @_ \}, @_) \}
\nwendcode{}\nwbegindocs{54}\nwdocspar

\subsctn{BASH scripts}

\nwenddocs{}\nwbegincode{55}\sublabel{NWspl11-BASC-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-BASC-1}}}\moddef{BASH shebang~{\nwtagstyle{}\subpageref{NWspl11-BASC-1}}}\endmoddef
#!/usr/bin/bash
# GNU bash, version 2.03.6(1)-release (i386-redhat-linux-gnu)
\LA{}Version Control Id Tag~{\nwtagstyle{}\subpageref{NWspl11-VerM-1}}\RA{}
#
SECONDS=0 # Reset Timing
# Which script are we running...
L="####################"
\{ echo "$L$L$L$L";
  echo "### RUNNING [$0]";
  echo "### Current date:`date`";
  echo "###"; \} 1>&2;
\nwused{\\{NWspl11-wea7-1}\\{NWspl11-LaT8-1}}\nwendcode{}\nwbegindocs{56}\nwdocspar

\nwenddocs{}\nwbegincode{57}\sublabel{NWspl11-BASF-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-BASF-1}}}\moddef{BASH script end~{\nwtagstyle{}\subpageref{NWspl11-BASF-1}}}\endmoddef
\{ echo "###"; echo "### Execution time for [$0] : $SECONDS secs";
  echo "$L$L$L$L";
  echo ""; \} 1>&2;
#
exit 0
\nwused{\\{NWspl11-wea7-1}\\{NWspl11-LaT8-1}}\nwendcode{}\nwbegindocs{58}\nwdocspar

\subsctn{Version control tags}

This document is under Revision Control System (RCS). The version you are currently reading is the following:

\nwenddocs{}\nwbegincode{59}\sublabel{NWspl11-VerM-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-VerM-1}}}\moddef{Version Control Id Tag~{\nwtagstyle{}\subpageref{NWspl11-VerM-1}}}\endmoddef
# $Id: splitfasta.tex,v 1.1 2001-09-06 18:26:09 jabril Exp $
\nwused{\\{NWspl11-PERC-1}\\{NWspl11-BASC-1}}\nwendcode{}\nwbegindocs{60}\nwdocspar

\subsctn{GNU General Public License}

\nwenddocs{}\nwbegincode{61}\sublabel{NWspl11-GNUB-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-GNUB-1}}}\moddef{GNU License~{\nwtagstyle{}\subpageref{NWspl11-GNUB-1}}}\endmoddef
# #----------------------------------------------------------------#
# #                          splitfasta                         #
# #----------------------------------------------------------------#
# 
#    Remember to put a short description of your script here...
# 
#     Copyright (C) 2001 - Josep Francesc ABRIL FERRANDO  
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.
# 
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
# 
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
# 
# #----------------------------------------------------------------#
\nwused{\\{NWspl11-PERC-1}}\nwendcode{}\nwbegindocs{62}\nwdocspar

\newpage %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\sctn{Extracting code blocks from this document}

From this file we can obtain both the code and the
documentation. The following instructions are needed:

\subsctn{Extracts Script code chunks from the {\noweb} file} % \\[-0.5ex]

Remember when tangling that '-L' option allows you to include program line-numbering relative to original {\noweb} file. Then the first line of the executable files is a comment, not a shebang, and must be removed to make scripts runnable.

\nwenddocs{}\nwbegincode{63}\sublabel{NWspl11-tan8-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-tan8-1}}}\moddef{tangling~{\nwtagstyle{}\subpageref{NWspl11-tan8-1}}}\endmoddef
# showing line numbering comments in program
notangle -L -R"splitfasta" $WORK/$nwfile.nw | \\
    perl -ne '$.>1 && print' | cpif $BIN/splitfasta.pl ;
chmod a+x $BIN/splitfasta.pl ;
\nwalsodefined{\\{NWspl11-tan8-2}\\{NWspl11-tan8-3}\\{NWspl11-tan8-4}\\{NWspl11-tan8-5}}\nwnotused{tangling}\nwendcode{}\nwbegindocs{64}\nwdocspar

\nwenddocs{}\nwbegincode{65}\sublabel{NWspl11-tan8-2}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-tan8-2}}}\moddef{tangling~{\nwtagstyle{}\subpageref{NWspl11-tan8-1}}}\plusendmoddef
# reformating program with perltidy
notangle -R"splitfasta" $WORK/$nwfile.nw | \\
    perltidy - | cpif $BIN/splitfasta.pl ;
# html pretty-printing program with perltidy
notangle -R"splitfasta" $WORK/$nwfile.nw | \\
    perltidy -html - | cpif $DOCS/html/splitfasta.html ;
#
\nwendcode{}\nwbegindocs{66}\nwdocspar

\subsctn{Extracting different Config Files} % \\[-0.5ex]

\nwenddocs{}\nwbegincode{67}\sublabel{NWspl11-tan8-3}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-tan8-3}}}\moddef{tangling~{\nwtagstyle{}\subpageref{NWspl11-tan8-1}}}\plusendmoddef
notangle -R"root" $WORK/$nwfile.nw | \\
         cpif $DATA/root_config ;
\nwendcode{}\nwbegindocs{68}%$

\subsctn{Extracting documentation and \LaTeX{}'ing it} % \\[-0.5ex] %'

\nwenddocs{}\nwbegincode{69}\sublabel{NWspl11-tan8-4}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-tan8-4}}}\moddef{tangling~{\nwtagstyle{}\subpageref{NWspl11-tan8-1}}}\plusendmoddef
notangle -Rweaving  $WORK/$nwfile.nw | cpif $WORK/nw2tex ;
notangle -RLaTeXing $WORK/$nwfile.nw | cpif $WORK/ltx ;
chmod a+x $WORK/nw2tex $WORK/ltx;
\nwendcode{}\nwbegindocs{70}\nwdocspar

\nwenddocs{}\nwbegincode{71}\sublabel{NWspl11-tanY-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-tanY-1}}}\moddef{tangling complementary LaTeX files~{\nwtagstyle{}\subpageref{NWspl11-tanY-1}}}\endmoddef
notangle -R"HIDE: LaTeX new definitions" $WORK/$nwfile.nw | cpif $DOCS/defs.tex ;
notangle -R"HIDE: TODO" $WORK/$nwfile.nw | cpif $DOCS/todo.tex ; 
\nwused{\\{NWspl11-wea7-1}}\nwendcode{}\nwbegindocs{72}\nwdocspar

\nwenddocs{}\nwbegincode{73}\sublabel{NWspl11-wea7-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-wea7-1}}}\moddef{weaving~{\nwtagstyle{}\subpageref{NWspl11-wea7-1}}}\endmoddef
\LA{}BASH shebang~{\nwtagstyle{}\subpageref{NWspl11-BASC-1}}\RA{}
# weaving and LaTeXing
\LA{}BASH Environment Variables~{\nwtagstyle{}\subpageref{NWspl11-BASQ-1}}\RA{}
\LA{}tangling complementary LaTeX files~{\nwtagstyle{}\subpageref{NWspl11-tanY-1}}\RA{}
noweave -v -t4 -delay -x -filter 'elide "HIDE: *"' \\
        $WORK/$nwfile.nw | cpif $DOCS/$nwfile.tex ;
# noweave -t4 -delay -index $WORK/$nwfile.nw > $DOCS/$nwfile.tex 
pushd $DOCS/ ;
#
latex $nwfile.tex ;
dvips $nwfile.dvi -o $nwfile.ps -t a4 ;
#
popd;
\LA{}BASH script end~{\nwtagstyle{}\subpageref{NWspl11-BASF-1}}\RA{}
\nwnotused{weaving}\nwendcode{}\nwbegindocs{74}\nwdocspar

\nwenddocs{}\nwbegincode{75}\sublabel{NWspl11-LaT8-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-LaT8-1}}}\moddef{LaTeXing~{\nwtagstyle{}\subpageref{NWspl11-LaT8-1}}}\endmoddef
\LA{}BASH shebang~{\nwtagstyle{}\subpageref{NWspl11-BASC-1}}\RA{}
# only LaTeXing
\LA{}BASH Environment Variables~{\nwtagstyle{}\subpageref{NWspl11-BASQ-1}}\RA{}
pushd $DOCS/ ;
#
echo "### RUNNING LaTeX on $nwfile.tex" 1>&2 ;
latex $nwfile.tex ; 
latex $nwfile.tex ; 
latex $nwfile.tex ;
dvips $nwfile.dvi -o $nwfile.ps -t a4 ;
#
# pdflatex $nwfile.tex ;
echo "### CONVERTING PS to PDF: $nwfile" 1>&2 ;
ps2pdf $nwfile.ps $nwfile.pdf ;
#
popd ;
\LA{}BASH script end~{\nwtagstyle{}\subpageref{NWspl11-BASF-1}}\RA{}
\nwnotused{LaTeXing}\nwendcode{}\nwbegindocs{76}%$

\subsctn{Defining working shell variables for the current project} % \\[-0.5ex]

\nwenddocs{}\nwbegincode{77}\sublabel{NWspl11-BASQ-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-BASQ-1}}}\moddef{BASH Environment Variables~{\nwtagstyle{}\subpageref{NWspl11-BASQ-1}}}\endmoddef
#
# Setting Global Variables
WORK="/home/ug/jabril/development/softjabril/splitfasta" ;
BIN="$WORK/bin" ;
PARAM="$BIN/param" ;
DOCS="$WORK/docs" ;
DATA="$WORK/data" ;
nwfile="splitfasta" ;
export WORK BIN PARAM DOCS DATA nwfile ;
#
\nwused{\\{NWspl11-wea7-1}\\{NWspl11-LaT8-1}}\nwendcode{}\nwbegindocs{78}\nwdocspar

\nwenddocs{}\nwbegincode{79}\sublabel{NWspl11-tan8-5}\nwmargintag{{\nwtagstyle{}\subpageref{NWspl11-tan8-5}}}\moddef{tangling~{\nwtagstyle{}\subpageref{NWspl11-tan8-1}}}\plusendmoddef
# 
# BASH Environment Variables
notangle -R'BASH Environment Variables' $WORK/$nwfile.nw | \\
         cpif $WORK/.bash_VARS ; 
source $WORK/.bash_VARS ;
#
\nwendcode{}

\nwixlogsorted{c}{{BASH Environment Variables}{NWspl11-BASQ-1}{\nwixu{NWspl11-wea7-1}\nwixu{NWspl11-LaT8-1}\nwixd{NWspl11-BASQ-1}}}%
\nwixlogsorted{c}{{BASH script end}{NWspl11-BASF-1}{\nwixd{NWspl11-BASF-1}\nwixu{NWspl11-wea7-1}\nwixu{NWspl11-LaT8-1}}}%
\nwixlogsorted{c}{{BASH shebang}{NWspl11-BASC-1}{\nwixd{NWspl11-BASC-1}\nwixu{NWspl11-wea7-1}\nwixu{NWspl11-LaT8-1}}}%
\nwixlogsorted{c}{{Common PERL subs - Benchmark}{NWspl11-ComS-1}{\nwixd{NWspl11-ComS-1}}}%
\nwixlogsorted{c}{{Common PERL subs - Counter}{NWspl11-ComQ.2-1}{\nwixd{NWspl11-ComQ.2-1}}}%
\nwixlogsorted{c}{{Common PERL subs - Min Max}{NWspl11-ComQ-1}{\nwixd{NWspl11-ComQ-1}}}%
\nwixlogsorted{c}{{Common PERL subs - STDERR}{NWspl11-ComP-1}{\nwixd{NWspl11-ComP-1}\nwixd{NWspl11-ComP-2}}}%
\nwixlogsorted{c}{{Common PERL subs - Text fill}{NWspl11-ComS.2-1}{\nwixd{NWspl11-ComS.2-1}}}%
\nwixlogsorted{c}{{Functions}{NWspl11-Fun9-1}{\nwixu{NWspl11-splA-1}\nwixd{NWspl11-Fun9-1}}}%
\nwixlogsorted{c}{{GNU License}{NWspl11-GNUB-1}{\nwixu{NWspl11-PERC-1}\nwixd{NWspl11-GNUB-1}}}%
\nwixlogsorted{c}{{Global Constants - Boolean}{NWspl11-GloQ-1}{\nwixd{NWspl11-GloQ-1}}}%
\nwixlogsorted{c}{{Global Vars}{NWspl11-GloB-1}{\nwixu{NWspl11-splA-1}\nwixd{NWspl11-GloB-1}}}%
\nwixlogsorted{c}{{Global Vars - Counter}{NWspl11-GloL-1}{\nwixd{NWspl11-GloL-1}}}%
\nwixlogsorted{c}{{Global Vars - User and Date}{NWspl11-GloR-1}{\nwixd{NWspl11-GloR-1}}}%
\nwixlogsorted{c}{{HIDE: LaTeX new definitions}{NWspl11-HIDR-1}{\nwixd{NWspl11-HIDR-1}}}%
\nwixlogsorted{c}{{HIDE: TODO}{NWspl11-HIDA-1}{\nwixd{NWspl11-HIDA-1}}}%
\nwixlogsorted{c}{{HIDE: new LaTeX commands}{NWspl11-HIDO-1}{\nwixu{NWspl11-HIDR-1}\nwixd{NWspl11-HIDO-1}}}%
\nwixlogsorted{c}{{HIDE: new LaTeX definitions}{NWspl11-HIDR.2-1}{\nwixu{NWspl11-HIDR-1}\nwixd{NWspl11-HIDR.2-1}}}%
\nwixlogsorted{c}{{HIDE: new LaTeX pstricks}{NWspl11-HIDO.2-1}{\nwixu{NWspl11-HIDR-1}\nwixd{NWspl11-HIDO.2-1}}}%
\nwixlogsorted{c}{{HIDE: new LaTeX urls}{NWspl11-HIDK-1}{\nwixu{NWspl11-HIDR-1}\nwixd{NWspl11-HIDK-1}}}%
\nwixlogsorted{c}{{HIDE: new defs TODO}{NWspl11-HIDJ-1}{\nwixu{NWspl11-HIDR-1}\nwixd{NWspl11-HIDJ-1}}}%
\nwixlogsorted{c}{{LaTeXing}{NWspl11-LaT8-1}{\nwixd{NWspl11-LaT8-1}}}%
\nwixlogsorted{c}{{Main Loop}{NWspl11-Mai9-1}{\nwixu{NWspl11-splA-1}\nwixd{NWspl11-Mai9-1}}}%
\nwixlogsorted{c}{{OLD IMPLEMENTATION}{NWspl11-OLDI-1}{\nwixu{NWspl11-splA-1}\nwixd{NWspl11-OLDI-1}}}%
\nwixlogsorted{c}{{PERL shebang}{NWspl11-PERC-1}{\nwixu{NWspl11-splA-1}\nwixd{NWspl11-PERC-1}}}%
\nwixlogsorted{c}{{Skip comments and empty records}{NWspl11-SkiV-1}{\nwixd{NWspl11-SkiV-1}}}%
\nwixlogsorted{c}{{Timer ON}{NWspl11-Tim8-1}{\nwixu{NWspl11-UseN-1}\nwixd{NWspl11-Tim8-1}}}%
\nwixlogsorted{c}{{Use Modules}{NWspl11-UseB-1}{\nwixu{NWspl11-splA-1}\nwixd{NWspl11-UseB-1}}}%
\nwixlogsorted{c}{{Use Modules - Benchmark}{NWspl11-UseN-1}{\nwixd{NWspl11-UseN-1}}}%
\nwixlogsorted{c}{{Use Modules - Dumper}{NWspl11-UseK-1}{\nwixd{NWspl11-UseK-1}}}%
\nwixlogsorted{c}{{Version Control Id Tag}{NWspl11-VerM-1}{\nwixu{NWspl11-PERC-1}\nwixu{NWspl11-BASC-1}\nwixd{NWspl11-VerM-1}}}%
\nwixlogsorted{c}{{splitfasta}{NWspl11-splA-1}{\nwixd{NWspl11-splA-1}}}%
\nwixlogsorted{c}{{tangling}{NWspl11-tan8-1}{\nwixd{NWspl11-tan8-1}\nwixd{NWspl11-tan8-2}\nwixd{NWspl11-tan8-3}\nwixd{NWspl11-tan8-4}\nwixd{NWspl11-tan8-5}}}%
\nwixlogsorted{c}{{tangling complementary LaTeX files}{NWspl11-tanY-1}{\nwixd{NWspl11-tanY-1}\nwixu{NWspl11-wea7-1}}}%
\nwixlogsorted{c}{{weaving}{NWspl11-wea7-1}{\nwixd{NWspl11-wea7-1}}}%
\nwbegindocs{80}\nwdocspar

%
\end{document}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\nwenddocs{}
