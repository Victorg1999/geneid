#!/bin/sh

gawk 'BEGIN{
	while (getline<ARGV[1]>0)
		codon[$2]=$1
	
	frame=ARGV[2]
	ARGV[1]=ARGV[2]=""
}
{
	sequence=$2
	printf "%s ", $1
	lseq=length(sequence)
	for (i=1+frame;i<lseq-1;i+=3) {
	  triplet = substr(sequence,i,3)
          if (triplet in codon)
	    printf "%s", codon[triplet]
	  else
	    printf "X"
        }
	  
	printf "\n"
}'  ~fcamara/bin/genetic.code "$@"
