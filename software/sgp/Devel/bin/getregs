#! /usr/local/bin/gawk -f
# rgs, celera, june 2000

BEGIN{
 # LOCUSNAME = "default";
  SOURCE    = "TBLASTX";
  FEATURE   = "hsp"
}
NR==1{
LOCUSNAME=$1
}
{
  lseq[$7]=$5;
  lscore[$7]=$6;
  lframe[$7]=$8;

  for (i=$4;i<=$5;i++)
    score[$7,$8,i] = max(score[$7,$8,i],$6);

#  print $7,$8, i, score[$7,$8,i];


}
END{
  for (f=1;f<=3;f++) {
    cscore=0;
    
    for (i=1;i<=lseq["+"];i++)
      if (score["+",f,i]!=cscore) {
	if (score["+",f,i-1]!=0)
	  printf "%9d %6d  %1s  %1s\n", i-1, score["+",f,i-1],"+",f;
	if (score["+",f,i]!=0) 
	    printf "%-10s %-10s %-10s %9d ", LOCUSNAME, SOURCE, FEATURE, i;
	cscore=score["+",f,i];
      }
    
    if (lframe["+"]==f)
        printf "%9d %6d  %1s  %1s\n", lseq["+"], lscore["+"], "+", f;
      
    
    for (i=1;i<=lseq["-"];i++)
      if (score["-",f,i]!=cscore) {
	if (score["-",f,i-1]!=0) 
	  printf "%9d %6d  %1s  %1s\n", i-1, score["-",f,i-1],"-",f;
	if (score["-",f,i]!=0) 
	  printf "%-10s %-10s %-10s %9d ", LOCUSNAME, SOURCE, FEATURE, i;
	cscore=score["-",f,i];
      }

    if (lframe["-"]==f)
        printf "%9d %6d  %1s  %1s\n", lseq["-"], lscore["-"], "-", f;


  }


}
function max(a,b) {
  return a > b ? a : b;
}
