%!PS-Adobe-2.0
%%Creator: dvips(k) 5.86 Copyright 1999 Radical Eye Software
%%Title: humus.dvi
%%Pages: 96
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%DocumentFonts: Times-Bold Times-Roman Times-Italic Courier
%%+ Courier-Bold Times-BoldItalic Courier-Oblique Helvetica
%%DocumentPaperSizes: a4
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips humus.dvi -o humus.ps -t a4
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 2002.03.06:2041
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/id 0 N/rw 0 N/rc 0 N/gp 0 N/cp 0 N/G 0 N/CharBuilder{save 3
1 roll S A/base get 2 index get S/BitMaps get S get/Cd X pop/ctr 0 N Cdx
0 Cx Cy Ch sub Cx Cw add Cy setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx
sub Cy .1 sub]/id Ci N/rw Cw 7 add 8 idiv string N/rc 0 N/gp 0 N/cp 0 N{
rc 0 ne{rc 1 sub/rc X rw}{G}ifelse}imagemask restore}B/G{{id gp get/gp
gp 1 add N A 18 mod S 18 idiv pl S get exec}loop}B/adv{cp add/cp X}B
/chg{rw cp id gp 4 index getinterval putinterval A gp add/gp X adv}B/nd{
/cp 0 N rw exit}B/lsh{rw cp 2 copy get A 0 eq{pop 1}{A 255 eq{pop 254}{
A A add 255 and S 1 and or}ifelse}ifelse put 1 adv}B/rsh{rw cp 2 copy
get A 0 eq{pop 128}{A 255 eq{pop 127}{A 2 idiv S 128 and or}ifelse}
ifelse put 1 adv}B/clr{rw cp 2 index string putinterval adv}B/set{rw cp
fillstr 0 4 index getinterval putinterval adv}B/fillstr 18 string 0 1 17
{2 copy 255 put pop}for N/pl[{adv 1 chg}{adv 1 chg nd}{1 add chg}{1 add
chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add adv}{/rc X nd}{
1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]A{bind pop}
forall N/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: pstricks.pro
%!
% PostScript prologue for pstricks.tex.
% Version 97 patch 3, 98/06/01
% For distribution, see pstricks.tex.
%
/tx@Dict 200 dict def tx@Dict begin
/ADict 25 dict def
/CM { matrix currentmatrix } bind def
/SLW /setlinewidth load def
/CLW /currentlinewidth load def
/CP /currentpoint load def
/ED { exch def } bind def
/L /lineto load def
/T /translate load def
/TMatrix { } def
/RAngle { 0 } def
/Atan { /atan load stopped { pop pop 0 } if } def
/Div { dup 0 eq { pop } { div } ifelse } def
/NET { neg exch neg exch T } def
/Pyth { dup mul exch dup mul add sqrt } def
/PtoC { 2 copy cos mul 3 1 roll sin mul } def
/PathLength@ { /z z y y1 sub x x1 sub Pyth add def /y1 y def /x1 x def }
def
/PathLength { flattenpath /z 0 def { /y1 ED /x1 ED /y2 y1 def /x2 x1 def
} { /y ED /x ED PathLength@ } {} { /y y2 def /x x2 def PathLength@ }
/pathforall load stopped { pop pop pop pop } if z } def
/STP { .996264 dup scale } def
/STV { SDict begin normalscale end STP  } def
/DashLine { dup 0 gt { /a .5 def PathLength exch div } { pop /a 1 def
PathLength } ifelse /b ED /x ED /y ED /z y x add def b a .5 sub 2 mul y
mul sub z Div round z mul a .5 sub 2 mul y mul add b exch Div dup y mul
/y ED x mul /x ED x 0 gt y 0 gt and { [ y x ] 1 a sub y mul } { [ 1 0 ]
0 } ifelse setdash stroke } def
/DotLine { /b PathLength def /a ED /z ED /y CLW def /z y z add def a 0 gt
{ /b b a div def } { a 0 eq { /b b y sub def } { a -3 eq { /b b y add
def } if } ifelse } ifelse [ 0 b b z Div round Div dup 0 le { pop 1 } if
] a 0 gt { 0 } { y 2 div a -2 gt { neg } if } ifelse setdash 1
setlinecap stroke } def
/LineFill { gsave abs CLW add /a ED a 0 dtransform round exch round exch
2 copy idtransform exch Atan rotate idtransform pop /a ED .25 .25
% DG/SR modification begin - Dec. 12, 1997 - Patch 2
%itransform translate pathbbox /y2 ED a Div ceiling cvi /x2 ED /y1 ED a
itransform pathbbox /y2 ED a Div ceiling cvi /x2 ED /y1 ED a
% DG/SR modification end
Div cvi /x1 ED /y2 y2 y1 sub def clip newpath 2 setlinecap systemdict
/setstrokeadjust known { true setstrokeadjust } if x2 x1 sub 1 add { x1
% DG/SR modification begin - Jun.  1, 1998 - Patch 3 (from Michael Vulis)
% a mul y1 moveto 0 y2 rlineto stroke /x1 x1 1 add def } repeat grestore }
% def
a mul y1 moveto 0 y2 rlineto stroke /x1 x1 1 add def } repeat grestore
pop pop } def
% DG/SR modification end
/BeginArrow { ADict begin /@mtrx CM def gsave 2 copy T 2 index sub neg
exch 3 index sub exch Atan rotate newpath } def
/EndArrow { @mtrx setmatrix CP grestore end } def
/Arrow { CLW mul add dup 2 div /w ED mul dup /h ED mul /a ED { 0 h T 1 -1
scale } if w neg h moveto 0 0 L w h L w neg a neg rlineto gsave fill
grestore } def
/Tbar { CLW mul add /z ED z -2 div CLW 2 div moveto z 0 rlineto stroke 0
CLW moveto } def
/Bracket { CLW mul add dup CLW sub 2 div /x ED mul CLW add /y ED /z CLW 2
div def x neg y moveto x neg CLW 2 div L x CLW 2 div L x y L stroke 0
CLW moveto } def
/RoundBracket { CLW mul add dup 2 div /x ED mul /y ED /mtrx CM def 0 CLW
2 div T x y mul 0 ne { x y scale } if 1 1 moveto .85 .5 .35 0 0 0
curveto -.35 0 -.85 .5 -1 1 curveto mtrx setmatrix stroke 0 CLW moveto }
def
/SD { 0 360 arc fill } def
/EndDot { { /z DS def } { /z 0 def } ifelse /b ED 0 z DS SD b { 0 z DS
CLW sub SD } if 0 DS z add CLW 4 div sub moveto } def
/Shadow { [ { /moveto load } { /lineto load } { /curveto load } {
/closepath load } /pathforall load stopped { pop pop pop pop CP /moveto
load } if ] cvx newpath 3 1 roll T exec } def
/NArray { aload length 2 div dup dup cvi eq not { exch pop } if /n exch
cvi def } def
/NArray { /f ED counttomark 2 div dup cvi /n ED n eq not { exch pop } if
f { ] aload /Points ED } { n 2 mul 1 add -1 roll pop } ifelse } def
/Line { NArray n 0 eq not { n 1 eq { 0 0 /n 2 def } if ArrowA /n n 2 sub
def n { Lineto } repeat CP 4 2 roll ArrowB L pop pop } if } def
/Arcto { /a [ 6 -2 roll ] cvx def a r /arcto load stopped { 5 } { 4 }
ifelse { pop } repeat a } def
/CheckClosed { dup n 2 mul 1 sub index eq 2 index n 2 mul 1 add index eq
and { pop pop /n n 1 sub def } if } def
/Polygon { NArray n 2 eq { 0 0 /n 3 def } if n 3 lt { n { pop pop }
repeat } { n 3 gt { CheckClosed } if n 2 mul -2 roll /y0 ED /x0 ED /y1
ED /x1 ED x1 y1 /x1 x0 x1 add 2 div def /y1 y0 y1 add 2 div def x1 y1
moveto /n n 2 sub def n { Lineto } repeat x1 y1 x0 y0 6 4 roll Lineto
Lineto pop pop closepath } ifelse } def
/Diamond { /mtrx CM def T rotate /h ED /w ED dup 0 eq { pop } { CLW mul
neg /d ED /a w h Atan def /h d a sin Div h add def /w d a cos Div w add
def } ifelse mark w 2 div h 2 div w 0 0 h neg w neg 0 0 h w 2 div h 2
div /ArrowA { moveto } def /ArrowB { } def false Line closepath mtrx
setmatrix } def
% DG modification begin - Jan. 15, 1997
%/Triangle { /mtrx CM def translate rotate /h ED 2 div /w ED dup 0 eq {
%pop } { CLW mul /d ED /h h d w h Atan sin Div sub def /w w d h w Atan 2
%div dup cos exch sin Div mul sub def } ifelse mark 0 d w neg d 0 h w d 0
%d /ArrowA { moveto } def /ArrowB { } def false Line closepath mtrx
%setmatrix } def
/Triangle { /mtrx CM def translate rotate /h ED 2 div /w ED dup
CLW mul /d ED /h h d w h Atan sin Div sub def /w w d h w Atan 2
div dup cos exch sin Div mul sub def mark 0 d w neg d 0 h w d 0
d /ArrowA { moveto } def /ArrowB { } def false Line closepath mtrx
% DG/SR modification begin - Jun.  1, 1998 - Patch 3 (from Michael Vulis)
% setmatrix } def
setmatrix pop } def
% DG/SR modification end
/CCA { /y ED /x ED 2 copy y sub /dy1 ED x sub /dx1 ED /l1 dx1 dy1 Pyth
def } def
/CCA { /y ED /x ED 2 copy y sub /dy1 ED x sub /dx1 ED /l1 dx1 dy1 Pyth
def } def
/CC { /l0 l1 def /x1 x dx sub def /y1 y dy sub def /dx0 dx1 def /dy0 dy1
def CCA /dx dx0 l1 c exp mul dx1 l0 c exp mul add def /dy dy0 l1 c exp
mul dy1 l0 c exp mul add def /m dx0 dy0 Atan dx1 dy1 Atan sub 2 div cos
abs b exp a mul dx dy Pyth Div 2 div def /x2 x l0 dx mul m mul sub def
/y2 y l0 dy mul m mul sub def /dx l1 dx mul m mul neg def /dy l1 dy mul
m mul neg def } def
/IC { /c c 1 add def c 0 lt { /c 0 def } { c 3 gt { /c 3 def } if }
ifelse /a a 2 mul 3 div 45 cos b exp div def CCA /dx 0 def /dy 0 def }
def
/BOC { IC CC x2 y2 x1 y1 ArrowA CP 4 2 roll x y curveto } def
/NC { CC x1 y1 x2 y2 x y curveto } def
/EOC { x dx sub y dy sub 4 2 roll ArrowB 2 copy curveto } def
/BAC { IC CC x y moveto CC x1 y1 CP ArrowA } def
/NAC { x2 y2 x y curveto CC x1 y1 } def
/EAC { x2 y2 x y ArrowB curveto pop pop } def
/OpenCurve { NArray n 3 lt { n { pop pop } repeat } { BOC /n n 3 sub def
n { NC } repeat EOC } ifelse } def
/AltCurve { { false NArray n 2 mul 2 roll [ n 2 mul 3 sub 1 roll ] aload
/Points ED n 2 mul -2 roll } { false NArray } ifelse n 4 lt { n { pop
pop } repeat } { BAC /n n 4 sub def n { NAC } repeat EAC } ifelse } def
/ClosedCurve { NArray n 3 lt { n { pop pop } repeat } { n 3 gt {
CheckClosed } if 6 copy n 2 mul 6 add 6 roll IC CC x y moveto n { NC }
repeat closepath pop pop } ifelse } def
/SQ { /r ED r r moveto r r neg L r neg r neg L r neg r L fill } def
/ST { /y ED /x ED x y moveto x neg y L 0 x L fill } def
/SP { /r ED gsave 0 r moveto 4 { 72 rotate 0 r L } repeat fill grestore }
def
/FontDot { DS 2 mul dup matrix scale matrix concatmatrix exch matrix
rotate matrix concatmatrix exch findfont exch makefont setfont } def
/Rect { x1 y1 y2 add 2 div moveto x1 y2 lineto x2 y2 lineto x2 y1 lineto
x1 y1 lineto closepath } def
/OvalFrame { x1 x2 eq y1 y2 eq or { pop pop x1 y1 moveto x2 y2 L } { y1
y2 sub abs x1 x2 sub abs 2 copy gt { exch pop } { pop } ifelse 2 div
exch { dup 3 1 roll mul exch } if 2 copy lt { pop } { exch pop } ifelse
/b ED x1 y1 y2 add 2 div moveto x1 y2 x2 y2 b arcto x2 y2 x2 y1 b arcto
x2 y1 x1 y1 b arcto x1 y1 x1 y2 b arcto 16 { pop } repeat closepath }
ifelse } def
/Frame { CLW mul /a ED 3 -1 roll 2 copy gt { exch } if a sub /y2 ED a add
/y1 ED 2 copy gt { exch } if a sub /x2 ED a add /x1 ED 1 index 0 eq {
pop pop Rect } { OvalFrame } ifelse } def
/BezierNArray { /f ED counttomark 2 div dup cvi /n ED n eq not { exch pop
} if n 1 sub neg 3 mod 3 add 3 mod { 0 0 /n n 1 add def } repeat f { ]
aload /Points ED } { n 2 mul 1 add -1 roll pop } ifelse } def
/OpenBezier { BezierNArray n 1 eq { pop pop } { ArrowA n 4 sub 3 idiv { 6
2 roll 4 2 roll curveto } repeat 6 2 roll 4 2 roll ArrowB curveto }
ifelse } def
/ClosedBezier { BezierNArray n 1 eq { pop pop } { moveto n 1 sub 3 idiv {
6 2 roll 4 2 roll curveto } repeat closepath } ifelse } def
/BezierShowPoints { gsave Points aload length 2 div cvi /n ED moveto n 1
sub { lineto } repeat CLW 2 div SLW [ 4 4 ] 0 setdash stroke grestore }
def
/Parab { /y0 exch def /x0 exch def /y1 exch def /x1 exch def /dx x0 x1
sub 3 div def /dy y0 y1 sub 3 div def x0 dx sub y0 dy add x1 y1 ArrowA
x0 dx add y0 dy add x0 2 mul x1 sub y1 ArrowB curveto /Points [ x1 y1 x0
y0 x0 2 mul x1 sub y1 ] def } def
/Grid { newpath /a 4 string def /b ED /c ED /n ED cvi dup 1 lt { pop 1 }
if /s ED s div dup 0 eq { pop 1 } if /dy ED s div dup 0 eq { pop 1 } if
/dx ED dy div round dy mul /y0 ED dx div round dx mul /x0 ED dy div
round cvi /y2 ED dx div round cvi /x2 ED dy div round cvi /y1 ED dx div
round cvi /x1 ED /h y2 y1 sub 0 gt { 1 } { -1 } ifelse def /w x2 x1 sub
0 gt { 1 } { -1 } ifelse def b 0 gt { /z1 b 4 div CLW 2 div add def
/Helvetica findfont b scalefont setfont /b b .95 mul CLW 2 div add def }
if systemdict /setstrokeadjust known { true setstrokeadjust /t { } def }
{ /t { transform 0.25 sub round 0.25 add exch 0.25 sub round 0.25 add
exch itransform } bind def } ifelse gsave n 0 gt { 1 setlinecap [ 0 dy n
div ] dy n div 2 div setdash } { 2 setlinecap } ifelse /i x1 def /f y1
dy mul n 0 gt { dy n div 2 div h mul sub } if def /g y2 dy mul n 0 gt {
dy n div 2 div h mul add } if def x2 x1 sub w mul 1 add dup 1000 gt {
pop 1000 } if { i dx mul dup y0 moveto b 0 gt { gsave c i a cvs dup
stringwidth pop /z2 ED w 0 gt {z1} {z1 z2 add neg} ifelse h 0 gt {b neg}
{z1} ifelse rmoveto show grestore } if dup t f moveto g t L stroke /i i
w add def } repeat grestore gsave n 0 gt
% DG/SR modification begin - Nov. 7, 1997 - Patch 1
%{ 1 setlinecap [ 0 dx n div ] dy n div 2 div setdash }
{ 1 setlinecap [ 0 dx n div ] dx n div 2 div setdash }
% DG/SR modification end
{ 2 setlinecap } ifelse /i y1 def /f x1 dx mul
n 0 gt { dx n div 2 div w mul sub } if def /g x2 dx mul n 0 gt { dx n
div 2 div w mul add } if def y2 y1 sub h mul 1 add dup 1000 gt { pop
1000 } if { newpath i dy mul dup x0 exch moveto b 0 gt { gsave c i a cvs
dup stringwidth pop /z2 ED w 0 gt {z1 z2 add neg} {z1} ifelse h 0 gt
{z1} {b neg} ifelse rmoveto show grestore } if dup f exch t moveto g
exch t L stroke /i i h add def } repeat grestore } def
/ArcArrow { /d ED /b ED /a ED gsave newpath 0 -1000 moveto clip newpath 0
1 0 0 b grestore c mul /e ED pop pop pop r a e d PtoC y add exch x add
exch r a PtoC y add exch x add exch b pop pop pop pop a e d CLW 8 div c
mul neg d } def
/Ellipse { /mtrx CM def T scale 0 0 1 5 3 roll arc mtrx setmatrix } def
/Rot { CP CP translate 3 -1 roll neg rotate NET  } def
/RotBegin { tx@Dict /TMatrix known not { /TMatrix { } def /RAngle { 0 }
def } if /TMatrix [ TMatrix CM ] cvx def /a ED a Rot /RAngle [ RAngle
dup a add ] cvx def } def
/RotEnd { /TMatrix [ TMatrix setmatrix ] cvx def /RAngle [ RAngle pop ]
cvx def } def
/PutCoor { gsave CP T CM STV exch exec moveto setmatrix CP grestore } def
/PutBegin { /TMatrix [ TMatrix CM ] cvx def CP 4 2 roll T moveto } def
/PutEnd { CP /TMatrix [ TMatrix setmatrix ] cvx def moveto } def
/Uput { /a ED add 2 div /h ED 2 div /w ED /s a sin def /c a cos def /b s
abs c abs 2 copy gt dup /q ED { pop } { exch pop } ifelse def /w1 c b
div w mul def /h1 s b div h mul def q { w1 abs w sub dup c mul abs } {
h1 abs h sub dup s mul abs } ifelse } def
/UUput { /z ED abs /y ED /x ED q { x s div c mul abs y gt } { x c div s
mul abs y gt } ifelse { x x mul y y mul sub z z mul add sqrt z add } { q
{ x s div } { x c div } ifelse abs } ifelse a PtoC h1 add exch w1 add
exch } def
/BeginOL { dup (all) eq exch TheOL eq or { IfVisible not { Visible
/IfVisible true def } if } { IfVisible { Invisible /IfVisible false def
} if } ifelse } def
/InitOL { /OLUnit [ 3000 3000 matrix defaultmatrix dtransform ] cvx def
/Visible { CP OLUnit idtransform T moveto } def /Invisible { CP OLUnit
neg exch neg exch idtransform T moveto } def /BOL { BeginOL } def
/IfVisible true def } def
end
% END pstricks.pro

%%EndProcSet
%%BeginProcSet: pst-dots.pro
%!PS-Adobe-2.0
%%Title: Dot Font for PSTricks 97 - Version 97, 93/05/07.
%%Creator: Timothy Van Zandt <tvz@Princeton.EDU>
%%Creation Date: May 7, 1993
10 dict dup begin
  /FontType 3 def
  /FontMatrix [ .001 0 0 .001 0 0 ] def
  /FontBBox [ 0 0 0 0 ] def
  /Encoding 256 array def
  0 1 255 { Encoding exch /.notdef put } for
  Encoding
    dup (b) 0 get /Bullet put
    dup (c) 0 get /Circle put
    dup (C) 0 get /BoldCircle put
    dup (u) 0 get /SolidTriangle put
    dup (t) 0 get /Triangle put
    dup (T) 0 get /BoldTriangle put
    dup (r) 0 get /SolidSquare put
    dup (s) 0 get /Square put
    dup (S) 0 get /BoldSquare put
    dup (q) 0 get /SolidPentagon put
    dup (p) 0 get /Pentagon put
    (P) 0 get /BoldPentagon put
  /Metrics 13 dict def
  Metrics begin
    /Bullet 1000 def
    /Circle 1000 def
    /BoldCircle 1000 def
    /SolidTriangle 1344 def
    /Triangle 1344 def
    /BoldTriangle 1344 def
    /SolidSquare 886 def
    /Square 886 def
    /BoldSquare 886 def
    /SolidPentagon 1093.2 def
    /Pentagon 1093.2 def
    /BoldPentagon 1093.2 def
    /.notdef 0 def
  end
  /BBoxes 13 dict def
  BBoxes begin
    /Circle { -550 -550 550 550 } def
    /BoldCircle /Circle load def
    /Bullet /Circle load def
    /Triangle { -571.5 -330 571.5 660 } def
    /BoldTriangle /Triangle load def
    /SolidTriangle /Triangle load def
    /Square { -450 -450 450 450 } def
    /BoldSquare /Square load def
    /SolidSquare /Square load def
    /Pentagon { -546.6 -465 546.6 574.7 } def
    /BoldPentagon /Pentagon load def
    /SolidPentagon /Pentagon load def
    /.notdef { 0 0 0 0 } def
  end
  /CharProcs 20 dict def
  CharProcs begin
    /Adjust {
      2 copy dtransform floor .5 add exch floor .5 add exch idtransform
      3 -1 roll div 3 1 roll exch div exch scale
    } def
    /CirclePath { 0 0 500 0 360 arc closepath } def
    /Bullet { 500 500 Adjust CirclePath fill } def
    /Circle { 500 500 Adjust CirclePath .9 .9 scale CirclePath eofill } def
    /BoldCircle { 500 500 Adjust CirclePath .8 .8 scale CirclePath eofill } def
    /BoldCircle { CirclePath .8 .8 scale CirclePath eofill } def
    /TrianglePath {
      0  660 moveto -571.5 -330 lineto 571.5 -330 lineto closepath
    } def
    /SolidTriangle { TrianglePath fill } def
    /Triangle { TrianglePath .85 .85 scale TrianglePath eofill } def
    /BoldTriangle { TrianglePath .7 .7 scale TrianglePath eofill } def
    /SquarePath {
      -450 450 moveto 450 450 lineto 450 -450 lineto -450 -450 lineto
      closepath
    } def
    /SolidSquare { SquarePath fill } def
    /Square { SquarePath .89 .89 scale SquarePath eofill } def
    /BoldSquare { SquarePath .78 .78 scale SquarePath eofill } def
    /PentagonPath {
      -337.8 -465   moveto
       337.8 -465   lineto
       546.6  177.6 lineto
         0    574.7 lineto
      -546.6  177.6 lineto
      closepath
    } def
    /SolidPentagon { PentagonPath fill } def
    /Pentagon { PentagonPath .89 .89 scale PentagonPath eofill } def
    /BoldPentagon { PentagonPath .78 .78 scale PentagonPath eofill } def
    /.notdef { } def
  end
  /BuildGlyph {
    exch
    begin
      Metrics 1 index get exec 0
      BBoxes 3 index get exec
      setcachedevice
      CharProcs begin load exec end
    end
  } def
  /BuildChar {
    1 index /Encoding get exch get
    1 index /BuildGlyph get exec
  } bind def
end
/PSTricksDotFont exch definefont pop
% END pst-dots.pro

%%EndProcSet
%%BeginProcSet: 8r.enc
% @@psencodingfile@{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "1 July 1998",
%   filename = "8r.enc",
%   email = "tex-fonts@@tug.org",
%   docstring = "Encoding for TrueType or Type 1 fonts
%                to be used with TeX."
% @}
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both 
% ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def

%%EndProcSet
%%BeginProcSet: texps.pro
%!
TeXDict begin/rf{findfont dup length 1 add dict begin{1 index/FID ne 2
index/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type/integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics/Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont/setfont cvx]cvx def}def/ObliqueSlant{
dup sin S cos div neg}B/SlantFont{4 index mul add}def/ExtendFont{3 -1
roll mul exch}def/ReEncodeFont{CharStrings rcheck{/Encoding false def
dup[exch{dup CharStrings exch known not{pop/.notdef/Encoding true def}
if}forall Encoding{]exch pop}{cleartomark}ifelse}if/Encoding exch def}
def end

%%EndProcSet
%%BeginProcSet: special.pro
%!
TeXDict begin/SDict 200 dict N SDict begin/@SpecialDefaults{/hs 612 N
/vs 792 N/ho 0 N/vo 0 N/hsc 1 N/vsc 1 N/ang 0 N/CLIP 0 N/rwiSeen false N
/rhiSeen false N/letter{}N/note{}N/a4{}N/legal{}N}B/@scaleunit 100 N
/@hscale{@scaleunit div/hsc X}B/@vscale{@scaleunit div/vsc X}B/@hsize{
/hs X/CLIP 1 N}B/@vsize{/vs X/CLIP 1 N}B/@clip{/CLIP 2 N}B/@hoffset{/ho
X}B/@voffset{/vo X}B/@angle{/ang X}B/@rwi{10 div/rwi X/rwiSeen true N}B
/@rhi{10 div/rhi X/rhiSeen true N}B/@llx{/llx X}B/@lly{/lly X}B/@urx{
/urx X}B/@ury{/ury X}B/magscale true def end/@MacSetUp{userdict/md known
{userdict/md get type/dicttype eq{userdict begin md length 10 add md
maxlength ge{/md md dup length 20 add dict copy def}if end md begin
/letter{}N/note{}N/legal{}N/od{txpose 1 0 mtx defaultmatrix dtransform S
atan/pa X newpath clippath mark{transform{itransform moveto}}{transform{
itransform lineto}}{6 -2 roll transform 6 -2 roll transform 6 -2 roll
transform{itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll
curveto}}{{closepath}}pathforall newpath counttomark array astore/gc xdf
pop ct 39 0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}
if}N/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1
-1 scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3
get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip
yflip not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub
neg 0 TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{
noflips{TR pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop
90 rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get
neg sub neg TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr
1 get neg sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr
2 get ppr 0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4
-1 roll add 2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S
TR}if}N/cp{pop pop showpage pm restore}N end}if}if}N/normalscale{
Resolution 72 div VResolution 72 div neg scale magscale{DVImag dup scale
}if 0 setgray}N/psfts{S 65781.76 div N}N/startTexFig{/psf$SavedState
save N userdict maxlength dict begin/magscale true def normalscale
currentpoint TR/psf$ury psfts/psf$urx psfts/psf$lly psfts/psf$llx psfts
/psf$y psfts/psf$x psfts currentpoint/psf$cy X/psf$cx X/psf$sx psf$x
psf$urx psf$llx sub div N/psf$sy psf$y psf$ury psf$lly sub div N psf$sx
psf$sy scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub
TR/showpage{}N/erasepage{}N/copypage{}N/p 3 def @MacSetUp}N/doclip{
psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4 copy 4 2
roll moveto 6 -1 roll S lineto S lineto S lineto closepath clip newpath
moveto}N/endTexFig{end psf$SavedState restore}N/@beginspecial{SDict
begin/SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count/ocount X/dcount countdictstack N}N/@setspecial{
CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto
closepath clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx
sub div rhiSeen{rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR
}{rhiSeen{rhi ury lly sub div dup scale llx neg lly neg TR}if}ifelse
CLIP 2 eq{newpath llx lly moveto urx lly lineto urx ury lineto llx ury
lineto closepath clip}if/showpage{}N/erasepage{}N/copypage{}N newpath}N
/@endspecial{count ocount sub{pop}repeat countdictstack dcount sub{end}
repeat grestore SpecialSave restore end}N/@defspecial{SDict begin}N
/@fedspecial{end}B/li{lineto}B/rl{rlineto}B/rc{rcurveto}B/np{/SaveX
currentpoint/SaveY X N 1 setlinecap newpath}N/st{stroke SaveX SaveY
moveto}N/fil{fill SaveX SaveY moveto}N/ellipse{/endangle X/startangle X
/yrad X/xrad X/savematrix matrix currentmatrix N TR xrad yrad scale 0 0
1 startangle endangle arc savematrix setmatrix}N end

%%EndProcSet
%%BeginProcSet: color.pro
%!
TeXDict begin/setcmykcolor where{pop}{/setcmykcolor{dup 10 eq{pop
setrgbcolor}{1 sub 4 1 roll 3{3 index add neg dup 0 lt{pop 0}if 3 1 roll
}repeat setrgbcolor pop}ifelse}B}ifelse/TeXcolorcmyk{setcmykcolor}def
/TeXcolorrgb{setrgbcolor}def/TeXcolorgrey{setgray}def/TeXcolorgray{
setgray}def/TeXcolorhsb{sethsbcolor}def/currentcmykcolor where{pop}{
/currentcmykcolor{currentrgbcolor 10}B}ifelse/DC{exch dup userdict exch
known{pop pop}{X}ifelse}B/GreenYellow{0.15 0 0.69 0 setcmykcolor}DC
/Yellow{0 0 1 0 setcmykcolor}DC/Goldenrod{0 0.10 0.84 0 setcmykcolor}DC
/Dandelion{0 0.29 0.84 0 setcmykcolor}DC/Apricot{0 0.32 0.52 0
setcmykcolor}DC/Peach{0 0.50 0.70 0 setcmykcolor}DC/Melon{0 0.46 0.50 0
setcmykcolor}DC/YellowOrange{0 0.42 1 0 setcmykcolor}DC/Orange{0 0.61
0.87 0 setcmykcolor}DC/BurntOrange{0 0.51 1 0 setcmykcolor}DC
/Bittersweet{0 0.75 1 0.24 setcmykcolor}DC/RedOrange{0 0.77 0.87 0
setcmykcolor}DC/Mahogany{0 0.85 0.87 0.35 setcmykcolor}DC/Maroon{0 0.87
0.68 0.32 setcmykcolor}DC/BrickRed{0 0.89 0.94 0.28 setcmykcolor}DC/Red{
0 1 1 0 setcmykcolor}DC/OrangeRed{0 1 0.50 0 setcmykcolor}DC/RubineRed{
0 1 0.13 0 setcmykcolor}DC/WildStrawberry{0 0.96 0.39 0 setcmykcolor}DC
/Salmon{0 0.53 0.38 0 setcmykcolor}DC/CarnationPink{0 0.63 0 0
setcmykcolor}DC/Magenta{0 1 0 0 setcmykcolor}DC/VioletRed{0 0.81 0 0
setcmykcolor}DC/Rhodamine{0 0.82 0 0 setcmykcolor}DC/Mulberry{0.34 0.90
0 0.02 setcmykcolor}DC/RedViolet{0.07 0.90 0 0.34 setcmykcolor}DC
/Fuchsia{0.47 0.91 0 0.08 setcmykcolor}DC/Lavender{0 0.48 0 0
setcmykcolor}DC/Thistle{0.12 0.59 0 0 setcmykcolor}DC/Orchid{0.32 0.64 0
0 setcmykcolor}DC/DarkOrchid{0.40 0.80 0.20 0 setcmykcolor}DC/Purple{
0.45 0.86 0 0 setcmykcolor}DC/Plum{0.50 1 0 0 setcmykcolor}DC/Violet{
0.79 0.88 0 0 setcmykcolor}DC/RoyalPurple{0.75 0.90 0 0 setcmykcolor}DC
/BlueViolet{0.86 0.91 0 0.04 setcmykcolor}DC/Periwinkle{0.57 0.55 0 0
setcmykcolor}DC/CadetBlue{0.62 0.57 0.23 0 setcmykcolor}DC
/CornflowerBlue{0.65 0.13 0 0 setcmykcolor}DC/MidnightBlue{0.98 0.13 0
0.43 setcmykcolor}DC/NavyBlue{0.94 0.54 0 0 setcmykcolor}DC/RoyalBlue{1
0.50 0 0 setcmykcolor}DC/Blue{1 1 0 0 setcmykcolor}DC/Cerulean{0.94 0.11
0 0 setcmykcolor}DC/Cyan{1 0 0 0 setcmykcolor}DC/ProcessBlue{0.96 0 0 0
setcmykcolor}DC/SkyBlue{0.62 0 0.12 0 setcmykcolor}DC/Turquoise{0.85 0
0.20 0 setcmykcolor}DC/TealBlue{0.86 0 0.34 0.02 setcmykcolor}DC
/Aquamarine{0.82 0 0.30 0 setcmykcolor}DC/BlueGreen{0.85 0 0.33 0
setcmykcolor}DC/Emerald{1 0 0.50 0 setcmykcolor}DC/JungleGreen{0.99 0
0.52 0 setcmykcolor}DC/SeaGreen{0.69 0 0.50 0 setcmykcolor}DC/Green{1 0
1 0 setcmykcolor}DC/ForestGreen{0.91 0 0.88 0.12 setcmykcolor}DC
/PineGreen{0.92 0 0.59 0.25 setcmykcolor}DC/LimeGreen{0.50 0 1 0
setcmykcolor}DC/YellowGreen{0.44 0 0.74 0 setcmykcolor}DC/SpringGreen{
0.26 0 0.76 0 setcmykcolor}DC/OliveGreen{0.64 0 0.95 0.40 setcmykcolor}
DC/RawSienna{0 0.72 1 0.45 setcmykcolor}DC/Sepia{0 0.83 1 0.70
setcmykcolor}DC/Brown{0 0.81 1 0.60 setcmykcolor}DC/Tan{0.14 0.42 0.56 0
setcmykcolor}DC/Gray{0 0 0 0.50 setcmykcolor}DC/Black{0 0 0 1
setcmykcolor}DC/White{0 0 0 0 setcmykcolor}DC end

%%EndProcSet
TeXDict begin 39158280 55380996 1000 600 600 (humus.dvi)
@start
%DVIPSBitmapFont: Fa cmmi8 8 1
/Fa 1 111 df<3907C007E0391FE03FF83918F8783E393879E01E39307B801F38707F00
126013FEEAE0FC12C05B00815C0001143E5BA20003147E157C5B15FC0007ECF8081618EB
C00115F0000F1538913803E0300180147016E0001F010113C015E390C7EAFF00000E143E
251F7E9D2B>110 D E
%EndDVIPSBitmapFont
/Fb 139[60 60 60 1[60 60 1[60 60 60 3[60 1[60 2[60 60
12[60 37[60 46[{TeXBase1Encoding ReEncodeFont}14 99.6264
/Courier rf /Fc 143[51 45 2[25 42[66 65[{
.167 SlantFont TeXBase1Encoding ReEncodeFont}4 90.9091
/Times-Bold rf /Fd 143[55 50 2[28 42[72 65[{
.167 SlantFont TeXBase1Encoding ReEncodeFont}4 99.6264
/Times-Bold rf /Fe 145[60 4[60 1[60 1[60 60 100[{
TeXBase1Encoding ReEncodeFont}5 99.6264 /Courier-Bold
rf /Ff 171[44 37 6[44 10[48 65[{TeXBase1Encoding ReEncodeFont}4
66.4176 /Times-Bold rf
%DVIPSBitmapFont: Fg cmex10 10 8
/Fg 8 63 df<12F0B3B3B2043674811C>12 D<EC01F01407140F143F147F903801FFC049
1380491300495A495A495A495A5C495A485B5A91C7FC485AA2485AA2485AA2123F5BA212
7F5BA412FF5BB3B3A71C4B607E4A>56 D<12F812FE6C7E7F13F0EA3FF86C7E6C7EEA03FF
6C7F6C7F6D7E6D7E806D7E130F6D7E807F15807F15C07FA2EC7FE0A3EC3FF0A415F8141F
B3B3A71D4B737E4A>I<EAFFC0B3B3A77F127FA47F123FA27F121FA26C7EA26C7EA26C7E
807E6C7F6D7E806D7E6D7E6D7E6D7E6D13806D13C09038007FF0143F140F140714011C4B
60804A>I<EC1FF8B3B3A7143F15F0A4EC7FE0A3ECFFC0A25B15805B15005B5C495A131F
495A5C495A495A485B4890C7FCEA0FFE485A485AB45A13C05B48C8FC12F81D4B73804A>
I<EC1FF8B3B3A7143F15F0A4EC7FE0A315C014FFA2491380A215005B5C1307495A5C131F
495A5C495A495A4890C7FC485A485A485A485AEA7FE0EAFF8090C8FC12FCB4FC7FEA7FE0
EA1FF06C7E6C7E6C7E6C7E6C7F6D7E6D7E806D7E130F806D7E1303807F1580A26D13C0A2
147F15E0A3EC3FF0A415F8141FB3B3A71D9773804A>I<EAFFC0B3B3A86C7EA56C7EA36C
7EA2120F7FA26C7E12037F7E807E6D7E6D7E80131F6D7E6D7E6D7E6D7E6D1380EC3FE0EC
1FF0140714031407141FEC3FE0ECFF80491300495A495A495A495A133F5C495A495A5A91
C7FC5A5B1207485AA25B121FA2485AA3485AA5485AB3B3A81C9760804A>I<EAFFC0B3A9
0A1B60804A>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fh cmr10 10 11
/Fh 11 62 df<146014E0EB01C0EB0380EB0700130E131E5B5BA25B485AA2485AA21207
5B120F90C7FCA25A121EA2123EA35AA65AB2127CA67EA3121EA2121F7EA27F12077F1203
A26C7EA26C7E1378A27F7F130E7FEB0380EB01C0EB00E01460135278BD20>40
D<12C07E12707E7E7E120F6C7E6C7EA26C7E6C7EA21378A2137C133C133E131EA2131F7F
A21480A3EB07C0A6EB03E0B2EB07C0A6EB0F80A31400A25B131EA2133E133C137C1378A2
5BA2485A485AA2485A48C7FC120E5A5A5A5A5A13527CBD20>I<15301578B3A6007FB812
F8B912FCA26C17F8C80078C8FCB3A6153036367BAF41>43 D<EB03F8EB1FFF90387E0FC0
9038F803E03901E000F0484813780007147C48487FA248C77EA2481580A3007EEC0FC0A6
00FE15E0B3007E15C0A4007F141F6C1580A36C15006D5B000F143EA26C6C5B6C6C5B6C6C
485A6C6C485A90387E0FC0D91FFFC7FCEB03F8233A7DB72A>48 D<EB01C013031307131F
13FFB5FCA2131F1200B3B3A8497E007FB512F0A31C3879B72A>I<EB0FF0EB7FFE48B57E
3903E03FE0390F000FF0000E6D7E486D7E486D7E123000706D7E126012FCB4EC7F807FA5
6CC7FC121CC8FCEDFF00A34A5A5D14035D4A5A5D140F4A5A4A5A92C7FC147C5C495A495A
495A495A91C8FC011EEB01805B5B49130348481400485A485A000EC75A000FB6FC5A5A48
5CB6FCA321387CB72A>I<EB07F8EB3FFF4913C03901F80FF03903C007F848486C7E380E
0001000F80381FE0006D7FA56C5A6C5AC85A1401A25D4A5AA24A5A5DEC0F80027EC7FCEB
1FFCECFF809038000FE06E7EEC01FC816E7EED7F80A216C0A2153F16E0A2121EEA7F8048
7EA416C049137F007F1580007EC7FC0070ECFF006C495A121E390F8003F83907F00FF000
01B512C06C6C90C7FCEB0FF8233A7DB72A>I<1538A2157815F8A2140114031407A2140F
141F141B14331473146314C313011483EB030313071306130C131C131813301370136013
C01201EA038013005A120E120C5A123812305A12E0B712F8A3C73803F800AB4A7E0103B5
12F8A325397EB82A>I<EB03F8EB1FFF017F13C09038FC07F03901E001F848486C7E4848
137C90C77E48141E000E141F001E80A3121FA27F5D01E0131E6C6C133E01FC133C6D5B6C
6C6C5AECC1E06CEBF3C06C01FFC7FC6C5BEB3FFF6D13C081017F13F801F07F3903E07FFE
3907801FFF48486C1380481303003E6D13C0003CEB007F007C143F0078EC0FE000F81407
5A1503A21501A36C15C012781503007C15806CEC07006C5C6C6C131ED807E0137C3903F8
03F0C6B55A013F1380D907FCC7FC233A7DB72A>56 D<EB03F8EB1FFF017F13C09038FC07
E03903F803F048486C7E48486C7E49137E121F48487FA2007F158090C7FCA248EC1FC0A6
16E0A56C143FA27F123F001F147FA26C6C13FF3907E001DF0003149F3801F0033900FC0F
1FD93FFC13C0EB07F090C7FC153F1680A316005D000F147E487E486C5BA24A5A4A5A4948
5A6C48485A001C495A260F807FC7FC3807FFFC000113F038003FC0233A7DB72A>I<007F
B812F8B912FCA26C17F8CCFCAE007FB812F8B912FCA26C17F836167B9F41>61
D E
%EndDVIPSBitmapFont
/Fi 137[37 1[21 37 25 1[42 42 42 62 6[21 42 42 37 1[42
1[42 10[46 50 54 5[42 2[21 2[46 4[50 12[42 1[42 42 42
3[21 2[25 25 40[{TeXBase1Encoding ReEncodeFont}28 74.7198
/Helvetica rf /Fj 138[37 18 33 22 37 2[37 7[18 37 37
33 1[37 12[41 44 48 5[37 2[18 2[41 4[44 65[{
TeXBase1Encoding ReEncodeFont}18 66.4176 /Helvetica rf
/Fk 167[58 80 2[53 44 2[49 62 58 1[53 4[62 1[53 2[53
58 65[{TeXBase1Encoding ReEncodeFont}12 79.701 /Times-Bold
rf /Fl 167[69 3[64 53 6[64 9[64 69 65[{TeXBase1Encoding ReEncodeFont}6
95.6413 /Times-Bold rf /Fm 140[55 4[55 55 55 2[55 1[55
1[55 55 1[55 98[{TeXBase1Encoding ReEncodeFont}9 90.9091
/Courier-Oblique rf /Fn 138[55 1[39 2[50 1[55 78 28 2[28
3[44 1[44 1[50 19[89 4[78 25[25 46[{TeXBase1Encoding ReEncodeFont}13
99.6264 /Times-BoldItalic rf
%DVIPSBitmapFont: Fo cmr10 10.95 1
/Fo 1 44 df<1506150FB3A9007FB912E0BA12F0A26C18E0C8000FC9FCB3A915063C3C7B
B447>43 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fp cmsy10 10 4
/Fp 4 106 df<007FB81280B912C0A26C17803204799641>0 D<173CA2173E171E171F83
84717E170384717E717E187C007FB812FEBAFC856C84CBEA03F0727EF000FEF13F80F11F
E0F107F8F101FFA2F107F8F11FE0F13F80F1FE00F001F84E5A007FB912C0BA5A96C7FC6C
5FCB127C604D5A4D5A6017074D5A95C8FC5F171E173E173CA248307BAC53>41
D<14C0EB01E01303A214C01307A21480130FA2EB1F00A2131E133EA25BA2137813F8A248
5AA25B1203A25B1207A2485AA290C7FC5AA2123EA2123C127CA2127812F8A41278127CA2
123C123EA27EA27E7FA26C7EA212037FA212017FA26C7EA21378137CA27FA2131E131FA2
EB0F80A2130714C0A2130314E0A21301EB00C0135278BD20>104
D<126012F07EA21278127CA2123C123EA27EA27E7FA26C7EA212037FA26C7EA212007FA2
1378137CA27FA2131E131FA2EB0F80A2130714C0A2130314E0A414C01307A21480130FA2
EB1F00A2131E133EA25BA2137813F8A25B1201A2485AA25B1207A2485AA290C7FC5AA212
3EA2123C127CA2127812F8A25A126013527CBD20>I E
%EndDVIPSBitmapFont
/Fq 152[37 25 33 37 33 37 33 39[37 37 37 37 37 37 37
37 37 37 48[{TeXBase1Encoding ReEncodeFont}17 74.7198
/Times-Roman rf /Fr 140[55 1[55 2[55 3[55 55 1[55 1[55
55 55 1[55 1[55 6[55 3[55 55 55 55 55 55 4[55 55 55 2[55
55 55 55 66[{TeXBase1Encoding ReEncodeFont}25 90.9091
/Courier-Bold rf /Fs 134[40 40 1[40 40 40 40 40 40 40
40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 1[40 1[40
1[40 2[40 1[40 40 40 40 40 40 40 40 40 40 40 1[40 40
40 40 40 40 40 40 40 40 1[40 40 40 1[40 40 10[40 40 40
40 40 40 40 40 40 40 1[40 40 40 40 33[{TeXBase1Encoding ReEncodeFont}68
66.4176 /Courier rf
%DVIPSBitmapFont: Ft cmsy10 10.95 3
/Ft 3 42 df<EB0FFCEB3FFF90B512C0000314F04880488048804880A2481580A3B712C0
AA6C1580A36C1500A26C5C6C5C6C5C6C5CC614C0013F90C7FCEB0FFC22227BA72D>15
D<007FB912E0BA12F0A26C18E0CDFCAE007FB912E0BA12F0A26C18E0CDFCAE007FB912E0
BA12F0A26C18E03C287BAA47>17 D<EF01E0841700841878187C84A284727E727E851803
727E007FB912FCBA7E856C85CCEA07E0737EF101FCF1007FF21FC0F20FF8F203FFA2F20F
F8F21FC0F27F00F101FCF103F04F5A007FBA1280BBC7FC616C60CBEA01F04E5A1807614E
5A4EC8FC183EA260187818F86017016050327BAF5B>41 D E
%EndDVIPSBitmapFont
/Fu 68[50 15[50 22[50 21[50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 33[{TeXBase1Encoding ReEncodeFont}
97 83.022 /Courier rf
%DVIPSBitmapFont: Fv cmmi10 10 9
/Fv 9 120 df<EF0380EF0FC0173FEFFF80933803FE00EE0FF8EE3FE0EEFF80DB03FEC7
FCED0FF8ED3FE0EDFF80DA03FEC8FCEC0FF8EC3FE0ECFF80D903FEC9FCEB0FF8EB3FE0EB
FF80D803FECAFCEA0FF8EA3FE0EA7F8000FECBFCA2EA7F80EA3FE0EA0FF8EA03FEC66C7E
EB3FE0EB0FF8EB03FE903800FF80EC3FE0EC0FF8EC03FE913800FF80ED3FE0ED0FF8ED03
FE923800FF80EE3FE0EE0FF8EE03FE933800FF80EF3FC0170FEF0380323279AD41>60
D<126012FCB4FCEA7FC0EA1FF0EA07FCEA01FF38007FC0EB1FF0EB07FCEB01FF9038007F
C0EC1FF0EC07FCEC01FF9138007FC0ED1FF0ED07FCED01FF9238007FC0EE1FF0EE07FCEE
01FF9338007F80EF1FC0A2EF7F80933801FF00EE07FCEE1FF0EE7FC04B48C7FCED07FCED
1FF0ED7FC04A48C8FCEC07FCEC1FF0EC7FC04948C9FCEB07FCEB1FF0EB7FC04848CAFCEA
07FCEA3FF0EA7FC048CBFC12FC1270323279AD41>62 D<163FED1FFFA3ED007F167EA216
FEA216FCA21501A216F8A21503A216F0A21507A2027E13E0903803FF8790380FC1CF9038
1F00EF017EEB7FC049133F485A4848131F000715805B000F143F485A1600485A5D127F90
C7127EA215FE5A485CA21401A248ECF80CA21403161CEDF0181407007C1538007E010F13
30003E131F027B13706C01E113E03A0F83C0F9C03A03FF007F80D800FCEB1F00283B7DB9
2B>100 D<EC3FC0903801FFF0903807E07890381F801C90387E001E49130E485A485A12
07485A49131E001F141C153C484813F8EC03E0007FEB3FC09038FFFE0014E090C8FC5A5A
A7007E140315071506003E140E153C6C14706C6C13E0EC07C03903E03F003801FFF83800
3FC020267DA427>I<EB03F0EA01FFA3EA00075CA3130F5CA3131F5CA3133F91C9FCA35B
90387E03F8EC0FFF91383C0F809039FEF007C0D9FDC07FEBFF80EC0003485A5BA2491307
12035BA2150F00075D5BA2151F000F5D5B153F93C7FC121F4990387F0180157EEDFE0300
3F02FC130090C7FC5EEDF80648150E007E150C161C5E00FEEC787048EC3FE00038EC0F80
293B7CB930>104 D<D803E0017F14FE3D07F801FFE003FFC03D0E3C0781F00F03E03D1C
3E1E00F83C01F026383F38D9FC707F00304914E04A90387DC000007049EB7F8000604991
C7FCA200E090C700FE1301485A017E5CA200000201140301FE5F495CA203031407000160
495C180F03075D1203494A011F13601980030F023F13E00007F000C0495C1901031F023E
1380000F1803494A150061033F150E001FEF1E1C4991C7EA0FF80007C7000EEC03E04326
7EA449>109 D<EC1FC0ECFFF8903807E07E90380F801F90393F000F80017E14C0491307
484814E0485A4848EB03F0120F5B121F48481307A2127F90C7FCA2150F5A4815E0A2151F
16C0A248EC3F8016005D157E007E5C4A5A003E495A003F495A6C495A6C6C48C7FC3807E0
7E3801FFF038003F8024267DA428>111 D<3903E001F83907F807FE390E3C1E07391C3E
381F3A183F703F800038EBE07F0030EBC0FF00705B00601500EC007E153CD8E07F90C7FC
EAC07EA2120013FE5BA312015BA312035BA312075BA3120F5BA3121F5B0007C9FC21267E
A425>114 D<01F816F0D803FE9138E001F8D8070F903801F003000ED9800314FC121C12
180038020713010030EDE000D8701F167C1260030F143CD8E03F163800C001005B5BD800
7E131F183001FE5C5B033F1470000117604991C7FCA218E000034A14C049137E17011880
170318005F03FE1306170E000101015C01F801BF5B3B00FC039F8070903A7E0F0FC0E090
3A1FFC03FFC0902703F0007FC7FC36267EA43B>119 D E
%EndDVIPSBitmapFont
/Fw 190[48 65[{TeXBase1Encoding ReEncodeFont}1 66.4176
/Times-Roman rf /Fx 133[40 45 45 66 45 45 25 35 30 45
45 45 45 71 25 45 25 25 45 45 30 40 45 40 45 40 9[86
66 1[56 51 61 66 51 2[81 56 66 1[30 66 66 1[56 66 1[61
66 6[25 12[30 42[51 2[{.167 SlantFont TeXBase1Encoding ReEncodeFont}46
90.9091 /Times-Roman rf /Fy 12[42 125[42 2[28 5[23 2[23
1[42 4[42 37 14[55 1[46 5[32 2[60 46 4[60 5[23 14[21
44[{.167 SlantFont TeXBase1Encoding ReEncodeFont}16 83.022
/Times-Roman rf /Fz 167[53 69 2[44 40 49 53 40 53 53
1[44 53 3[53 40 44 2[49 53 65[{TeXBase1Encoding ReEncodeFont}16
72.7272 /Times-Roman rf /FA 167[53 3[49 40 2[44 3[49
4[57 4[49 53 65[{TeXBase1Encoding ReEncodeFont}8 72.7272
/Times-Bold rf /FB 135[55 55 55 55 55 55 55 55 55 55
55 55 55 55 55 55 55 55 55 55 55 55 55 55 1[55 4[55 1[55
55 55 1[55 55 55 1[55 55 55 55 55 55 2[55 1[55 55 55
55 55 55 3[55 2[55 55 55 55 55 55 55 55 55 55 55 55 55
55 55 55 55 55 55 1[55 55 55 55 35[{TeXBase1Encoding ReEncodeFont}69
90.9091 /Courier rf /FC 138[45 1[35 2[45 1[45 66 25 2[25
3[40 1[40 1[45 19[76 4[66 25[23 46[{TeXBase1Encoding ReEncodeFont}13
90.9091 /Times-Italic rf /FD 105[45 27[40 45 45 66 45
51 30 35 40 51 51 45 51 76 25 51 30 25 51 45 30 40 51
40 51 45 7[66 66 91 66 66 61 51 66 71 56 71 66 86 61
71 45 35 71 71 56 61 66 66 61 66 6[30 45 45 45 45 45
45 45 45 45 45 25 23 30 1[52 1[30 30 37[51 2[{
TeXBase1Encoding ReEncodeFont}70 90.9091 /Times-Bold
rf /FE 145[50 78 28 2[28 3[44 50 2[44 38[28 12[33 25
44[{TeXBase1Encoding ReEncodeFont}10 99.6264 /Times-Roman
rf
%DVIPSBitmapFont: FF cmsy9 9 1
/FF 1 122 df<131E133FA8131EA7130CA2007CEB0F8039FFCCFFC090B5FCA213CC397C
0C0F80000090C7FC131EA5133FB3A4131EAD130CA51A467CB423>121
D E
%EndDVIPSBitmapFont
/FG 12[45 10[40 7[40 75[40 40 24[40 45 45 66 45 45 25
35 30 45 45 45 45 71 25 45 25 25 45 45 30 40 45 40 45
40 8[66 86 66 66 56 51 61 66 51 66 66 81 56 66 35 30
66 66 51 56 66 61 61 66 1[40 3[25 25 45 45 45 45 45 45
45 45 45 45 25 23 30 23 51 1[30 30 30 4[37 31[51 2[{
TeXBase1Encoding ReEncodeFont}78 90.9091 /Times-Roman
rf /FH 139[40 47 53 2[60 66 100 3[33 66 1[40 53 1[53
66 60 14[86 5[80 2[47 1[93 71[{
.167 SlantFont TeXBase1Encoding ReEncodeFont}17 119.552
/Times-Bold rf /FI 133[32 37 37 55 37 42 23 32 32 42
42 42 42 60 23 37 23 23 42 42 23 37 42 37 42 42 7[46
51 69 51 60 46 42 51 60 51 60 55 69 46 55 37 28 60 60
51 51 60 55 51 51 6[28 7[42 2[23 21 28 1[56 42 28 28
37[42 2[{TeXBase1Encoding ReEncodeFont}61 83.022 /Times-Italic
rf /FJ 134[42 1[60 42 42 23 32 28 1[42 42 42 65 23 42
1[23 42 42 28 37 42 37 42 37 9[78 28[23 7[42 42 2[21
28 21 44[{TeXBase1Encoding ReEncodeFont}29 83.022 /Times-Roman
rf /FK 136[60 42 1[28 32 37 2[42 46 69 3[23 46 1[28 37
46 37 46 42 13[46 60 4[78 55 2[32 1[65 51 3[55 60 10[42
3[42 1[42 3[21 44[{TeXBase1Encoding ReEncodeFont}29 83.022
/Times-Bold rf /FL 104[100 28[44 50 50 72 50 55 33 39
44 55 55 50 55 83 28 55 33 28 55 50 33 44 55 44 55 50
8[72 100 72 72 66 55 72 78 61 2[94 66 78 1[39 78 78 61
66 72 72 66 72 93 5[33 2[50 50 50 50 50 50 50 50 1[25
33 25 4[33 36[55 2[{TeXBase1Encoding ReEncodeFont}63
99.6264 /Times-Bold rf /FM 12[60 5[33 114[53 60 60 2[66
40 47 53 66 66 60 66 100 33 66 1[33 66 60 40 53 66 53
66 60 10[86 1[80 66 86 1[73 2[113 80 1[60 47 1[93 73
80 86 86 80 86 9[60 60 60 60 60 60 60 2[30 40 45[{
TeXBase1Encoding ReEncodeFont}50 119.552 /Times-Bold
rf /FN 178[195 4[161 161 5[149 65[{TeXBase1Encoding ReEncodeFont}4
206.559 /Times-Bold rf /FO 166[119 3[119 110 92 3[129
119 156 110 2[64 1[129 1[110 3[119 65[{TeXBase1Encoding ReEncodeFont}12
165.247 /Times-Bold rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%BeginPaperSize: a4
a4
%%EndPaperSize

%%EndSetup
%%Page: 1 1
1 0 bop Black Black Black Black 431 1618 a FN(H)10 b
FO(U)g(M)g(A)g(N)63 b FN(G)10 b FO(E)g(N)g(O)g(M)g(E)63
b FN(A)10 b FO(N)g(N)g(O)s(T)-5 b(A)f(T)10 b(I)g(O)g(N)627
1788 y(U)g(S)g(I)g(N)g(G)63 b FN(M)10 b FO(O)g(U)g(S)g(E)63
b FN(H)10 b FO(O)g(M)g(O)g(L)g(O)g(G)g(Y)1527 2105 y
FM(J)n(osep)30 b(F)-13 b(.)30 b(Abril)1570 2259 y(Gen\355s)h(P)o(arra)
1507 2413 y(Roderic)g(Guig\363)1463 2731 y FL(\227)25
b(Mar)n(ch)h(6,)e(2002\227)p Black Black 1726 3239 a
FK(Abstract)p Black Black Black Black 607 3363 a FJ(W)-7
b(e)21 b(are)e(going)f(to)i(scale)g(up)f(all)h(the)g(processes)f(we)h
(ha)n(v)o(e)f(tested)h(on)f FI(Homo)g(sapiens)g FJ(chro-)607
3463 y(mosomes)g(22)f(and)h(21,)g(to)g(the)g(whole)g(genome)f
(approach,)f(in)i(which)g(we)g(tak)o(e)h(adv)n(antage)607
3562 y(of)c(the)g(homology)d(between)i FI(H.)h(sapiens)f
FJ(and)h FI(Mus)g(musculus)f FJ(genomes)g(to)h(increase)f(gene)607
3662 y(prediction)21 b(accurac)o(y)g(and)h(producing)e(a)j(better)g
(genome)e(annotation)f(of)j(the)g(coding)e(re-)607 3761
y(gions.)2270 5277 y
 tx@Dict begin CP CP translate 0.9  1.  scale NET  end
 2270 5277 a FH(Genome)30 b(Inf)m(ormatics)e
(Resear)n(ch)j(Lab)2270 5277 y
 tx@Dict begin CP CP translate 1 0.9 div 1 1. div scale NET  end
 2270 5277 a 2336 5390
a FG(Grup)23 b(de)h(Recerca)g(en)g(Infom\340tica)h(Biom\350dica)2401
5503 y(Institut)h(Municipal)f(d'In)l(v)o(estigaci\363)j(M\350dica)2939
5616 y(Uni)n(v)o(ersitat)d(Pompeu)f(F)o(abra)1212 5776
y FF(y)1259 5811 y FE(e-mail:)30 b FL(jabril@imim.es)p
FE(,)24 b FL(gparra@imim.es)g FE(and)h FL(r)o(guigo@imim.es)p
Black Black eop
%%Page: 1 2
1 1 bop Black Black Black Black eop
%%Page: 1 3
1 2 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(CONTENTS)2774 b(i)p -128 -243 4016 9 v Black -128
35 a FM(Contents)-128 242 y FD(1)92 b(Intr)n(oduction)3342
b(1)9 355 y FG(1.1)96 b(Project)24 b(protocol)52 b(.)45
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)p Black 175 w(1)p Black 9 468
a(1.2)96 b(Making)24 b(up)g(the)g(jobs)g(list)67 b(.)46
b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)p Black 175 w(1)p Black 9 580 a(1.3)96 b(Basic)24
b(squetch)h(of)f(job)f(and)h(step)h(records)99 b(.)45
b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black
175 w(2)p Black 9 693 a(1.4)96 b(Main)24 b(job)f(collector)32
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 175 w(3)p Black -128
897 a FD(2)92 b(Sequence)22 b(Analysis)3121 b(4)9 1010
y FG(2.1)96 b(Initialization)35 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
p Black 175 w(4)p Black 9 1123 a(2.2)96 b(Sequence)25
b(analysis:)31 b FC(H.sapiens)i FG(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 175 w(4)p
Black 218 1236 a(2.2.1)110 b(Retrie)n(ving)25 b(annotations)i(from)c
(Golden)i(P)o(ath)72 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 175 w(5)p Black 218 1349 a(2.2.2)110 b(Preparing)25
b(annotation)i(\002les)c(for)h(e)n(v)n(aluation)43 b(.)i(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)p Black 175 w(5)p Black 218 1462 a(2.2.3)110
b(Retrie)n(ving)25 b(gaps)f(and)g(mask)o(ed)h(re)o(gions)g(from)e
(annotated)j(sequences)42 b(.)j(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)p Black 175 w(6)p Black 218 1575 a(2.2.4)110 b(Retrie)n(ving)25
b(gene)f(prediction)j(results)e(from)e(Golden)i(P)o(ath)e(\()p
FB(genscan)p FG(\))86 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 175 w(7)p Black 218 1688 a(2.2.5)110 b(Ev)n(aluating)25
b FB(genscan)20 b FG(results)25 b(from)e(Golden)i(P)o(ath)e(v)o(ersus)h
(annotation)69 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 175 w(8)p Black 9 1800 a(2.3)96 b(Sequence)25 b(analysis:)31
b FC(M.musculus)25 b FG(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)p Black 175 w(8)p Black -128 2004
a FD(3)92 b(Masking)23 b(sequences)3090 b(9)-128 2208
y(4)92 b(Pr)n(ocessing)27 b FA(T)t(B)t(L)t(A)t(S)t(T)t(X)f
FD(r)n(esults)2705 b(10)9 2321 y FG(4.1)96 b(Initialization)35
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(10)p
Black 9 2434 a(4.2)96 b(Unpacking)28 b Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)g
FG(results)d(obtained)h(by)d(P)o(ankaj)34 b(.)45 b(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)p Black 129 w(10)p Black 9 2547 a(4.3)96 b(Retrie)n(ving)27
b Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)i FG(results)c(by)e(chromosome)28
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(11)p
Black 218 2660 a(4.3.1)110 b(Projecting)25 b(HSPs)d(into)i(SRs)91
b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 129 w(12)p Black 218 2773 a(4.3.2)110 b(Ev)n(aluating)25
b(SRs)d(v)o(ersus)j(annotation)78 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)p Black 129 w(13)p Black -128 2976 a FD(5)92
b(Gene)23 b(Pr)n(ediction)3162 b(14)9 3089 y FG(5.1)96
b(Initialization)35 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 129 w(14)p Black 9 3202 a(5.2)96 b(Gene)23 b(Prediction:)32
b FB(geneid)69 b FG(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(14)p Black 218
3315 a(5.2.1)110 b(Running)25 b FB(geneid)20 b FG(\(without)25
b(homology\))87 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black
129 w(14)p Black 218 3428 a(5.2.2)110 b(Processing)25
b(output)h(for)d FB(geneid)d FG(\(without)25 b(homology\))32
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)p Black 129 w(15)p Black 218 3541 a(5.2.3)110
b(Ev)n(aluation)25 b(of)f FB(geneid)c FG(predictions)26
b(\(without)f(homology\))k(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(15)p Black 9
3654 a(5.3)96 b(Gene)23 b(Prediction:)34 b Fz(S)t(G)t(P)51
b FG(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)p Black 129 w(17)p Black 218 3767
a(5.3.1)110 b(Re-scoring)25 b(SRs)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black
129 w(17)p Black 218 3880 a(5.3.2)110 b(Preparing)25
b(auxiliarly)h(\002les)56 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)p Black 129 w(18)p Black 218 3993
a(5.3.3)110 b(Running)27 b Fz(S)t(G)t(P)f FG(\()p FB(geneid)21
b FG(with)i(homology\))34 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 129 w(18)p Black 218 4106 a(5.3.4)110 b(Processing)25
b(output)h(for)f Fz(S)t(G)t(P)i FG(\(with)c(homology\))56
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(19)p Black 218
4218 a(5.3.5)110 b(Ev)n(aluation)25 b(of)h Fz(S)t(G)t(P)g
FG(predictions)h(\(with)d(homology\))52 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 129 w(20)p Black 218 4331 a(5.3.6)110 b(Running)27
b Fz(S)t(G)t(P)f FG(with)e(homology)h(and)f(e)n(vidences)48
b(.)d(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(20)p Black -128
4535 a FD(6)92 b(Masking)23 b(gene-pr)n(edictions)i(along)f(mask)o(ed)f
(sequences)1827 b(21)9 4648 y FG(6.1)96 b(Masking)25
b(cds)f(on)f(P)o(ankaj)h(mask)o(ed)h(sequence)h(fragments)43
b(.)i(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(21)p Black 9 4761
a(6.2)96 b(Processing)26 b(P)o(ankaj)f Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)k
FG(results)80 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
p Black 129 w(23)p Black 9 4874 a(6.3)96 b(Retrie)n(ving)27
b Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)i FG(results)c(by)e(chromosome)28
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(24)p
Black 218 4987 a(6.3.1)110 b(Mer)n(ging)25 b(HSPs)d(from)h(\002rst)i
Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)k FG(run)24 b(and)g(the)g(ne)n(w)e(ones)41
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 129 w(24)p Black 218 5100 a(6.3.2)110 b(Projecting)25
b(HSPs)d(into)i(SRs)91 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)p Black 129 w(24)p Black 9 5213 a(6.4)96
b(Gene)23 b(Prediction:)34 b Fz(S)t(G)t(P)51 b FG(.)45
b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)p Black 129 w(25)p Black 218 5326 a(6.4.1)110
b(Re-scoring)25 b(SRs)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(25)p
Black 218 5438 a(6.4.2)110 b(Preparing)25 b(auxiliarly)h(\002les)56
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 129 w(25)p Black 218 5551 a(6.4.3)110 b(Running)27
b Fz(S)t(G)t(P)f FG(\()p FB(geneid)21 b FG(with)i(homology\))34
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(26)p Black
218 5664 a(6.4.4)110 b(Processing)25 b(output)h(for)f
Fz(S)t(G)t(P)i FG(\(with)c(homology\))56 b(.)45 b(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 129 w(26)p Black 218 5777 a(6.4.5)110 b(Ev)n(aluation)25
b(of)h Fz(S)t(G)t(P)g FG(predictions)h(\(with)d(homology\))52
b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)p Black 129 w(27)p Black Black -128 6076
V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 2 4
2 3 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(CONTENTS)2749 b(ii)p -128 -243 4016 9 v Black -128
35 a FD(7)92 b(V)m(isualizing)24 b(r)n(esults)3080 b(28)9
148 y FG(7.1)96 b(V)-5 b(isualizing)25 b(annotations)i(with)d
Fx(Apollo)68 b FG(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)p Black 129 w(28)p Black 218 261 a(7.1.1)110 b(Preparing)25
b(GFF)c(\002les)j(for)f Fx(Apollo)40 b FG(.)45 b(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(28)p Black -128
464 a FD(A)71 b(A)-5 b(uxiliarly)25 b(P)n(erl)e(Scripts)2922
b(31)9 577 y FG(A.1)75 b(Annotation)26 b(phase)63 b(.)45
b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)p Black 129 w(31)p Black 218 690
a(A.1.1)89 b(Scripts:)30 b(retrie)n(ving)c(sequence)g(names)e(and)g
(nucleotide)i(composition)94 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)p Black 129 w(31)p Black 218 803 a(A.1.2)89
b(Scripts:)30 b(Processing)25 b(Golden)g(P)o(ath)e(annotation)60
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(34)p Black 9 916
a(A.2)75 b(Homology)25 b(search)f(phase)33 b(.)46 b(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 129 w(36)p Black 218 1029 a(A.2.1)89 b(Scripts:)30
b(V)-10 b(erifying)25 b(SBP)e Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)29
b FG(output)c(for)f(chromosome)h(fragments)47 b(.)f(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)p Black 129 w(36)p Black 218 1142 a(A.2.2)89
b(Scripts:)30 b(P)o(arsing)24 b(SBP)f Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)29
b FG(output)c(to)e(GFF)f(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129
w(37)p Black 9 1255 a(A.3)75 b(Gene-prediction)27 b(phase)86
b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)p Black 129 w(39)p Black 218 1368 a(A.3.1)89
b(Scripts:)30 b(Running)25 b(e)n(v)n(aluation)h(for)d(gene-prediction)
40 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)p Black 129 w(39)p Black 218 1481
a(A.3.2)89 b(Scripts:)30 b(Re-scoring)25 b(SRs)80 b(.)46
b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 129 w(40)p Black -128 1684 a FD(B)76 b(J)o(ob)23
b(Contr)n(ol)h(System)3024 b(41)9 1797 y FG(B.1)80 b(Interacting)26
b(with)e(MySQL)73 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(41)p Black
218 1910 a(B.1.1)94 b(Building)25 b(database)31 b(.)45
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)p Black 129 w(41)p Black 218 2023 a(B.1.2)94 b(Initialitation)27
b(\002les)59 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(43)p Black 218
2136 a(B.1.3)94 b(Perl)23 b(interf)o(ace)j(to)d(mySQL)f(database)72
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129
w(46)p Black 218 2249 a(B.1.4)94 b(Loading)25 b(administrati)n(v)o(e)h
(tables)84 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 129 w(52)p Black 9 2362 a(B.2)80 b(Step)23 b(processing)k
(script:)j FB(stepper.pl)49 b FG(.)c(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)p Black 129 w(57)p Black 218 2475 a(B.2.1)94
b(F)o(orking)24 b(child)h(processes)h(to)d(local/remote)j(machines)45
b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)p Black 129 w(59)p Black 218 2588 a(B.2.2)94
b(Sequence)25 b(and)f(jobs)g(related)h(v)n(ars)42 b(.)j(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(63)p Black
9 2701 a(B.3)80 b(Shared)24 b(code:)30 b FB(global.pm)46
b FG(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)p Black 129 w(63)p Black 218 2813 a(B.3.1)94 b(T)m(iming)23
b(processes)50 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(65)p Black 218
2926 a(B.3.2)94 b(T)m(rapping)25 b(system)f(signals)76
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 129 w(65)p Black 218 3039 a(B.3.3)94 b(Processing)25
b(messages)61 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)p Black 129 w(66)p Black 218 3152 a(B.3.4)94
b(Interacting)26 b(with)e(DB)e(standard)j(messages)79
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(69)p Black
218 3265 a(B.3.5)94 b(P)o(arsing)24 b(command-line)70
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 129 w(70)p Black 218 3378 a(B.3.6)94 b(V)-10 b(alidating)25
b(\002lenames)f(and)g(directories)62 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)p Black 129 w(71)p Black 218 3491 a(B.3.7)94
b(Checking)25 b(e)o(xit)f(status)h(for)e(system)i(calls)35
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(72)p
Black 218 3604 a(B.3.8)94 b(Ex)o(ecution)25 b(status)g(helper)g
(scripts:)30 b FB(exit.pl)20 b FG(and)77 b(.)46 b(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 129 w(74)p Black 218 3717 a(B.3.9)94 b(General)24
b(functions)37 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(75)p Black 9 3830
a(B.4)80 b(Implementing)26 b(scripts)f(with)e FB(Tk)90
b FG(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
p Black 129 w(76)p Black 9 3943 a(B.5)80 b(T)-6 b(ests)38
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 129 w(78)p Black -128 4146 a FD(C)71 b(Common)22
b(code)i(blocks)2960 b(83)9 4259 y FG(C.1)80 b(PERL)21
b(scripts)84 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black
129 w(83)p Black 218 4372 a(C.1.1)94 b(T)m(iming)23 b(our)h(scripts)84
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)p Black 129 w(83)p Black 218 4485 a(C.1.2)94 b(Printing)25
b(comple)o(x)f(Data)f(Structures)85 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)p Black 129 w(84)p Black 218 4598 a(C.1.3)94
b(Common)23 b(functions)54 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(84)p Black
218 4711 a(C.1.4)94 b(Common)23 b(functions)j(for)e(reporting)i
(program)f(processes)h(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(84)p Black
9 4824 a(C.2)80 b(A)-8 b(WK)22 b(scripts)28 b(.)46 b(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)p Black 129 w(85)p Black 9 4937 a(C.3)80
b(B)m(ASH)21 b(scripts)67 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 129 w(85)p Black 9 5050 a(C.4)80 b(V)-10 b(ersion)24
b(control)i(tags)42 b(.)j(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(85)p
Black -128 5253 a FD(D)71 b(Extracting)25 b(code)e(blocks)g(fr)n(om)h
(this)f(document)2121 b(86)9 5366 y FG(D.1)75 b(Extracts)25
b(Script)e(code)i(chunks)g(from)f(the)h Fz(N)t(O)r(W)t(E)t(B)h
FG(\002le)65 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129
w(86)p Black 9 5479 a(D.2)75 b(Extracting)25 b(dif)n(ferent)h(Con\002g)
d(Files)64 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)p Black 129 w(86)p Black 9 5592 a(D.3)75 b(Extracting)25
b(documentation)i(and)d(L)1359 5578 y Fw(A)1394 5592
y FG(T)1435 5613 y(E)1478 5592 y(X'ing)g(it)41 b(.)k(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)p Black 129 w(86)p Black 9 5705 a(D.4)75
b(De\002ning)24 b(w)o(orking)h(shell)f(v)n(ariables)i(for)d(the)h
(current)h(project)62 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(87)p
Black 9 5818 a(D.5)75 b(Extracting)25 b(code)g(blocks)g(for)f(all)f
(the)h(scripts)51 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)p
Black 129 w(91)p Black Black -128 6076 V -128 6180 a
FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 3 5
3 4 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(LIST)22 b(OF)g(T)-8 b(ABLES)2509 b(iii)p -128 -243
4016 9 v Black -128 35 a FM(List)30 b(of)f(T)-11 b(ables)9
242 y FG(1)164 b(Exit)23 b(codes)i(de\002nition)86 b(.)45
b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)p Black 129 w(73)p Black -128 534 a FM(List)30
b(of)f(Figur)n(es)9 741 y FG(1)164 b(Mapping)25 b(frames)f(of)f(HSPs)f
(from)k Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)i FG(results)j(.)45
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)p Black 129 w(11)p Black Black
Black 560 5818 a Fv(<)20 b Fu(Id:)50 b(humus.nw,v)e(1.4)h(2002/02/15)f
(17:29:05)g(jabril)h(Exp)g Fv(>)p Black -128 6076 V -128
6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 1 6
1 5 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(1.)23 b(Introduction)2696 b(1)p -128 -243 4016 9
v Black -128 35 a FM(1)120 b(Intr)n(oduction)-128 245
y FL(1.1)100 b(Pr)n(oject)25 b(pr)n(otocol)-128 419 y
FD(Issues:)p Black 9 607 a Ft(\017)p Black 46 w FG(Whole)f(genome,)g
(chromosome)h(and)f(process)i(\(all)e(sequences)i(or)d(single)i
(sequence\))i(runs.)p Black 9 795 a Ft(\017)p Black 46
w FG(Results)d(v)n(alidation.)p Black 9 982 a Ft(\017)p
Black 46 w FG(Unassembled)h(sequences)i(IDs)c(\(those)h
(\223random\224\).)31 b(Loop)24 b(through)h(each)g(sequence)g(in)f
(chromosomes.)p Black 9 1170 a Ft(\017)p Black 46 w FG(Mo)o(v)o(e)f
(all)g(v)o(eri\002ed)i(softw)o(are)f(to)g(a)f(global)i(path,)f(lik)o(e)
g FB(/usr/local/molb)o(io)o(/s)o(har)o(e)p FG(,)100 1283
y(instead)h(of)e FB(/projects/sgp/bi)o(n)p FG(.)p Black
9 1470 a Ft(\017)p Black 46 w FG(Mak)o(e)h(e)n(v)o(ery)g(protocol)h
(step)f(runnable)i(on)e(an)o(y)g(machine)g(\(so)g(wrapper)h(must)e
(handle)i(PBS)d(queues)j(too\).)p Black 9 1658 a Ft(\017)p
Black 46 w FG(Generate)g(global)g(report)f(by)g(chromosome.)p
Black 9 1846 a Ft(\017)p Black 46 w FG(...)-128 2095
y FL(1.2)100 b(Making)25 b(up)g(the)h(jobs)f(list)-128
2269 y FG(Here)k(we)f(are)h(going)h(to)e(de\002ne)i(which)f(will)f(be)h
(the)g(\002elds)g(structure)i(for)e(the)g(jobs)g(\002le.)44
b(That)28 b(\002le)g(will)h(contain)h(a)f(set)f(of)-128
2382 y(jobs)c(to)f(be)g(e)o(x)o(ecuted,)i(each)f(step)f(within)h(a)f
(job)g(must)g(ha)n(v)o(e)h(an)f(input/output)k(directories)f(pair)e
(from)f(where)g(to)g(read/write,)-128 2495 y(and)i(that)g(depends)h(on)
e(the)h(e)o(x)o(ecution)h(date)f(of)f(the)g(main)g(job)l(.)31
b(Jobs)25 b(must)g(also)f(be)h(sequence)h(oriented,)g(where)f
(sequences)-128 2608 y(are)g(grouped)i(within)e(chromosomes)h(\(which)g
(will)e(w)o(ork)g(the)h(same)g(w)o(ay)f(as)g(job/steps\),)j(b)n(ut)e
(this)g(will)g(be)f(handled)j(by)d(the)-128 2721 y(step-runner)j
(program)e(\(see)f FB(stepper.pl)18 b FG(de\002nition)25
b(on)f(corresponding)k(apendix)d(section\).)p Black -128
6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)
282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 2 7
2 6 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(1.3.)23 b Fx(Basic)h(squetch)h(of)f(job)g(and)g(step)g(records)
1722 b FG(2)p -128 -243 4016 9 v Black -347 -53 4590
4 v -347 60 4 113 v 1710 60 V 4239 60 V -347 2974 4 2915
v -261 139 a FD(JOBS)22 b(FILE)g(DEFINITION)p Black Black
-261 292 a Fs(...)-182 371 y(...)-261 450 y(JOB_j)-182
529 y(*)40 b(Job)f(ID)-182 608 y(*)h(Job)f(description)-182
687 y(*)h(Job)f(main)h(path)-182 765 y(*)g(Job)f(execution)g(JOBXID)g
(\(to)g(set)h(subpath\))-182 844 y(*)g(STEP)f(list:)-102
923 y(...)-22 1002 y(...)-102 1081 y(STEP_s)-22 1160
y(+)g(Step)h(ID)-22 1239 y(+)f(Step)h(description)-22
1318 y(+)f(Step)h(main)f(path)-22 1396 y(+)g(Step)h(execution)e(SXID)h
(\(to)h(set)f(subpath\))g(?)-22 1475 y(+)g(Input)h(dir:)79
b(IDIR)-22 1554 y(+)39 b(Output)g(dir:)h(ODIR)-22 1633
y(+)f(Error)h(dir:)79 b(EDIR)39 b(\(also)g(logs\))-22
1712 y(+)g(Step)h(shell)f(commands:)57 1791 y(#>#)h(STEP_CODE)e
(----...)57 1870 y(...)i(commands)e(...)57 1949 y(#>#)i(END_OF_STEP)e
(--...)-102 2027 y(end-of-STEP_s)-102 2106 y(...)-22
2185 y(...)-261 2264 y(end-of-JOB_j)-261 2343 y(...)-182
2422 y(...)p 1710 2974 V 1795 139 a FD(LOOPING)21 b(JOBS)i(THR)m(OUGH)d
(D)m(A)-9 b(T)h(A)p Black Black 1795 292 a Fs(...)1875
371 y(...)1795 450 y(CHR_c)1875 529 y(*)40 b(Set)f(chromosome)g
(directory)1875 608 y(*)h(Get)f(sequences)g(associated)f(to)i
(chromosome)e("c")1875 687 y(*)i(SEQ)f(list:)1955 765
y(...)2034 844 y(...)1955 923 y(SEQ_q)2034 1002 y(+)h(Output)f(file)g
(is)h(set)f(to)h(sequence)f("q")g(name)2034 1081 y(+)h(For)g(each)f
(selected)f(step:)2114 1160 y(-)i(Combine)f(into)g($$)g(script)g
(\(saving)g(into)g(a)h(tmp)g(dir\))2234 1239 y(>)f(common)g(bash)h
(exports)e(from)i('.project_VARS':)2313 1318 y(HUMUS,)f(BIN,)h(SRC,)
2313 1396 y(LIBPERL,)f(LIBSTEP,)g(MySQLPAR,)f(...)2234
1475 y(>)h(current)g(sequence)g(definitions:)2313 1554
y(CHR,)h(SEQ,)f(JOB,)g(STEP,)g(XID,)2313 1633 y(CHRDIR)g
(\($HUMUS/$CHR\),)2313 1712 y(JOBDIR)g(\($CHRDIR/$JOB/$XID\),)2313
1791 y(IDIR,)h(ODIR,)f(EDIR,)g(...)2234 1870 y(>)g(build)h
(directories:)2313 1949 y(CheckDirs)f(ODIR;)2313 2027
y([EDIR)h(!=)f(ODIR])g(&&)h(CheckDirs)e(EDIR)2234 2106
y(>)h(current)g(step)g(\(use)h(STEP_ID)f(?\))2114 2185
y(-)h(Report)f(start)g(status)g(to)g(DB)h(execution)e(table)2114
2264 y(-)i(Launch)f($$)g(script)g(to)h(local/remote)e(machine)2114
2343 y(-)i(Report)f(termination)f(status)h(to)h(DB)f(execution)g(table)
2034 2422 y(+)h(...)1955 2501 y(end-of-SEQ_q)1955 2580
y(...)2034 2658 y(...)1795 2737 y(end-of-CHR_c)1795 2816
y(...)1875 2895 y(...)p 4239 2974 V -347 2977 4590 4
v -347 3347 4 370 v 1467 3106 a FD(P)-7 b(A)e(TH)22 b(CONSTR)m(UCT)n
(OR)394 3233 y FB(/projects/H.sa)o(pi)o(en)o(s/)o Fr(CHR)o(_c)o
FB(/)p Fr(J)o(OB)o(_j)o FB(/)p Fr(JO)o(BX)o(ID)o FB(/)p
Fr(S)o(TE)o(P_s)o FB(/)p Fr(S)o(EQ)o(_q)o FB(.f)o(ile)o(s)p
4239 3347 V -347 3350 4590 4 v -128 3560 a FL(1.3)100
b(Basic)24 b(squetch)j(of)e(job)g(and)h(step)f(r)n(ecords)p
Black Black -378 3721 a Fq(2a)180 b Fp(h)p FI(Empty)21
b(JOB)f(De\002nition)f(Recor)m(d)g Fq(2a)p Fp(i)q Ft(\021)603
3821 y Fu(#.........................\(max)44 b(ID)50
b(length:)e(25chars\))-45 3921 y
(####>#########>#######################)o(<####)o(#####)o(######)o
(#####)o(######)o(#####)o(#####)o(####<#)-45 4020 y(#>#)i(JOB_ID)198
b(...)-45 4120 y(#>#)50 b(JOB_DESC)98 b(...)-45 4219
y(#>#)398 b(:)100 b(...)-45 4319 y(#>#)398 b(:)100 b(...)-45
4419 y(#>#)50 b(JOB_PATH)98 b(...)-45 4518 y(#>#)50 b(JOB_XID)148
b(...)-45 4618 y(#>#)50 b(JOB_FILE)98 b($LIBSTEP/...)-45
4718 y(#>#)50 b(END_OF_JOB)e(#################################)o
(######)o(#####)o(######)o(#####)o(#####)o(######)p Black
Black -382 4917 a Fq(2b)180 b Fp(h)p FI(Empty)21 b(STEP)e(De\002nition)
g(Recor)m(d)h Fq(2b)p Fp(i)q Ft(\021)603 5016 y Fu
(#.........................\(max)44 b(ID)50 b(length:)e(25chars\))-45
5116 y(####>#########>#######################)o(<####)o(#####)o(######)
o(#####)o(######)o(#####)o(#####)o(####<#)-45 5216 y(#>#)i(STEP_ID)148
b(...)-45 5315 y(#>#)50 b(STEP_DESC)e(...)-45 5415 y(#>#)448
b(:)50 b(...)-45 5515 y(#>#)448 b(:)50 b(...)-45 5614
y(#>#)g(STEP_PATH)e(...)-45 5714 y(#>#)i(STEP_XID)98
b($<JOB_ID>)-45 5813 y(#>#)50 b(STEP_IDIR)e(...)-45 5913
y(#>#)i(STEP_ODIR)e(...)p Black -128 6076 4016 9 v -128
6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 3 8
3 7 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(1.4.)23 b Fx(Main)h(job)g(collector)2404 b FG(3)p
-128 -243 4016 9 v Black -45 35 a Fu(#>#)50 b(STEP_EDIR)e(...)-45
134 y(#>#)i(STEP_CODE)147 b(--------------------------------------)o
(---#<)o(#)-45 234 y(...)-45 334 y(#<#)50 b(Remove)e(this)h(line)h
(from)f(code)g(when)g(tangling)-45 433 y(#<#)149 b(\(commands)48
b(used)i(when)f(testing)f(script\)...)-45 533 y(...)-45
632 y(#>#)i(END_OF_STEP)d(--------------------------------------)o
(---#<)o(#)p Black Black -378 832 a Fq(3a)180 b Fp(h)p
FI(Empty)21 b(STEP)e(De\002nition)g(FILE)h Fq(3a)p Fp(i)q
Ft(\021)-45 931 y Fp(h)p FI(Empty)h(STEP)f(De\002nition)e(Recor)m(d)i
Fq(2b)p Fp(i)-45 1031 y(h)p FI(Empty)h(STEP)f(De\002nition)e(Recor)m(d)
i Fq(2b)p Fp(i)-45 1131 y Fu(...)-45 1230 y Fp(h)p FI(Empty)h(STEP)f
(De\002nition)e(Recor)m(d)i Fq(2b)p Fp(i)-128 1529 y
FL(1.4)100 b(Main)24 b(job)i(collector)p Black Black
-382 1690 a Fq(3b)180 b Fp(h)p FI(JOB)21 b(COLLECT)o(OR)g
Fq(3b)p Fp(i)q Ft(\021)-45 1790 y Fu
(####>#########>#######################)o(#####)o(#####)o(######)o
(#####)o(######)o(#####)o(#####)o(####<#)-45 1889 y(###)-45
1989 y(###)50 b(Collecting)e(step)h(records)f(for)h(each)h(pipeline)e
(job)-45 2089 y(###)-45 2188 y(####>#########>#######################)o
(#####)o(#####)o(######)o(#####)o(######)o(#####)o(#####)o(####<#)-45
2288 y({)i(cat)f($WORK/.bash_VARS)e(;)55 2388 y(notangle)h
(-R'tangling:)g(mySQL)h(param')g($WORK/$nwfile.nw)d(;)k(})g(|)f(bash)g
(;)-45 2487 y(#)-45 2587 y(notangle)g(-R'JOBS:)f(Sequence)g(Analysis')
945 b($WORK/$nwfile.nw)47 b(|)j(\\)155 2686 y(egrep)f(-v)g('^#<#')g(-)g
(|)h(cpif)f($LIBSTEP/annotation.job)d(;)-45 2786 y(notangle)j(-R'JOBS:)
f(HsapGPa)h(x)g(MmusPHa)g(WUTBLASTX')446 b($WORK/$nwfile.nw)47
b(|)j(\\)155 2886 y(egrep)f(-v)g('^#<#')g(-)g(|)h(cpif)f
($LIBSTEP/tblastx.job)d(;)-45 2985 y(notangle)j(-R'JOBS:)f(Running)h
(GENEID)f(standard')646 b($WORK/$nwfile.nw)47 b(|)j(\\)155
3085 y(egrep)f(-v)g('^#<#')g(-)g(|)h(cpif)f($LIBSTEP/geneid.job)d(;)-45
3185 y(notangle)j(-R'JOBS:)f(SGP)h(with)g(HSAPgpa)g(x)h(MMUSpha)e
(homology')g($WORK/$nwfile.nw)f(|)j(\\)155 3284 y(egrep)f(-v)g('^#<#')g
(-)g(|)h(cpif)f($LIBSTEP/sgp.job)e(;)-45 3384 y(notangle)i(-R'JOBS:)f
(Visualizing)g(Results)g(with)h(Apollo')248 b($WORK/$nwfile.nw)47
b(|)j(\\)155 3484 y(egrep)f(-v)g('^#<#')g(-)g(|)h(cpif)f
($LIBSTEP/apollo.job)d(;)-45 3583 y(#)-45 3683 y
($MySQLPAR/admin_db_Hsapiens.pl)f(;)-45 3782 y(#)p Black
-128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g
(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 4 9
4 8 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(2.)23 b(Sequence)i(Analysis)2454 b(4)p -128 -243
4016 9 v Black -128 35 a FM(2)120 b(Sequence)32 b(Analysis)p
Black Black -27 224 a FD(What)23 b(to)g(do)g(her)n(e:)p
Black 110 412 a Ft(\017)p Black 45 w FG(Get)g(annotations)k(for)d(each)
g(sequence)i(from)d(Golden)i(P)o(ath)e(annotation.)p
Black 110 599 a Ft(\017)p Black 45 w FG(Get)g(fragment)i(lengths,)g
(fragment)g(number)-5 b(.)p Black 110 787 a Ft(\017)p
Black 45 w FG(Get)23 b(coords)i(of)f(N-mask)o(ed)g(re)o(gions)h(from)f
(assembly)h(gaps.)p Black 110 975 a Ft(\017)p Black 45
w FG(Get)e(G+C)f(content.)p Black Black -378 1146 a Fq(4a)180
b Fp(h)p FI(JOBheader:)19 b(Sequence)f(Analysis)j Fq(4a)p
Fp(i)p Ft(\021)-45 1245 y Fu(####>#########>#######################)o
(<####)o(#####)o(######)o(#####)o(######)o(#####)o(#####)o(####<#)-45
1345 y(#>#)50 b(JOB_ID)198 b(HSAP_GP_ANNOTATION)-45 1445
y(#>#)50 b(JOB_DESC)98 b(Homo)49 b(sapiens)f(Golden)h(Path)g
(annotation.)-45 1544 y(#>#)398 b(:)100 b(Processing)48
b(files)h(downloaded)f(from)h(Golden-Path)e(server)-45
1644 y(#>#)398 b(:)100 b(\()49 b(URL:)h(http://genome.ucsc.edu/)45
b(\).)-45 1743 y(#>#)398 b(:)100 b(We)49 b(retrieve)g(fasta)f
(sequences,)g(gaps,)h(annotation)f(\(RefSeq)h(and)-45
1843 y(#>#)398 b(:)100 b(Ensembl\),)48 b(genscan)g(predicted)h(genes)f
(and)i(so)f(on.)-45 1943 y(#>#)398 b(:)100 b(Last)49
b(UCSC-GP)f(version)h(being)g(analyzed)f(is)i(August,)e(2001.)-45
2042 y(#>#)i(JOB_PATH)98 b(annotation)-45 2142 y(#>#)50
b(JOB_XID)148 b(20010806)-45 2242 y(#>#)50 b(JOB_FILE)98
b(${LIBSTEP}/annotation.job)-45 2341 y(#>#)50 b(END_OF_JOB)e
(#################################)o(######)o(#####)o(######)o(#####)o
(#####)o(######)p Black Black -382 2540 a Fq(4b)180 b
Fp(h)p FI(JOBS:)20 b(Sequence)e(Analysis)j Fq(4b)p Fp(i)q
Ft(\021)-45 2640 y Fp(h)p FI(STEPS\(Sequence)c(Analysis\):)j(ASSEMBL)n
(Y)f(GAPS)h Fq(6a)p Fp(i)-45 2740 y(h)p FI(STEPS\(Sequence)d
(Analysis\):)j(ORIGIN)n(AL)f(MASKING)i Fq(6b)p Fp(i)-45
2839 y(h)p FI(STEPS\(Sequence)c(Analysis\):)j(REFSEQ)f
Fq(5a)p Fp(i)-45 2939 y(h)p FI(STEPS\(Sequence)e(Analysis\):)j(ENSEMBL)
g Fq(5b)p Fp(i)-45 3039 y(h)p FI(STEPS\(Sequence)d(Analysis\):)j
(GENSCAN)g Fq(7)p Fp(i)-128 3338 y FL(2.1)100 b(Initialization)p
Black Black -378 3499 a Fq(4c)180 b Fp(h)p FI(Global:)41
b Fq(4c)p Fp(i)p Ft(\021)-45 3598 y Fu(#)-45 3698 y(#)-45
3797 y(#)50 b(HUMUS="$BASE/H.sapiens")c(->)j(.project_VARS)-45
3897 y(#)-45 3997 y(CheckDirs)g($HUMUS/.ftp)e
($HUMUS/.ftp/PankajAgarwal)-45 4096 y(#)p Black Black
-382 4296 a Fq(4d)180 b Fp(h)p FI(Global:)41 b Fq(4c)p
Fp(i)p Fo(+)p Ft(\021)-45 4395 y Fu(#)-45 4495 y(#)50
b(Retrieving)e(Golden)h(path)g(sequence)f(names)h(and)g(length)-45
4594 y(#)-45 4694 y(HSAP="/seq/genomes/H.sapiens/golden_pa)o(th_20)o
(01080)o(6")44 b(;)50 b(#)f(UCSC)-45 4794 y(HSAPID="20010806";)-45
4893 y(#)-45 4993 y(#)h(getfastadesc.pl)d(must)i(be)h(executed)e(after)
h(table)g(update)-45 5093 y(#)150 b(on)49 b(mySQL)g(database)f(\(after)
h(admin_db_Hsapiens.pl\))-45 5192 y(#)-45 5292 y($BIN/getfastadesc.pl)e
($MySQLPAR/chrs.tbl)f($HSAP/chromosomes)h(\\)1002 5391
y(>)i($HUMUS/seqid_list)e(2>)i($HUMUS/seqid_list.rpt)d(;)-45
5491 y(#)-128 5790 y FL(2.2)100 b(Sequence)27 b(analysis:)j
Fn(H.sapiens)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 5 10
5 9 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(2.2.)23 b Fx(Sequence)i(analysis:)32 b FC(H.sapiens)1996
b FG(5)p -128 -243 4016 9 v Black -128 35 a FD(2.2.1)92
b(Retrie)o(ving)25 b(annotations)f(fr)n(om)g(Golden)e(P)o(ath)p
Black Black -378 196 a Fq(5a)180 b Fp(h)p FI(STEPS\(Sequence)17
b(Analysis\):)j(REFSEQ)f Fq(5a)p Fp(i)q Ft(\021)-45 295
y Fu(####>#########>#######################)o(<####)o(#####)o(######)o
(#####)o(######)o(#####)o(#####)o(####<#)-45 395 y(#>#)50
b(STEP_ID)148 b(HSAP_GP_REFSEQ)-45 495 y(#>#)50 b(STEP_DESC)e
(Retrieving)g(RefSeq)g(annotated)h(genes)f(for)i(current)-45
594 y(#>#)448 b(:)50 b(H.)f(sapiens)g(Golden)f(Path)i(sequence.)-45
694 y(#>#)g(STEP_PATH)e(refseq)-45 793 y(#>#)i(STEP_XID)98
b($<JOB{.}{JOB_XID}>)-45 893 y(#>#)50 b(STEP_IDIR)e($HSAP/database)-45
993 y(#>#)i(STEP_ODIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
1092 y(#>#)i(STEP_EDIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
1192 y(#>#)i(STEP_CODE)147 b(--------------------------------------)o
(---#<)o(#)-45 1292 y(#)-45 1391 y(#<#)50 b(IDIR="$HSAP/database")c(;)
-45 1491 y(#<#)k(ODIR="$HUMUS/$CHR/annotation/$HSAP)o(ID/re)o(fseq")43
b(;)-45 1590 y(#<#)50 b(CheckDirs)e($ODIR)h($EDIR)g(;)-45
1690 y($BIN/gp2gff.pl)f(-no-overlap)f(-exonori-nuclfix)g(1)j(-)f(\\)703
1790 y($CHR)g(refseq)f($IDIR/refGene.txt)f(\\)603 1889
y(>)j($ODIR/$CHR.fullgff)c(\\)553 1989 y(2>)k($EDIR.report)346
b(;)-45 2089 y(gawk)50 b('$3~/^\(Single|First|Internal|Term)o(inal\))o
($/)44 b({print)49 b($0}')g(\\)703 2188 y($ODIR/$CHR.fullgff)d(>)k
($ODIR/$CHR.gff)d(;)-45 2288 y(#)-45 2387 y(#>#)j(END_OF_STEP)d
(--------------------------------------)o(---#<)o(#)p
Black Black -382 2587 a Fq(5b)180 b Fp(h)p FI(STEPS\(Sequence)17
b(Analysis\):)j(ENSEMBL)g Fq(5b)p Fp(i)q Ft(\021)-45
2686 y Fu(####>#########>#######################)o(<####)o(#####)o
(######)o(#####)o(######)o(#####)o(#####)o(####<#)-45
2786 y(#>#)50 b(STEP_ID)148 b(HSAP_GP_ENSEMBL)-45 2886
y(#>#)50 b(STEP_DESC)e(Retrieving)g(Ensembl)g(annotated)g(genes)h(for)h
(current)-45 2985 y(#>#)448 b(:)50 b(H.)f(sapiens)g(Golden)f(Path)i
(sequence.)-45 3085 y(#>#)g(STEP_PATH)e(ensembl)-45 3185
y(#>#)i(STEP_XID)98 b($<JOB{.}{JOB_XID}>)-45 3284 y(#>#)50
b(STEP_IDIR)e($HSAP/database)-45 3384 y(#>#)i(STEP_ODIR)e
($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45 3483 y(#>#)i(STEP_EDIR)e
($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45 3583 y(#>#)i(STEP_CODE)147
b(--------------------------------------)o(---#<)o(#)-45
3683 y(#)-45 3782 y(#<#)50 b(IDIR="$HSAP/database")c(;)-45
3882 y(#<#)k(ODIR="$HUMUS/$CHR/annotation/$HSAP)o(ID")44
b(;)-45 3982 y(#<#)50 b(CheckDirs)e($ODIR)h($EDIR)g(;)-45
4081 y($BIN/gp2gff.pl)f(-no-overlap)f(-exonori-nuclfix)g(1)j(-)f(\\)703
4181 y($CHR)g(ensembl)f($IDIR/ensGene.txt)f(\\)603 4280
y(>)j($ODIR/$CHR.fullgff)c(\\)553 4380 y(2>)k($EDIR.report)346
b(;)-45 4480 y(#)-45 4579 y(gawk)50 b
('$3~/^\(Single|First|Internal|Term)o(inal\))o($/)44
b({print)49 b($0}')g(\\)703 4679 y($ODIR/$CHR.fullgff)d(>)k
($ODIR/$CHR.gff)d(;)-45 4779 y(#)-45 4878 y(#>#)j(END_OF_STEP)d
(--------------------------------------)o(---#<)o(#)p
Black Black -27 5108 a FD(Check)22 b(points:)p Black
110 5296 a Ft(\017)p Black 45 w FG(Annotations)k(for)g(R)t
Fz(E)t(F)t FG(S)t Fz(E)t(Q)i FG(and)c Fm(emsembl)19 b
FG(genes.)-128 5519 y FD(2.2.2)92 b(Pr)n(eparing)24 b(annotation)g
(\002les)f(f)n(or)h(e)o(v)o(aluation)p Black Black -378
5680 a Fq(5c)180 b Fp(h)p FI(Sequence:)39 b Fq(5c)p Fp(i)q
Ft(\021)-45 5780 y Fu(#)-45 5880 y(#)50 b(TO)g(BE)f
(redefined................)c(include)k(frame0-mapping)e(too)p
Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o
(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)
1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 6 11
6 10 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(2.2.)23 b Fx(Sequence)i(analysis:)32 b FC(H.sapiens)1996
b FG(6)p -128 -243 4016 9 v Black -45 35 a Fu(function)49
b(pre_eval)f({)55 134 y(gawk)h('BEGIN{)454 234 y(src)g(=)g(ARGV[1];)g
(len)g(=)h(ARGV[2];)e(ARGV[1])g(=)i(ARGV[2])f(=)g("";)454
334 y(print)f("chr22\\t"src"\\tsequence\\t1\\t"len"\\t.\\t)o(.\\t.")304
433 y(}')i($n)f($lenaug)g(>)g($TDIR/${HSAPIDaug}_seqlength.gff)44
b(;)55 533 y(sort)49 b(+3n)g(-5)h($TDIR/${HSAPIDaug}_$n.gff)45
b(>)50 b($TDIR/${HSAPIDaug}.tmp)45 b(;)55 632 y(cat)k
($TDIR/${HSAPIDaug}_seqlength.gff)44 b(>)50 b
($TDIR/${HSAPIDaug}_${n}_fwd.gff)44 b(;)55 732 y(gawk)49
b('$7)g(==)h("+")f({print)g($0}')g($TDIR/${HSAPIDaug}.tmp)d(\\)1300
832 y(\273)k($TDIR/${HSAPIDaug}_${n}_fwd.gff)44 b(;)55
931 y(cat)49 b($TDIR/${HSAPIDaug}_seqlength.gff)44 b(>)50
b($TDIR/${HSAPIDaug}_${n}_rev.gff)44 b(;)55 1031 y(gawk)49
b('$7)g(==)h("-")f({print)g($0}')g($TDIR/${HSAPIDaug}.tmp)d(\\)1300
1131 y(\273)k($TDIR/${HSAPIDaug}_${n}_rev.gff)44 b(;)55
1230 y(/bin/rm)49 b(-v)g($TDIR/${HSAPIDaug}.tmp)d(;)-45
1330 y(})k(;)-45 1429 y(#)p Black Black -27 1652 a FD(Check)22
b(points:)p Black 110 1839 a Ft(\017)p Black 45 w FG(Ev)n(aluation)34
b(\002les)e(for)j(R)t Fz(E)t(F)t FG(S)t Fz(E)t(Q)h FG(and)d
Fm(emsembl)28 b FG(genes:)48 b(SR)31 b(projection)k(of)e(features)h
(when)e(mapping)i(all)200 1952 y(frames)24 b(to)g(0,)f(and)h(forw)o
(ard/re)n(v)o(erse)i(selection)g(of)e(non-o)o(v)o(erlapping)j(genes.)
-128 2176 y FD(2.2.3)92 b(Retrie)o(ving)25 b(gaps)e(and)f(mask)o(ed)h
(r)n(egions)i(fr)n(om)f(annotated)g(sequences)p Black
Black -378 2337 a Fq(6a)180 b Fp(h)p FI(STEPS\(Sequence)17
b(Analysis\):)j(ASSEMBL)n(Y)f(GAPS)h Fq(6a)p Fp(i)q Ft(\021)-45
2436 y Fu(####>#########>#######################)o(<####)o(#####)o
(######)o(#####)o(######)o(#####)o(#####)o(####<#)-45
2536 y(#>#)50 b(STEP_ID)148 b(HSAP_GP_ASSEMBLY_GAPS)-45
2636 y(#>#)50 b(STEP_DESC)e(Retrieving)g(assembly)g(gaps)h(coords)g
(for)g(current)-45 2735 y(#>#)448 b(:)50 b(H.)f(sapiens)g(Golden)f
(Path)i(sequence)e(\(masked)g(with)h(N's\).)-45 2835
y(#>#)h(STEP_PATH)e(gaps)-45 2934 y(#>#)i(STEP_XID)98
b($<JOB{.}{JOB_XID}>)-45 3034 y(#>#)50 b(STEP_IDIR)e($HSAP/database)-45
3134 y(#>#)i(STEP_ODIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
3233 y(#>#)i(STEP_EDIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
3333 y(#>#)i(STEP_CODE)147 b(--------------------------------------)o
(---#<)o(#)-45 3433 y(#)-45 3532 y(#<#)50 b(IDIR="$HSAP/database")c(;)
-45 3632 y(#<#)k(ODIR="$HUMUS/$CHR/annotation/$HSAP)o(ID/ga)o(ps")44
b(;)-45 3731 y(#<#)50 b(CheckDirs)e($ODIR)h(;)-45 3831
y(perl)h(-e)f(')55 3931 y(\($seq,$ori,$end,$char,$size,$type\))44
b(=)49 b(\(1,2,3,5,6,7\);)55 4030 y($n)h(=)f(1;)55 4130
y(while)g(\(<STDIN>\))f({)254 4230 y(next)h(if)h(/^#/o;)254
4329 y(next)f(if)h(/^\\s*$/o;)254 4429 y(chomp;)254 4529
y(@l)g(=)f(split)g(/\\s+/og,)g($_;)254 4628 y(defined\($l[$type]\))e
(||)i(\($l[$type])f(=)i("gap"\);)254 4728 y(print)f(STDOUT)g
(join\("\\t",)f($l[$seq],"sequence","gap",)1450 4827
y(@l[$ori,$end],".",".",".",)553 4927 y($l[$type].".".\($n++\).")e(#)k
($l[$type]\\:)d($l[$size]bp)h(\($l[$char]\)\\n"\);)55
5027 y(};)i(#)f(while)55 5126 y(')h(<)f($IDIR/${CHR}_gap.txt)d(\\)155
5226 y(>)j($ODIR/${CHR}.gff)e(;)-45 5326 y(#)-45 5425
y(#>#)j(END_OF_STEP)d(--------------------------------------)o(---#<)o
(#)p Black Black -382 5624 a Fq(6b)180 b Fp(h)p FI(STEPS\(Sequence)17
b(Analysis\):)j(ORIGIN)n(AL)f(MASKING)i Fq(6b)p Fp(i)q
Ft(\021)-45 5724 y Fu(####>#########>#######################)o(<####)o
(#####)o(######)o(#####)o(######)o(#####)o(#####)o(####<#)-45
5824 y(#>#)50 b(STEP_ID)148 b(HSAP_GP_ORI_MASKED)-45
5923 y(#>#)50 b(STEP_DESC)e(Retrieving)g(masked)g(regions)h(coords)g
(for)g(current)f(H.)i(sapiens)e(Golden)p Black -128 6076
V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 7 12
7 11 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(2.2.)23 b Fx(Sequence)i(analysis:)32 b FC(H.sapiens)1996
b FG(7)p -128 -243 4016 9 v Black -45 35 a Fu(#>#)448
b(:)50 b(Path)f(sequence)f(\(original)g(masking)h(of)g(repetitive)f
(regions\).)-45 134 y(#>#)i(STEP_PATH)e(repeats)-45 234
y(#>#)i(STEP_XID)98 b($<JOB{.}{JOB_XID}>)-45 334 y(#>#)50
b(STEP_IDIR)e($HSAP/database)-45 433 y(#>#)i(STEP_ODIR)e
($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45 533 y(#>#)i(STEP_EDIR)e
($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45 632 y(#>#)i(STEP_CODE)147
b(--------------------------------------)o(---#<)o(#)-45
732 y(#)-45 832 y(#<#)50 b(IDIR="$HSAP/database")c(;)-45
931 y(#<#)k(ODIR="$HUMUS/$CHR/annotation/$HSAP)o(ID/re)o(peats)o(")44
b(;)-45 1031 y(#<#)50 b(CheckDirs)e($ODIR)h(;)-45 1131
y(perl)h(-e)f(')55 1230 y(\($sco,$seq,$ori,$end,$str,$name,$cla)o
(ss,$f)o(am\))44 b(=)49 b(\(1,5,6,7,9,10,11,12\);)55
1330 y($n)h(=)f(1;)55 1429 y(while)g(\(<STDIN>\))f({)254
1529 y(next)h(if)h(/^#/o;)254 1629 y(next)f(if)h(/^\\s*$/o;)254
1728 y(chomp;)254 1828 y(@l)g(=)f(split)g(/\\s+/og,)g($_;)254
1928 y(print)g(STDOUT)g(join\("\\t",)f
($l[$seq],"repeatmasker","repeat",)1450 2027 y
(@l[$ori,$end,$sco,$str],".",)1450 2127 y($l[$class].".".\($n++\)\).")d
(#)50 b(@l[$name,$fam]\\n";)55 2227 y(};)g(#)f(while)55
2326 y(')h(<)f($IDIR/${CHR}_rmsk.txt)d(\\)155 2426 y(>)j
($ODIR/${CHR}.gff)e(;)-45 2525 y(#)-45 2625 y(#>#)j(END_OF_STEP)d
(--------------------------------------)o(---#<)o(#)-128
2921 y FD(2.2.4)92 b(Retrie)o(ving)25 b(gene)e(pr)n(ediction)h(r)n
(esults)h(fr)n(om)f(Golden)e(P)o(ath)h(\()p Fr(genscan)p
FD(\))p Black Black -345 3082 a Fq(7)180 b Fp(h)p FI(STEPS\(Sequence)17
b(Analysis\):)j(GENSCAN)g Fq(7)p Fp(i)q Ft(\021)-45 3181
y Fu(####>#########>#######################)o(<####)o(#####)o(######)o
(#####)o(######)o(#####)o(#####)o(####<#)-45 3281 y(#>#)50
b(STEP_ID)148 b(HSAP_GP_GENSCAN)-45 3381 y(#>#)50 b(STEP_DESC)e
(Retrieving)g(genscan)g(predicted)g(genes)h(for)h(current)-45
3480 y(#>#)448 b(:)50 b(H.)f(sapiens)g(Golden)f(Path)i(sequence.)-45
3580 y(#>#)g(STEP_PATH)e(genscan)-45 3679 y(#>#)i(STEP_XID)98
b($<JOB{.}{JOB_XID}>)-45 3779 y(#>#)50 b(STEP_IDIR)e($HSAP/database)-45
3879 y(#>#)i(STEP_ODIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
3978 y(#>#)i(STEP_EDIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
4078 y(#>#)i(STEP_CODE)147 b(--------------------------------------)o
(---#<)o(#)-45 4178 y(#)-45 4277 y(#<#)50 b(IDIR="$HSAP/database")c(;)
-45 4377 y(#<#)k(ODIR="$HUMUS/$CHR/annotation/$HSAP)o(ID/ge)o(nscan)o
(")44 b(;)-45 4476 y(#<#)50 b(CheckDirs)e($ODIR)h(;)-45
4576 y($BIN/gp2gff.pl)f(-no-overlap)f(-exonori-nuclfix)g(1)j(-)f(\\)703
4676 y($CHR)g(genscan)f($IDIR/genscan.txt)f(\\)603 4775
y(>)j($ODIR/$CHR.fullgff)c(\\)553 4875 y(2>)k($EDIR.report)346
b(;)-45 4975 y(gawk)50 b('$3~/^\(Single|First|Internal|Term)o(inal\))o
($/)44 b({print)49 b($0}')g(\\)703 5074 y($ODIR/$CHR.fullgff)d(>)k
($ODIR/$CHR.gff)d(;)-45 5174 y(#)-45 5273 y(#>#)j(END_OF_STEP)d
(--------------------------------------)o(---#<)o(#)p
Black Black -27 5504 a FD(Check)22 b(points:)p Black
110 5691 a Ft(\017)p Black 45 w FG(Annotations)k(for)e
FB(genscan)c FG(genes.)p Black -128 6076 V -128 6180
a FK(Genome)g(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 8 13
8 12 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(2.3.)23 b Fx(Sequence)i(analysis:)32 b FC(M.musculus)1920
b FG(8)p -128 -243 4016 9 v Black -128 35 a FD(2.2.5)92
b(Ev)o(aluating)24 b Fr(genscan)c FD(r)n(esults)25 b(fr)n(om)e(Golden)g
(P)o(ath)g(v)o(ersus)h(annotation)p Black Black -378
196 a Fq(8a)180 b Fp(h)p FI(Sequence:)19 b(H.sapiens)g
Fq(8a)p Fp(i)q Ft(\021)-45 295 y Fu(#)-45 395 y(#)50
b(Evaluation)e(of)h(genscan)g(results)-45 495 y(#)-45
594 y(SDIR="$HSAP/database")d(;)-45 694 y
(IDIR="$HUMUS/$CHR/annotation/$HSAPID/g)o(ensca)o(n")e(;)-45
793 y(ODIR="$HUMUS/$CHR/annotation/$HSAPID/g)o(ensca)o(n")g(;)-45
893 y(#)-45 993 y(#)50 b(run_evaluation)d(#chrom)i(program)f(param)h
(prog_results_dir)e(\\)-45 1092 y(#)797 b(annotation_dir)147
b(testset)h(lenght_file)-45 1192 y(run_evaluation)f($CHR)49
b("genscan")f($XID)i($IDIR)e($SDIR)h("refseq")g($LFILE;)-45
1292 y(#)p Black Black -27 1514 a FD(Check)22 b(points:)p
Black 110 1701 a Ft(\017)p Black 45 w FG(Ev)n(aluation)j(records)h(\(e)
o(xtended)g(and)e(brief\))g(for)g(each)g(seq)g(and)g(for)g(each)g
(chromosome.)p Black 110 1889 a Ft(\017)p Black 45 w
FG(...)-128 2100 y FL(2.3)100 b(Sequence)27 b(analysis:)j
Fn(M.musculus)p Black Black -382 2261 a Fq(8b)180 b Fp(h)p
FI(Sequence:)19 b(M.musculus)g Fq(8b)p Fp(i)q Ft(\021)-45
2360 y Fu(#)-45 2460 y(#)-45 2560 y(#)-45 2659 y
(MMUS="/seq/genomes/M.musculus/sanger_p)o(husio)o(n_200)o(11109")43
b(;)-45 2759 y(ODIR="")49 b(;)-45 2859 y(#)-45 2958 y(#)p
Black Black -27 3278 a FD(Check)22 b(points:)p Black
110 3466 a Ft(\017)p Black 45 w FG(...)p Black -128 6076
V -128 6180 a FK(Genome)e(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 9 14
9 13 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(3.)23 b(Masking)i(sequences)2435 b(9)p -128 -243
4016 9 v Black -128 35 a FM(3)120 b(Masking)30 b(sequences)p
Black Black -27 224 a FD(What)23 b(to)g(do)g(her)n(e:)p
Black 110 412 a Ft(\017)p Black 45 w FG(Human)g(genome)i(assembly)g
(from)f(UCSC)d(Golden)j(P)o(ath)f(August)h(release)i(\(20010806\).)p
Black 110 586 a Ft(\017)p Black 45 w FG(P)o(ankaj)e(run)i(R)t
Fz(E)t(P)t(E)t(A)l(T)t FG(M)t Fz(A)t(S)t(K)t(E)t(R)k
FG(with)24 b(the)g(follo)n(wing)h(parameters:)p Black
Black 200 775 a Fu(###)200 874 y(I)50 b(used)f(the)g(masked)g(sequence)
f(from)h(UCSC)g(and)g(masked)g(it)h(again.)e(I)i(used)f(-s)200
974 y("slow")g(option.)f(We)i(actually)e(used)h(RepeatBlaster)f(and)h
(not)g(Repeatmasker.)e(RB)200 1073 y(is)j(faster)e(version)h(of)g(RM)h
(that)f(uses)g(Blast)g(instead)f(of)i(crossmatch.)p Black
-128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g
(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 10 15
10 14 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(4.)23 b(Processing)28 b Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)g
FG(results)2062 b(10)p -128 -243 4016 9 v Black -128
35 a FM(4)120 b(Pr)n(ocessing)32 b Fl(T)6 b(B)g(L)g(A)g(S)g(T)g(X)32
b FM(r)n(esults)p Black Black -27 224 a FD(What)23 b(to)g(do)g(her)n
(e:)p Black 110 412 a Ft(\017)p Black 45 w FG(Process)k
Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)h FG(results)d(from)e(P)o(ankaj:)p
Black 309 599 a FD(\226)p Black 46 w FG(Human)g(genome)i(assembly)g
(from)f(UCSC)d(Golden)j(P)o(ath)f(August)h(release)i(\(20010806\).)p
Black 309 745 a FD(\226)p Black 46 w FG(Mouse)e(genome)h(assembly)g
(from)e(Sanger)i(Center)f(Phusion)g(assembly)h(\(20011106\).)p
Black Black 400 902 a FB(#)54 b(Database:)105 b(/bioinfo/gapdb/)o(bl)o
(ast)o(db)o(/M)o(us)o(Ph)o(usi)o(on)400 1015 y(#)54 b(Title:)107
b(MusPhusion)400 1128 y(#)54 b(#)g(of)g(letters)d(in)j(database:)105
b(2,374,690,634)e(\(Z)54 b(=)g(3000000000\))400 1241
y(#)g(#)g(of)g(sequences)c(in)k(database:)105 b(431,480)400
1354 y(#)54 b(Format:)106 b(XDF-1)400 1467 y(#)54 b(Created:)106
b(5:32:13)51 b(PM)j(EST)f(Dec)g(10,)g(2001)400 1580 y(#)h(Posted:)106
b(5:32:14)51 b(PM)j(EST)f(Dec)g(10,)h(2001)p Black 309
1747 a FD(\226)p Black 48 w Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)28
b FG(w)o(as)c(run)g(with)f(the)h(follo)n(wing)h(parameters:)p
Black Black 400 1904 a FB(W=5)108 b(Z=3000000000)400
2017 y(matrix=blosum62)o(mo)o(d)103 b(filter=xnu+seg)400
2130 y(nogaps)j(hspmax=500)f(topcomboN=100)400 2243 y(B=9000)h(V=9000)h
(E=0.01)f(E2=0.01)g(S2=80)400 2355 y(warnings)g(cpus=4)g
(ctxfactor=36.0)p Black 110 2543 a Ft(\017)p Black 45
w FG(Get)23 b(HSPs)f Ft(\))h FG(SRs)f Ft(\))g FG(HSP-SRs)p
Black Black -415 2709 a Fq(10a)180 b Fp(h)p FI(JOBheader:)19
b(HsapGP)-7 b(a)20 b(x)g(MmusPHa)g(WUTBLASTX)g Fq(10a)p
Fp(i)q Ft(\021)-45 2808 y Fu(####>#########>#######################)o
(<####)o(#####)o(######)o(#####)o(######)o(#####)o(#####)o(####<#)-45
2908 y(#>#)50 b(JOB_ID)198 b(HSAPgpa_MMUSpha_WUTBLASTX)-45
3008 y(#>#)50 b(JOB_DESC)98 b(Homology)48 b(search)h(by)g(WU-TBLASTX)f
(for)h(H.sapiens)g(UCSC)g(Golden)f(Path)-45 3107 y(#>#)398
b(:)100 b(assembly)48 b(against)h(M.musculus)f(Sanger)g(Center)h
(Phusion)g(assembly)-45 3207 y(#>#)398 b(:)100 b(\(TBLASTX)48
b(results)h(obtained)f(by)h(Pankaj)g(Agarwal,)-45 3307
y(#>#)398 b(:)150 b(last)49 b(update)f(was)i(jan)f(11,)g(2002,)g
(downladed)f(from)h(GSBP\).)-45 3406 y(#>#)h(JOB_PATH)98
b(tblastx)-45 3506 y(#>#)50 b(JOB_XID)148 b(20020111)-45
3605 y(#>#)50 b(JOB_FILE)98 b(${LIBSTEP}/tblastx.job)-45
3705 y(#>#)50 b(END_OF_JOB)e(#################################)o
(######)o(#####)o(######)o(#####)o(#####)o(######)p Black
Black -420 3901 a Fq(10b)181 b Fp(h)p FI(JOBS:)20 b(HsapGP)-7
b(a)20 b(x)g(MmusPHa)g(WUTBLASTX)g Fq(10b)p Fp(i)r Ft(\021)-45
4000 y Fp(h)p FI(STEPS\(HsGP)-7 b(a*MmPHa)18 b(WUTBLASTX\):)i(r)m
(etrie)o(ve)g(blast)h(output)d Fq(10c)p Fp(i)-45 4100
y(h)p FI(STEPS\(HsGP)-7 b(a*MmPHa)18 b(WUTBLASTX\):)i(par)o(sing)f
(blast)i(output)d Fq(11)p Fp(i)-45 4200 y(h)p FI(STEPS\(HsGP)-7
b(a*MmPHa)18 b(WUTBLASTX\):)i(pr)l(oject)g(HSPs)g(into)g(SRs)g
Fq(12)p Fp(i)-45 4299 y(h)p FI(STEPS\(HsGP)-7 b(a*MmPHa)18
b(WUTBLASTX\):)i(e)o(valuating)e(SRs)i Fq(13)p Fp(i)-128
4596 y FL(4.1)100 b(Initialization)-128 4773 y(4.2)g(Unpacking)28
b Fk(T)t(B)t(L)t(A)t(S)t(T)t(X)33 b FL(r)n(esults)25
b(obtained)h(by)f(P)o(ankaj)p Black Black -415 4934 a
Fq(10c)180 b Fp(h)p FI(STEPS\(HsGP)-7 b(a*MmPHa)18 b(WUTBLASTX\):)i(r)m
(etrie)o(ve)g(blast)h(output)d Fq(10c)p Fp(i)r Ft(\021)-45
5034 y Fu(####>#########>#######################)o(<####)o(#####)o
(######)o(#####)o(######)o(#####)o(#####)o(####<#)-45
5133 y(#>#)50 b(STEP_ID)148 b(TBLASTX_OUTPUT)-45 5233
y(#>#)50 b(STEP_DESC)e(Unpacking)g(TBLASTX)g(results)h(obtained)f(by)i
(Pankaj)e(Agarwal)-45 5333 y(#>#)448 b(:)50 b(\(Hsapiens)e(GP)h
(assembly)g(against)f(Mmusculus)g(Phusion)h(assembly\).)-45
5432 y(#>#)h(STEP_PATH)e(ori)-45 5532 y(#>#)i(STEP_XID)98
b($<JOB{.}{JOB_XID}>)-45 5632 y(#>#)50 b(STEP_IDIR)e
($HUMUS/.ftp/PankajAgarwal/$<JOB{.})o({JOB_X)o(ID}>.)o(tbxPhu)o(sion)
-45 5731 y(#>#)i(STEP_ODIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
5831 y(#>#)i(STEP_EDIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
5930 y(#>#)i(STEP_CODE)147 b(--------------------------------------)o
(---#<)o(#)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 11 16
11 15 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(4.3.)23 b Fx(Retrie)n(ving)34 b Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)29
b Fx(results)c(by)f(chromosome)1393 b FG(11)p -128 -243
4016 9 v Black Black Black Black -118 -53 3996 4 v -118
1596 4 1650 v 2 65 1238 4 v 2 469 4 405 v 148 332 473
13 v 857 332 237 13 v 142 338 13 24 v 1087 338 V 613
291 255 13 v 613 361 13 71 v 638 350 a Fj(f)n(eature)p
855 361 V 613 373 255 13 v 148 315 3 3 v 148 310 V 148
306 V 148 301 V 148 296 V 148 292 V 148 287 V 148 282
V 148 277 V 148 273 V 148 268 V 148 263 V 148 258 V 148
254 V 148 249 V 148 244 V 148 240 V 148 235 V 148 230
V 148 225 V 148 221 V 621 292 V 621 287 V 621 282 V 621
277 V 621 273 V 621 268 V 621 263 V 621 258 V 621 254
V 621 249 V 621 244 V 621 240 V 621 235 V 621 230 V 621
225 V 621 221 V 857 292 V 857 287 V 857 282 V 857 277
V 857 273 V 857 268 V 857 263 V 857 258 V 857 254 V 857
249 V 857 244 V 857 240 V 857 235 V 857 230 V 857 225
V 857 221 V 1093 315 V 1093 310 V 1093 306 V 1093 301
V 1093 296 V 1093 292 V 1093 287 V 1093 282 V 1093 277
V 1093 273 V 1093 268 V 1093 263 V 1093 258 V 1093 254
V 1093 249 V 1093 244 V 1093 240 V 1093 235 V 1093 230
V 1093 225 V 1093 221 V 182 385 a(sequence)52 195 y(FIRST)311
b(star)s(t)116 b(end)97 b(LAST)p 1236 469 4 405 v 2 472
1238 4 v 1355 124 a FK(F)n(orward)19 b(strand)p FJ(:)1429
233 y Fi(fr)o(ame)36 b Fh(=\()p Fi(star)s(t)18 b Fp(\000)g
Fi(FIRST)f Fh(+)h(1\))g Fv(mod)h Fh(3)1355 361 y FK(Re)o(v)o(erse)h
(strand)p FJ(:)1429 470 y Fi(fr)o(ame)36 b Fh(=\()p Fi(LAST)17
b Fp(\000)h Fi(end)f Fh(+)h(1\))h Fv(mod)f Fh(3)2707
53 y Fg(\014)2707 103 y(\014)2707 153 y(\014)2707 202
y(\014)2707 252 y(\014)2707 302 y(\014)2707 352 y(\014)2707
402 y(\014)2707 451 y(\014)2748 298 y FK(frame)2974 128
y Fg(8)2974 202 y(<)2974 352 y(:)3090 197 y Fh(0)g Fp(\))g
Fh(3)3090 297 y(1)g Fp(\))g Fh(1)3090 397 y(2)g Fp(\))g
Fh(2)3334 128 y Fg(9)3334 202 y(=)3334 352 y(;)3424 252
y FK(B)t Ff(L)t(A)t(S)t(T)3440 335 y FK(frame)p -69 611
3898 4 v 64 1075 a Fi(FIRST)f Fh(=)60 b(1)93 1174 y Fi(LAST)17
b Fh(=)h(40)538 731 y Fg(\014)538 781 y(\014)538 831
y(\014)538 880 y(\014)538 930 y(\014)538 980 y(\014)538
1030 y(\014)538 1080 y(\014)538 1129 y(\014)538 1179
y(\014)538 1229 y(\014)538 1279 y(\014)538 1329 y(\014)538
1378 y(\014)538 1428 y(\014)626 846 y FK(F)n(orward)659
929 y(Strand)1020 891 y Fi(star)s(t)23 b Fh(=)1279 721
y Fg(8)1279 796 y(<)1279 945 y(:)1394 791 y Fh(21)41
b Fp(\))h Fh(\(21)17 b Fp(\000)h Fh(1)g(+)g(1\))h Fv(mod)f
Fh(3)23 b(=)g(0)41 b Fp(\))g Fh(3)1394 891 y(22)g Fp(\))h
Fh(\(22)17 b Fp(\000)h Fh(1)g(+)g(1\))h Fv(mod)f Fh(3)23
b(=)g(1)41 b Fp(\))g Fh(1)1394 990 y(22)g Fp(\))h Fh(\(22)17
b Fp(\000)h Fh(1)g(+)g(1\))h Fv(mod)f Fh(3)23 b(=)g(2)41
b Fp(\))g Fh(2)642 1245 y FK(Re)o(v)o(erse)659 1328 y(Strand)1020
1291 y Fi(star)s(t)23 b Fh(=)1279 1071 y Fg(8)1279 1145
y(>)1279 1170 y(>)1279 1195 y(<)1279 1345 y(>)1279 1370
y(>)1279 1394 y(:)1394 1122 y Fh(21)41 b Fp(\))h Fi(re)n
(v_comp\(21,40\))19 b Fh(=)k(20)40 b Fp(\))i Fh(\(40)18
b Fp(\000)g Fh(20)f(+)h(1\))g Fv(mod)h Fh(3)k(=)f(0)41
b Fp(\))h Fh(3)1394 1221 y(22)f Fp(\))h Fi(re)n(v_comp\(22,40\))19
b Fh(=)k(19)40 b Fp(\))i Fh(\(40)18 b Fp(\000)g Fh(19)f(+)h(1\))g
Fv(mod)h Fh(3)k(=)f(1)41 b Fp(\))h Fh(1)1394 1321 y(22)f
Fp(\))h Fi(re)n(v_comp\(22,40\))19 b Fh(=)k(18)40 b Fp(\))i
Fh(\(40)18 b Fp(\000)g Fh(18)f(+)h(1\))g Fv(mod)h Fh(3)k(=)f(2)41
b Fp(\))h Fh(2)1394 1458 y Fv(w)r(her)r(e)56 b Fi(re)n(v_comp\(pos)o
(,LAST\))20 b Fh(=)j Fi(LAST)17 b Fp(\000)h Fi(pos)g
Fh(+)g(1)p 3875 1596 4 1650 v -118 1599 3996 4 v -128
1752 a FG(Figure)k(1:)28 b(Mapping)23 b(frames)f(of)f(HSPs)f(from)j
Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)j FG(results)d(from)e(chromosome)i
(fragments)g(when)f(we)e(mapped)j(their)-128 1865 y(coords)29
b(to)d(the)h(original)i(chromosomic)g(coords.)40 b(If)27
b(we)f(mak)o(e)g(a)h(re)n(v)o(erse)h(complement)g(of)f(the)g(sequence)i
(\(so)e(coords)h(are)-128 1978 y(sw)o(apped\))g(we)d(must)g(obtain)i
(the)f(same)g(frames)g(in)g(forw)o(ard)g(and)g(the)g(re)n(v)o(ersed)h
(\223forw)o(ard\224)h(strand)f(for)f(the)g(same)f(position)-128
2091 y(\(we)e(found)h(that)h(B)t Fz(L)t(A)t(S)t(T)i FG(programs)e
(compute)f(frame)f(for)g(re)n(v)o(erse)h(strand)h(counting)g(from)e
(sequence)i(last)e(position,)i(so)e(we)-128 2204 y(v)o(erify)i(the)f
(formulas)h(in)e(such)h(w)o(ay\).)p Black -45 2580 a
Fu(#)-45 2680 y(#<#)50 b(IDIR="$HUMUS/.ftp/PankajAgarwal/20)o(02011)o
(1.tbx)o(Phusio)o(n")44 b(;)-45 2780 y(#<#)50 b
(ODIR="$HUMUS/$CHR/tblastx/$XID/ori)o(")44 b(;)-45 2879
y(#<#)50 b(CheckDirs)e($ODIR)h(;)-45 2979 y(mega)h("cp)f(-v")g($IDIR)g
("^${CHR}_")f($ODIR)h(;)-45 3079 y(#)-45 3178 y
($BIN/sbp_checkblastout.pl)d($CHR)j($ODIR)g(>)g($ODIR/ori.report)e(;)
-45 3278 y(#)-45 3377 y(#>#)j(END_OF_STEP)d
(--------------------------------------)o(---#<)o(#)p
Black Black -27 3608 a FD(Check)22 b(points:)p Black
110 3795 a Ft(\017)p Black 45 w FG(get)i(number)g(of)g(sequences)i
(from)e(DB)e(matching)j(each)f(chromosome)h(fragment.)p
Black 110 3983 a Ft(\017)p Black 45 w FG(do)e(the)h(re)o(gions)g
(without)g(HSPs)e(correspond)k(to)d(N)f(re)o(gions)j(at)e(original)i
(sequences)h(\(being)e(gaps)g(or)f(mask)o(ed\))200 4096
y(?)29 b(\(maybe)24 b(using)h FB(evaluation)p FG(\))-128
4325 y FL(4.3)100 b(Retrie)o(ving)26 b Fk(T)t(B)t(L)t(A)t(S)t(T)5
b(X)33 b FL(r)n(esults)25 b(by)g(chr)n(omosome)-128 4500
y FG(W)-7 b(e)29 b(had)g(to)g(deal)h(with)f(the)g(frame)h(issue)g(of)f
(the)g(HSPs)f(fragments;)34 b(once)c(the)f(HSP)e(coords)k(were)e
(mapped)h(to)f(the)g(chro-)-128 4612 y(mosome,)e(frames)g(also)f(must)g
(be)g(recomputed)j(taking)e(into)g(account)h(if)d(HSP)f(w)o(as)i(in)g
(forw)o(ard)h(or)f(in)f(re)n(v)o(erse)i(strand)h(\(see)-128
4725 y(\002gure)c(1\).)p Black Black -382 4875 a Fq(11)180
b Fp(h)p FI(STEPS\(HsGP)-7 b(a*MmPHa)18 b(WUTBLASTX\):)i(par)o(sing)f
(blast)i(output)d Fq(11)p Fp(i)q Ft(\021)-45 4974 y Fu
(####>#########>#######################)o(<####)o(#####)o(######)o
(#####)o(######)o(#####)o(#####)o(####<#)-45 5074 y(#>#)50
b(STEP_ID)148 b(PARSING_TBLASTX)-45 5174 y(#>#)50 b(STEP_DESC)e
(Retrieving)g(HSPs)h(from)g(raw)g(TBLASTX)g(output)-45
5273 y(#>#)448 b(:)50 b(\(Hsapiens)e(GP)h(assembly)g(against)f
(Mmusculus)g(Phusion)h(assembly\).)-45 5373 y(#>#)h(STEP_PATH)e(hsp)-45
5473 y(#>#)i(STEP_XID)98 b($<JOB{.}{JOB_XID}>)-45 5572
y(#>#)50 b(STEP_IDIR)e($JOBDIR/$<STEP{.}{TBLASTX_OUTPUT}{)o(STEP_P)o
(ATH}>)-45 5672 y(#>#)i(STEP_ODIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)
-45 5771 y(#>#)i(STEP_EDIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
5871 y(#>#)i(STEP_CODE)147 b(--------------------------------------)o
(---#<)o(#)p Black -128 6076 4016 9 v -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 12 17
12 16 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(4.3.)23 b Fx(Retrie)n(ving)34 b Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)29
b Fx(results)c(by)f(chromosome)1393 b FG(12)p -128 -243
4016 9 v Black -45 35 a Fu(#)-45 134 y(#<#)50 b
(IDIR="$HUMUS/$CHR/tblastx/$XID/ori)o(")44 b(;)-45 234
y(#<#)50 b(ODIR="$HUMUS/$CHR/tblastx/$XID/hsp)o(")44
b(;)-45 334 y(#<#)50 b(CheckDirs)e($ODIR)h(;)-45 433
y(#<#)h(LEN="$HUMUS/$CHR/annotation/$HSAPI)o(D/len)o(gth")43
b(;)-45 533 y(LEN="$CHRDIR/$<JOB{HSAP_GP_ANNOTATION})o({JOB_)o(PATH})o
(>/$<JO)o(B{HSA)o(P_GP_A)o(NNOTA)o(TION})o({JOB_X)o(ID}>/)o(lengt)o(h")
h(;)-45 632 y(#)-45 732 y($BIN/sbp_blast2gff.pl)i($CHR)j($LEN)g($IDIR)g
(\\)404 832 y(>)g($ODIR/$CHR.fullgff)e(2>)i($ODIR.report)f(;)-45
931 y(#)-45 1031 y(perl)i(-ne)f('/^#/o)f(&&)i(next;)454
1131 y(/^\\s+$/o)e(&&)h(next;)454 1230 y($_)g(=~)g(s/;\\s+Strand//o;)
454 1330 y($_)g(=~)g(s/;\\s+Frame//o;)454 1429 y($_)g(=~)g
(s/;\\s+E_value.*$//o;)454 1529 y(print)f(STDOUT)h($_;')g
($ODIR/$CHR.fullgff)e(|)i(\\)454 1629 y(sort)g(+3n)g(-6)g(+6)h(-7)f(-)h
(>)f($ODIR/$CHR.gff)f(;)-45 1728 y(#)-45 1828 y(#>#)i(END_OF_STEP)d
(--------------------------------------)o(---#<)o(#)p
Black Black -27 2058 a FD(Check)22 b(points:)p Black
110 2246 a Ft(\017)p Black 45 w FG(\002nd)h(number)i(of)e(HSPs)f(per)i
(fragment)h(and)f(total)g(per)g(chromosome.)-128 2469
y FD(4.3.1)92 b(Pr)n(ojecting)25 b(HSPs)d(into)h(SRs)p
Black Black -382 2630 a Fq(12)180 b Fp(h)p FI(STEPS\(HsGP)-7
b(a*MmPHa)18 b(WUTBLASTX\):)i(pr)l(oject)g(HSPs)g(into)g(SRs)g
Fq(12)p Fp(i)q Ft(\021)-45 2730 y Fu
(####>#########>#######################)o(<####)o(#####)o(######)o
(#####)o(######)o(#####)o(#####)o(####<#)-45 2830 y(#>#)50
b(STEP_ID)148 b(PROJECTING_HSPs)-45 2929 y(#>#)50 b(STEP_DESC)e
(Projecting)g(HSPs)h(into)g(SRs)-45 3029 y(#>#)448 b(:)50
b(\(Hsapiens)e(GP)h(assembly)g(against)f(Mmusculus)g(Phusion)h
(assembly\).)-45 3128 y(#>#)h(STEP_PATH)e(sr)-45 3228
y(#>#)i(STEP_XID)98 b($<STEP{.}{PARSING_TBLASTX}{STEP_XI)o(D}>)-45
3328 y(#>#)50 b(STEP_IDIR)e($JOBDIR/$<STEP{.}{PARSING_TBLASTX})o
({STEP_)o(PATH})o(>)-45 3427 y(#>#)i(STEP_ODIR)e
($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45 3527 y(#>#)i(STEP_EDIR)e
($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45 3627 y(#>#)i(STEP_CODE)147
b(--------------------------------------)o(---#<)o(#)-45
3726 y(#)-45 3826 y(#<#)50 b(IDIR="$HUMUS/$CHR/tblastx/$XID/hsp)o(")44
b(;)-45 3925 y(#<#)50 b(ODIR="$HUMUS/$CHR/tblastx/$XID/sr")43
b(;)-45 4025 y(#<#)50 b(CheckDirs)e($ODIR)h(;)-45 4125
y($BIN/blast2gff)f(-g)h($IDIR/$CHR.gff)e(>)j($ODIR/$CHR.gff)d(;)-45
4224 y(#)-45 4324 y(gawk)j(')55 4424 y(BEGIN{)f(chr=ARGV[1];)e
(ARGV[1]="";)h(})55 4523 y($1)i(!~)f(/^#/)g({)h(a[$7.$8]++;)d(b[$7]++)i
(})55 4623 y(END{)155 4722 y(printf)f("#)i(TOTAL)f(\045s)g(SRs)g(on)h
(\045s:)f(\045s)h(forward,)e(\045s)h(reverse.\\n",)503
4822 y(b["+"]+b["-"],)f(chr,)h(b["+"],)f(b["-"];)155
4922 y(for)h(\(i)g(in)h(a\))f({)254 5021 y(printf)g("#)99
b(\\t\045s)49 b(:)h(\045s\\n",)f(i,)g(a[i];)155 5121
y(};)55 5221 y(})-45 5320 y(')h($CHR)f($ODIR/$CHR.gff)e(>)j
($ODIR.report)e(;)-45 5420 y(#)-45 5519 y(#>#)i(END_OF_STEP)d
(--------------------------------------)o(---#<)o(#)p
Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o
(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)
1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 13 18
13 17 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(4.3.)23 b Fx(Retrie)n(ving)34 b Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)29
b Fx(results)c(by)f(chromosome)1393 b FG(13)p -128 -243
4016 9 v Black Black Black -27 6 a FD(Check)22 b(points:)p
Black 110 194 a Ft(\017)p Black 45 w FG(Get)h(SRs)f(number)j(for)f
(each)g(sequence.)p Black 110 381 a Ft(\017)p Black 45
w FG(...)-128 586 y FD(4.3.2)92 b(Ev)o(aluating)24 b(SRs)f(v)o(ersus)h
(annotation)p Black Black -382 747 a Fq(13)180 b Fp(h)p
FI(STEPS\(HsGP)-7 b(a*MmPHa)18 b(WUTBLASTX\):)i(e)o(valuating)e(SRs)i
Fq(13)p Fp(i)q Ft(\021)-45 847 y Fu
(####>#########>#######################)o(<####)o(#####)o(######)o
(#####)o(######)o(#####)o(#####)o(####<#)-45 946 y(#>#)50
b(STEP_ID)148 b(EVALUATING_SRs)-45 1046 y(#>#)50 b(STEP_DESC)e
(Evaluating)g(SRs)h(versus)g(different)f(annotations)-45
1146 y(#>#)448 b(:)50 b(\(Hsapiens)e(GP)h(assembly)g(against)f
(Mmusculus)g(Phusion)h(assembly\).)-45 1245 y(#>#)h(STEP_PATH)e(eval)
-45 1345 y(#>#)i(STEP_XID)98 b($<STEP{.}{PARSING_TBLASTX}{STEP_XI)o
(D}>)-45 1444 y(#>#)50 b(STEP_IDIR)e
($JOBDIR/$<STEP{.}{PROJECTING_HSPs})o({STEP_)o(PATH})o(>)-45
1544 y(#>#)i(STEP_ODIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
1644 y(#>#)i(STEP_EDIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
1743 y(#>#)i(STEP_CODE)147 b(--------------------------------------)o
(---#<)o(#)-45 1843 y(#)-45 1943 y(#<#)50 b
(IDIR="$HUMUS/$CHR/tblastx/$XID/sr")43 b(;)-45 2042 y(#<#)50
b(ODIR="$HUMUS/$CHR/tblastx/$XID/eva)o(l")44 b(;)-45
2142 y(#)-45 2241 y(#>#)50 b(END_OF_STEP)d
(--------------------------------------)o(---#<)o(#)p
Black Black -27 2472 a FD(Check)22 b(points:)p Black
110 2659 a Ft(\017)p Black 45 w FG(Ev)n(aluation)j(records)h(\(e)o
(xtended)g(and)e(brief\))g(for)g(each)g(seq)g(and)g(for)g(each)g
(chromosome.)p Black 110 2847 a Ft(\017)p Black 45 w
FG(...)p Black -128 6076 V -128 6180 a FK(Genome)c(Inf)n(ormatics)g
(Resear)o(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h
(Guig\363,)e(R)1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black
eop
%%Page: 14 19
14 18 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(5.)23 b(Gene)h(Prediction)2509 b(14)p -128 -243
4016 9 v Black -128 35 a FM(5)120 b(Gene)30 b(Pr)n(ediction)-128
245 y FL(5.1)100 b(Initialization)-128 423 y(5.2)g(Gene)25
b(Pr)n(ediction:)32 b Fe(geneid)p Black Black -27 568
a FD(What)23 b(to)g(do)g(her)n(e:)p Black 110 756 a Ft(\017)p
Black 45 w FG(Run)g FB(geneid)d FG(without)25 b(homology)-6
b(,)25 b(then)f(e)n(v)n(aluate)i(results.)p Black 110
944 a Ft(\017)p Black 45 w FG(Remember)e(to)f(run)h FB(/projects/sgp/s)
o(rc)o(/g)o(ene)o(id)o(_v)o(1.)o(1)p Black 110 1131 a
Ft(\017)p Black 45 w FG(...)p Black Black -415 1298 a
Fq(14a)180 b Fp(h)p FI(JOBheader:)19 b(Running)f(GENEID)i(standar)m(d)f
Fq(14a)p Fp(i)r Ft(\021)-45 1397 y Fu
(####>#########>#######################)o(<####)o(#####)o(######)o
(#####)o(######)o(#####)o(#####)o(####<#)-45 1497 y(#>#)50
b(JOB_ID)198 b(GENEID_STD)-45 1597 y(#>#)50 b(JOB_DESC)98
b(Running)48 b("geneid")h(on)g(unmasked)f(H.sapiens)h(UCSC)g(Golden)f
(Path)-45 1696 y(#>#)398 b(:)100 b(assembly)48 b(sequences.)-45
1796 y(#>#)i(JOB_PATH)98 b(geneid)-45 1896 y(#>#)50 b(JOB_XID)148
b(20020225)-45 1995 y(#>#)50 b(JOB_FILE)98 b(${LIBSTEP}/geneid.job)-45
2095 y(#>#)50 b(END_OF_JOB)e(#################################)o
(######)o(#####)o(######)o(#####)o(#####)o(######)p Black
Black -420 2291 a Fq(14b)181 b Fp(h)p FI(JOBS:)20 b(Running)e(GENEID)i
(standar)m(d)f Fq(14b)p Fp(i)r Ft(\021)-45 2391 y Fp(h)p
FI(STEPS\(g)o(eneid)f(std\):)i(Running)e(g)o(eneid)i(on)f(r)o(aw)i
(sequences)e Fq(14d)p Fp(i)-45 2490 y(h)p FI(STEPS\(g)o(eneid)f(std\):)
i(Pr)l(ocessing)g(g)o(eneid)f(output)g Fq(15a)p Fp(i)-45
2590 y(h)p FI(STEPS\(g)o(eneid)f(std\):)i(Evaluating)e(g)o(eneid)i(r)m
(esults)h Fq(15b)p Fp(i)p Black Black -415 2786 a Fq(14c)180
b Fp(h)p FI(GENEID:)41 b Fq(14c)p Fp(i)q Ft(\021)-45
2886 y Fu(#)-45 2985 y(#)50 b(Initialization)-45 3085
y(#)-45 3185 y(ODIR="$HUMUS/$CHR/geneid/$XID")45 b(;)-45
3284 y(#)-45 3384 y(CheckDirs)k($ODIR)f(;)-45 3484 y(for)i(c)f(in)h
(hsp-sr)e(out)i(gff)f(gtf2)g(cds)g(prot)g(logs)g(tmp)h(;)155
3583 y(do)f({)h(CheckDirs)e($ODIR/$c)g(;)i(})f(;)h(done)f(;)-45
3683 y(#)-128 3976 y FD(5.2.1)92 b(Running)21 b Fr(geneid)f
FD(\(without)j(homology\))p Black Black -420 4137 a Fq(14d)181
b Fp(h)p FI(STEPS\(g)o(eneid)18 b(std\):)i(Running)e(g)o(eneid)i(on)f
(r)o(aw)i(sequences)e Fq(14d)p Fp(i)r Ft(\021)-45 4237
y Fu(####>#########>#######################)o(<####)o(#####)o(######)o
(#####)o(######)o(#####)o(#####)o(####<#)-45 4336 y(#>#)50
b(STEP_ID)148 b(RUNNING_GENEID)-45 4436 y(#>#)50 b(STEP_DESC)e(Running)
g(geneid)h(\(without)f(homology\))g(on)i(Hsapiens)e(sequences)g(from)
-45 4536 y(#>#)448 b(:)50 b(Golden)f(Path)g(assembly.)-45
4635 y(#>#)h(STEP_PATH)e(out)-45 4735 y(#>#)i(STEP_XID)98
b($<JOB{.}{JOB_XID}>)-45 4835 y(#>#)50 b(STEP_IDIR)e
($HUMUS/$CHR/geneid/$XID)-45 4934 y(#>#)i(STEP_ODIR)e
($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45 5034 y(#>#)i(STEP_EDIR)e
($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45 5133 y(#>#)i(STEP_CODE)147
b(--------------------------------------)o(---#<)o(#)-45
5233 y(#)-45 5333 y(#<#)-45 5432 y
(GENEID="$SRC/geneid_v1.1/bin/geneid")44 b(;)49 b(#)h(geneid)e(v1.1)-45
5532 y(PARAM="$SRC/geneid_v1.1/param/human3is)o(o.par)o(am")c(;)-45
5632 y(EW=0)50 b(;)f(#)h(add)f(to)g(exon)h(weigth)-45
5731 y(#)-45 5831 y(#)g(ISEQ="$HSAP/chromFaMasked/$CHRNUM/$C)o(HR.fa)o
(.mask)o(ed")44 b(;)-45 5930 y(#->)50 b(we)f(do)h(not)f(run)g(geneid)g
(on)g(masked)g(sequences)f(at)h(this)h(moment)p Black
-128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g
(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 15 20
15 19 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(5.2.)23 b Fx(Gene)h(Prediction:)31 b Fm(geneid)2055
b FG(15)p -128 -243 4016 9 v Black -45 35 a Fu(#->)50
b(we)f(are)g(using)g(original)g(un-masked)f(fasta)h(sequences)f(from)h
(GP)-45 134 y(ISEQ="$HSAP/chromosomes/$CHR.fa")44 b(;)-45
234 y(IDIR="$HUMUS/$CHR/geneid/$XID/")g(;)-45 334 y(#)50
b(ODIR="$HUMUS/$CHR/geneid/$XID/out")44 b(;)-45 433 y(#)-45
533 y(#)50 b({)55 632 y({)g($GENEID)e(-v)i(-DE)f($EW)g(-P)h($PARAM)e
($ISEQ)h(|)h(grep)f(-v)g(evidence)g(\\)354 732 y(>)h($IDIR/out/$CHR)d
(;)55 832 y(})j(2>)f($IDIR/logs/$CHR)e(;)-45 931 y(#)150
b(})49 b(2>&1)g(|)h(tee)f($HUMUS/logs/geneid_sgp.$locus)c(;)-45
1031 y(#)-45 1131 y(#>#)50 b(END_OF_STEP)d
(--------------------------------------)o(---#<)o(#)p
Black Black -27 1361 a FD(Check)22 b(points:)p Black
110 1548 a Ft(\017)p Black 45 w FG(...)-128 1753 y FD(5.2.2)92
b(Pr)n(ocessing)25 b(output)e(f)n(or)g Fr(geneid)d FD(\(without)j
(homology\))p Black Black -415 1914 a Fq(15a)180 b Fp(h)p
FI(STEPS\(g)o(eneid)18 b(std\):)i(Pr)l(ocessing)g(g)o(eneid)f(output)g
Fq(15a)p Fp(i)r Ft(\021)-45 2014 y Fu
(####>#########>#######################)o(<####)o(#####)o(######)o
(#####)o(######)o(#####)o(#####)o(####<#)-45 2113 y(#>#)50
b(STEP_ID)148 b(GENEID_OUTPUT)-45 2213 y(#>#)50 b(STEP_DESC)e
(Processing)g(geneid)g(format)h(from)g(geneid)g(output)g(\(without)f
(homology\).)-45 2313 y(#>#)i(STEP_PATH)e(gff)-45 2412
y(#>#)i(STEP_XID)98 b($<JOB{.}{JOB_XID}>)-45 2512 y(#>#)50
b(STEP_IDIR)e($HUMUS/$CHR/geneid/$XID)-45 2612 y(#>#)i(STEP_ODIR)e
($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45 2711 y(#>#)i(STEP_EDIR)e
($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45 2811 y(#>#)i(STEP_CODE)147
b(--------------------------------------)o(---#<)o(#)-45
2910 y(#)-45 3010 y(#<#)50 b(IDIR="$HUMUS/$CHR/geneid/$XID")44
b(;)-45 3110 y(#)-45 3209 y(geneid_raw2GFF)k($IDIR)h($IDIR/out/$CHR)e
(;)-45 3309 y(#)-45 3409 y(ls)j(-1)f($IDIR/gff/)f(|)i(egrep)f("^$CHR")f
(|)i(\\)55 3508 y(while)f(read)g(n;)155 3608 y(do)g({)404
3707 y(cat)g($IDIR/gff/$n;)304 3807 y(};)155 3907 y(done)g(|)g(sort)g
(+3n)h(+4n)f(-5)g(-)h(>)g($IDIR/gff/$CHR)d(;)-45 4006
y(#)-45 4106 y(get_geneid_genes)g($IDIR/gff/$CHR)g(>)j
($IDIR/out.gene_list)c(;)-45 4206 y(#)-45 4305 y(#>#)k(END_OF_STEP)d
(--------------------------------------)o(---#<)o(#)p
Black Black -27 4535 a FD(Check)22 b(points:)p Black
110 4723 a Ft(\017)p Black 45 w FG(Number)i(of)f(genes,)i(a)n(v)o
(erage)g(length,)g(a)n(v)o(erage)g(e)o(xon)f(number)l(,)g(e)o
(xon/intron)j(length)e(ratio...)p Black 110 4911 a Ft(\017)p
Black 45 w FG(...)-128 5115 y FD(5.2.3)92 b(Ev)o(aluation)24
b(of)g Fr(geneid)c FD(pr)n(edictions)k(\(without)f(homology\))p
Black Black -420 5276 a Fq(15b)181 b Fp(h)p FI(STEPS\(g)o(eneid)18
b(std\):)i(Evaluating)e(g)o(eneid)i(r)m(esults)h Fq(15b)p
Fp(i)q Ft(\021)-45 5376 y Fu(####>#########>#######################)o
(<####)o(#####)o(######)o(#####)o(######)o(#####)o(#####)o(####<#)-45
5476 y(#>#)50 b(STEP_ID)148 b(GENEID_EVALUATION)-45 5575
y(#>#)50 b(STEP_DESC)e(Evaluation)g(of)h(geneid)g(predictions)f
(\(without)g(homology\).)-45 5675 y(#>#)i(STEP_PATH)e(evaluation)-45
5774 y(#>#)i(STEP_XID)98 b($<JOB{.}{JOB_XID}>)-45 5874
y(#>#)50 b(STEP_IDIR)e($HUMUS/$CHR/geneid/$XID)p Black
-128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g
(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 16 21
16 20 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(5.2.)23 b Fx(Gene)h(Prediction:)31 b Fm(geneid)2055
b FG(16)p -128 -243 4016 9 v Black -45 35 a Fu(#>#)50
b(STEP_ODIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45 134
y(#>#)i(STEP_EDIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
234 y(#>#)i(STEP_CODE)147 b(--------------------------------------)o
(---#<)o(#)-45 334 y(#)-45 433 y(#<#)50 b
(IDIR="$HUMUS/$CHR/geneid/$XID")44 b(;)-45 533 y(#)-45
632 y(#)50 b(run_evaluation)d(#chrom)i(program)f(param)348
b(prog_results_dir)47 b(\\)-45 732 y(#)797 b(annotation_dir)546
b(testset)98 b(lenght)-45 832 y(run_evaluation)147 b($CHR)i(geneid)98
b($XID)50 b(\\)105 931 y($ANALYSIS/geneid)d
($DATASETS/annotation/set/pseudo)d(VH_pseudo)k(47662662;)-45
1031 y(#)-45 1131 y(#>#)i(END_OF_STEP)d
(--------------------------------------)o(---#<)o(#)p
Black Black -27 1361 a FD(Check)22 b(points:)p Black
110 1548 a Ft(\017)p Black 45 w FG(...)p Black -128 6076
V -128 6180 a FK(Genome)e(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 17 22
17 21 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(5.3.)23 b Fx(Gene)h(Prediction:)40 b Fz(S)t(G)t(P)2235
b FG(17)p -128 -243 4016 9 v Black -128 35 a FL(5.3)100
b(Gene)25 b(Pr)n(ediction:)34 b Fk(S)t(G)t(P)p Black
Black -27 168 a FD(What)23 b(to)g(do)g(her)n(e:)p Black
110 356 a Ft(\017)p Black 45 w FG(Re-score)i(similarity)g(re)o(gions:)
31 b(SRs)22 b(to)i(HSP-SRs.)p Black 110 543 a Ft(\017)p
Black 45 w FG(Initialize)i(an)o(y)e(auxiliarly)i(\002le)d(\(lik)o(e)h
(those)h FB(*.termini)p FG(\).)p Black 110 731 a Ft(\017)p
Black 45 w FG(Run)g Fz(S)t(G)t(P)i FG(with)c(homology)-6
b(,)26 b(then)e(e)n(v)n(aluate)h(results.)p Black 110
919 a Ft(\017)p Black 45 w FG(Run)g Fz(S)t(G)t(P)i FG(with)c(homology)j
(plus)e(e)n(vidences,)i(then)e(e)n(v)n(aluate)h(results.)p
Black Black -415 1102 a Fq(17a)180 b Fp(h)p FI(JOBheader:)19
b(SGP)h(with)h(HSAPgpa)d(x)j(MMUSpha)e(homolo)o(gy)f
Fq(17a)p Fp(i)q Ft(\021)-45 1202 y Fu
(####>#########>#######################)o(<####)o(#####)o(######)o
(#####)o(######)o(#####)o(#####)o(####<#)-45 1301 y(#>#)50
b(JOB_ID)198 b(SGP_HSAPgpa_MMUSpha_TBX)-45 1401 y(#>#)50
b(JOB_DESC)98 b(Running)48 b("SGP")h(on)h(unmasked)e(H.sapiens)g(UCSC)h
(Golden)g(Path)-45 1501 y(#>#)398 b(:)100 b(assembly)48
b(sequences,)g(using)h(TBLASTX)f(homology)h(results)f(as)-45
1600 y(#>#)398 b(:)100 b(homology)48 b(evidences)g(once)h(they)g(have)g
(been)h(projected)e(into)h(SRs.)-45 1700 y(#>#)h(JOB_PATH)98
b(sgp)-45 1800 y(#>#)50 b(JOB_XID)148 b(20020225)-45
1899 y(#>#)50 b(JOB_FILE)98 b(${LIBSTEP}/sgp.job)-45
1999 y(#>#)50 b(END_OF_JOB)e(#################################)o
(######)o(#####)o(######)o(#####)o(#####)o(######)p Black
Black -420 2194 a Fq(17b)181 b Fp(h)p FI(JOBS:)20 b(SGP)g(with)h
(HSAPgpa)d(x)j(MMUSpha)e(homolo)o(gy)f Fq(17b)p Fp(i)q
Ft(\021)-45 2293 y Fp(h)p FI(STEPS\(SGP)h(HSAPgpa)f(x)j(MMUSpha\):)d
(Re-scoring)h(SRs)h Fq(17d)p Fp(i)-45 2393 y(h)p FI(STEPS\(SGP)f
(HSAPgpa)f(x)j(MMUSpha\):)d(A)n(uxiliarly)i(\002les)h
Fq(18a)p Fp(i)-45 2493 y(h)p FI(STEPS\(SGP)e(HSAPgpa)f(x)j(MMUSpha\):)d
(Running)g(SGP)i Fq(18b)p Fp(i)-45 2592 y(h)p FI(STEPS\(SGP)f(HSAPgpa)f
(x)j(MMUSpha\):)d(Pr)l(ocessing)i(SGP)g(r)m(esults)h
Fq(19)p Fp(i)-45 2692 y(h)p FI(STEPS\(SGP)e(HSAPgpa)f(x)j(MMUSpha\):)d
(Evaluating)g(SGP)i(r)m(esults)h Fq(20a)p Fp(i)p Black
Black -415 2887 a Fq(17c)180 b Fp(h)p FI(SGP:)41 b Fq(17c)p
Fp(i)q Ft(\021)-45 2986 y Fu(#)-45 3086 y(#)50 b(Initialization)-45
3186 y(#)-45 3285 y(ODIR="$HUMUS/$CHR/sgp/$XID")45 b(;)-45
3385 y(#)-45 3484 y(CheckDirs)k($ODIR)f(;)-45 3584 y(for)i(c)f(in)h
(hsp-sr)e(out)i(gff)f(gtf2)g(cds)g(prot)g(logs)g(tmp)h(;)155
3684 y(do)f({)h(ChckDirs)e($ODIR/$c)g(;)i(})g(;)f(done)g(;)-45
3783 y(#)-128 4076 y FD(5.3.1)92 b(Re-scoring)25 b(SRs)p
Black Black -420 4237 a Fq(17d)181 b Fp(h)p FI(STEPS\(SGP)19
b(HSAPgpa)f(x)j(MMUSpha\):)d(Re-scoring)h(SRs)h Fq(17d)p
Fp(i)r Ft(\021)-45 4336 y Fu(####>#########>#######################)o
(<####)o(#####)o(######)o(#####)o(######)o(#####)o(#####)o(####<#)-45
4436 y(#>#)50 b(STEP_ID)148 b(RE-SCORING_SRs)-45 4536
y(#>#)50 b(STEP_DESC)e(Re-scoring)g(SRs)h(to)g(produce)g(HSP-SRs)-45
4635 y(#>#)448 b(:)50 b(\(Hsapiens)e(GP)h(assembly)g(against)f
(Mmusculus)g(Phusion)h(assembly\).)-45 4735 y(#>#)h(STEP_PATH)e(hsp-sr)
-45 4835 y(#>#)i(STEP_XID)98 b($<JOB{.}{JOB_XID}>)-45
4934 y(#>#)50 b(STEP_IDIR)e($HUMUS/$CHR/tblastx/$XID/sr)-45
5034 y(#>#)i(STEP_ODIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
5133 y(#>#)i(STEP_EDIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
5233 y(#>#)i(STEP_CODE)147 b(--------------------------------------)o
(---#<)o(#)-45 5333 y(#)-45 5432 y(#<#)50 b
(IDIR="$HUMUS/$CHR/tblastx/$XID/sr")43 b(;)-45 5532 y(#<#)50
b(ODIR="$HUMUS/$CHR/sgp/$XID/hsp-sr")43 b(;)-45 5632
y(#)-45 5731 y($BIN/getHSPSR.pl)k($CHR)i(<)h($IDIR/$CHR.gff)d(>)j
($ODIR/$CHR.gff)d(2>)i($ODIR.report)f(;)-45 5831 y(#)-45
5930 y(#>#)i(END_OF_STEP)d(--------------------------------------)o
(---#<)o(#)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 18 23
18 22 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(5.3.)23 b Fx(Gene)h(Prediction:)40 b Fz(S)t(G)t(P)2235
b FG(18)p -128 -243 4016 9 v Black Black Black -27 6
a FD(Check)22 b(points:)p Black 110 194 a Ft(\017)p Black
45 w FG(...)-128 398 y FD(5.3.2)92 b(Pr)n(eparing)24
b(auxiliarly)i(\002les)p Black Black -415 559 a Fq(18a)180
b Fp(h)p FI(STEPS\(SGP)19 b(HSAPgpa)f(x)j(MMUSpha\):)d(A)n(uxiliarly)i
(\002les)h Fq(18a)p Fp(i)q Ft(\021)-45 659 y Fu
(####>#########>#######################)o(<####)o(#####)o(######)o
(#####)o(######)o(#####)o(#####)o(####<#)-45 759 y(#>#)50
b(STEP_ID)148 b(AUX_FILES)-45 858 y(#>#)50 b(STEP_DESC)e(Preparing)g
(auxiliarly)g(files:)h(CHR.termini)-45 958 y(#>#)h(STEP_PATH)e(tmp)-45
1058 y(#>#)i(STEP_XID)98 b($<JOB{.}{JOB_XID}>)-45 1157
y(#>#)50 b(STEP_IDIR)e($HUMUS/$CHR/tblastx/$XID/sr)-45
1257 y(#>#)i(STEP_ODIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
1356 y(#>#)i(STEP_EDIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
1456 y(#>#)i(STEP_CODE)147 b(--------------------------------------)o
(---#<)o(#)-45 1556 y(#)-45 1655 y(#<#)50 b
(ODIR="$HUMUS/$CHR/sgp/$XID/tmp")44 b(;)-45 1755 y
(LEN="$HUMUS/$CHR/annotation/$HSAPID/le)o(ngth")f(;)-45
1855 y(#)-45 1954 y(perl)50 b(-e)f(')55 2054 y(use)g(strict;)55
2153 y(my)h($chr)f(=)g(shift)g(@ARGV;)55 2253 y(my)h(\045SEQlen;)55
2353 y(my)g($seqln)e(=)i(shift)f(@ARGV;)55 2452 y(open\(FRGLEN,)f("<)h
($seqln"\);)55 2552 y(while)g(\(<FRGLEN>\))f({)254 2652
y(next)h(if)h(/^#/o;)254 2751 y(next)f(if)h(/^\\s*$/o;)254
2851 y(chomp;)254 2950 y(my)g(@l)f(=)h(split)f(/\\s+/og,)f($_;)254
3050 y($SEQlen{$l[0]})g(=)h($l[1];)55 3150 y(};)h(#)f(while)55
3249 y(close\(FRGLEN\);)55 3349 y(print)g(STDOUT)g(join\("\\t",)f
($chr,)g(qw/)i(force)f(cap)99 b(-2)g(0)50 b(.)f(+)h(0)f(/)h(\)."\\n";)
55 3449 y(print)f(STDOUT)g(join\("\\t",)f($chr,)g(qw/)i(force)f(poly)g
(/,)1151 3548 y(\($SEQlen{$chr})e(-)j(1\))f(x)h(2,)f(qw/)h(.)f(+)h(0/)f
(\)."\\n";)-45 3648 y(')h($CHR)f($LEN)g(>)h($ODIR/$CHR.termini)c(;)-45
3748 y(#)-45 3847 y(#>#)k(END_OF_STEP)d
(--------------------------------------)o(---#<)o(#)p
Black Black -27 4077 a FD(Check)22 b(points:)p Black
110 4265 a Ft(\017)p Black 45 w FG(...)-128 4470 y FD(5.3.3)92
b(Running)23 b FA(S)t(G)t(P)k FD(\()p Fr(geneid)20 b
FD(with)j(homology\))p Black Black -420 4631 a Fq(18b)181
b Fp(h)p FI(STEPS\(SGP)19 b(HSAPgpa)f(x)j(MMUSpha\):)d(Running)g(SGP)i
Fq(18b)p Fp(i)r Ft(\021)-45 4730 y Fu
(####>#########>#######################)o(<####)o(#####)o(######)o
(#####)o(######)o(#####)o(#####)o(####<#)-45 4830 y(#>#)50
b(STEP_ID)148 b(SGP_HSAPgpa_MMUSpha)-45 4930 y(#>#)50
b(STEP_DESC)e(Running)g(geneid)h(on)g(Hsapiens)g(sequences)f(from)h
(Golden)g(Path)g(assembly)-45 5029 y(#>#)448 b(:)50 b(with)f(homology)f
(evidences)g(taken)h(from)g(Mmusculus)f(Phusion)h(assembly.)-45
5129 y(#>#)h(STEP_PATH)e(out)-45 5228 y(#>#)i(STEP_XID)98
b($<JOB{.}{JOB_XID}>)-45 5328 y(#>#)50 b(STEP_IDIR)e
($HUMUS/$CHR/sgp/$XID/)-45 5428 y(#>#)i(STEP_ODIR)e
($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45 5527 y(#>#)i(STEP_EDIR)e
($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45 5627 y(#>#)i(STEP_CODE)147
b(--------------------------------------)o(---#<)o(#)-45
5727 y(#)-45 5826 y(#<#)-45 5926 y(#)p Black -128 6076
V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 19 24
19 23 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(5.3.)23 b Fx(Gene)h(Prediction:)40 b Fz(S)t(G)t(P)2235
b FG(19)p -128 -243 4016 9 v Black -45 35 a Fu
(GENEID="$SRC/geneid_v1.1-sgp/bin/genei)o(d")44 b(;)49
b(#)h(geneid)f(v1.1-sgp)-45 134 y
(PARAM="$SRC/geneid_v1.1-sgp/param/huma)o(n3iso)o(.para)o(m.sgp")43
b(;)-45 234 y(EW=0)50 b(;)f(#)h(add)f(to)g(exon)h(weigth)-45
334 y(#)-45 433 y(#)g(ISEQ="$HSAP/chromFaMasked/$CHRNUM/$C)o(HR.fa)o
(.mask)o(ed")44 b(;)-45 533 y(#->)50 b(we)f(do)h(not)f(run)g(geneid)g
(on)g(masked)g(sequences)f(at)h(this)h(moment)-45 632
y(#->)g(we)f(are)g(using)g(original)g(un-masked)f(fasta)h(sequences)f
(from)h(GP)-45 732 y(ISEQ="$HSAP/chromosomes/$CHR.fa")44
b(;)-45 832 y(IDIR="$HUMUS/$CHR/sgp/$XID/")h(;)-45 931
y(#)50 b(ODIR="$HUMUS/$CHR/sgp/$XID/out")44 b(;)-45 1031
y(HOMOLOGY="$HUMUS/$CHR/sgp/$XID/hsp-sr/)o($CHR.)o(gff")f(;)-45
1131 y(#)-45 1230 y(#)50 b({)55 1330 y({)g($GENEID)e(-v)i(-DE)f($EW)g
(-P)h($PARAM)e(-S)i($HOMOLOGY)e(\\)354 1429 y(-R)h
($IDIR/tmp/$CHR.termini)d($ISEQ)j(|)h(grep)f(-v)g(evidence)f(\\)354
1529 y(>)i($IDIR/out/$CHR)d(;)55 1629 y(})j(2>)f($IDIR/logs/$CHR)e(;)
-45 1728 y(#)150 b(})49 b(2>&1)g(|)h(tee)f
($HUMUS/logs/geneid_sgp.$locus)c(;)-45 1828 y(#)-45 1928
y(#>#)50 b(END_OF_STEP)d(--------------------------------------)o
(---#<)o(#)p Black Black -27 2158 a FD(Check)22 b(points:)p
Black 110 2345 a Ft(\017)p Black 45 w FG(...)-128 2550
y FD(5.3.4)92 b(Pr)n(ocessing)25 b(output)e(f)n(or)i
FA(S)t(G)t(P)i FD(\(with)c(homology\))p Black Black -382
2711 a Fq(19)180 b Fp(h)p FI(STEPS\(SGP)19 b(HSAPgpa)f(x)j(MMUSpha\):)d
(Pr)l(ocessing)i(SGP)g(r)m(esults)h Fq(19)p Fp(i)q Ft(\021)-45
2811 y Fu(####>#########>#######################)o(<####)o(#####)o
(######)o(#####)o(######)o(#####)o(#####)o(####<#)-45
2910 y(#>#)50 b(STEP_ID)148 b(SGP_OUTPUT)-45 3010 y(#>#)50
b(STEP_DESC)e(Processing)g(geneid)g(format)h(from)g(sgp)g(output)g
(\(with)g(homology\).)-45 3110 y(#>#)h(STEP_PATH)e(gff)-45
3209 y(#>#)i(STEP_XID)98 b($<JOB{.}{JOB_XID}>)-45 3309
y(#>#)50 b(STEP_IDIR)e($HUMUS/$CHR/geneid/$XID)-45 3409
y(#>#)i(STEP_ODIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
3508 y(#>#)i(STEP_EDIR)e($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45
3608 y(#>#)i(STEP_CODE)147 b(--------------------------------------)o
(---#<)o(#)-45 3707 y(#)-45 3807 y(#<#)50 b
(IDIR="$HUMUS/$CHR/sgp/$XID")44 b(;)-45 3907 y(#)-45
4006 y(geneid_raw2GFF)k($IDIR)h($IDIR/out/$CHR)e(;)-45
4106 y(#)-45 4206 y(ls)j(-1)f($IDIR/gff/)f(|)i(egrep)f("^$CHR")f(|)i
(\\)55 4305 y(while)f(read)g(n;)155 4405 y(do)g({)404
4504 y(cat)g($IDIR/gff/$n;)304 4604 y(};)155 4704 y(done)g(|)g(sort)g
(+3n)h(+4n)f(-5)g(-)h(>)g($IDIR/gff/$CHR)d(;)-45 4803
y(#)-45 4903 y(get_geneid_genes)g($IDIR/gff/$CHR)g(>)j
($IDIR/out.gene_list)c(;)-45 5003 y(#)-45 5102 y(#>#)k(END_OF_STEP)d
(--------------------------------------)o(---#<)o(#)p
Black Black -27 5332 a FD(Check)22 b(points:)p Black
110 5520 a Ft(\017)p Black 45 w FG(Number)i(of)f(genes,)i(a)n(v)o
(erage)g(length,)g(a)n(v)o(erage)g(e)o(xon)f(number)l(,)g(e)o
(xon/intron)j(length)e(ratio...)p Black 110 5708 a Ft(\017)p
Black 45 w FG(...)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 20 25
20 24 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(5.3.)23 b Fx(Gene)h(Prediction:)40 b Fz(S)t(G)t(P)2235
b FG(20)p -128 -243 4016 9 v Black -128 35 a FD(5.3.5)92
b(Ev)o(aluation)24 b(of)i FA(S)t(G)t(P)g FD(pr)n(edictions)f(\(with)e
(homology\))p Black Black -415 196 a Fq(20a)180 b Fp(h)p
FI(STEPS\(SGP)19 b(HSAPgpa)f(x)j(MMUSpha\):)d(Evaluating)g(SGP)i(r)m
(esults)h Fq(20a)p Fp(i)q Ft(\021)-45 295 y Fu
(####>#########>#######################)o(<####)o(#####)o(######)o
(#####)o(######)o(#####)o(#####)o(####<#)-45 395 y(#>#)50
b(STEP_ID)148 b(SGP_EVALUATION)-45 495 y(#>#)50 b(STEP_DESC)e
(Evaluation)g(of)h(SGP)g(predictions)f(\(geneid)h(with)g(homology\).)
-45 594 y(#>#)h(STEP_PATH)e(evaluation)-45 694 y(#>#)i(STEP_XID)98
b($<JOB{.}{JOB_XID}>)-45 793 y(#>#)50 b(STEP_IDIR)e
($HUMUS/$CHR/geneid/$XID)-45 893 y(#>#)i(STEP_ODIR)e
($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45 993 y(#>#)i(STEP_EDIR)e
($JOBDIR/$<STEP{.}{.}{STEP_PATH}>)-45 1092 y(#>#)i(STEP_CODE)147
b(--------------------------------------)o(---#<)o(#)-45
1192 y(#)-45 1292 y(#<#)50 b(IDIR="$HUMUS/$CHR/sgp/$XID")44
b(;)-45 1391 y(#)-45 1491 y(#)-45 1590 y(#>#)50 b(END_OF_STEP)d
(--------------------------------------)o(---#<)o(#)p
Black Black -27 1821 a FD(Check)22 b(points:)p Black
110 2008 a Ft(\017)p Black 45 w FG(...)-128 2213 y FD(5.3.6)92
b(Running)23 b FA(S)t(G)t(P)k FD(with)c(homology)h(and)e(e)o(vidences)p
Black Black -420 2374 a Fq(20b)181 b Fp(h)p FI(SGP:)41
b Fq(17c)p Fp(i)q Fo(+)p Ft(\021)-45 2474 y Fu(#)-45
2573 y(#)100 b(Running)48 b(geneid)h(with)g(homology)f(+)i(evidences)
-45 2673 y(#)-45 2773 y(SGP2="/projects/sgp/src/geneid_v1.1-sg)o(p")44
b(;)205 2872 y(#)49 b(binaries,)f(scripts)h(and)g(params)g(in)g(SGP2)
-45 2972 y(GENEID="$SGP2/bin/geneid")d(;)j(#)h(geneid)f(v1.1-sgp)-45
3071 y(PARAM="$SGP2/param/human3iso.param.sgp)o(")44
b(;)-45 3171 y(EW=0)50 b(;)f(#)h(add)f(to)g(exon)h(weigth)-45
3271 y(#)-45 3370 y(ISEQ="$HSAP/chromFaMasked/$CHRNUM/$CHR)o(.fa.m)o
(asked)o(")44 b(;)-45 3470 y(IDIR="$HUMUS/$CHR/sgp/$XID/")h(;)-45
3570 y(#)50 b(ODIR="$HUMUS/$CHR/sgp/$XID/out")44 b(;)-45
3669 y(HOMOLOGY="$HUMUS/$CHR/sgp/$XID/hsp-sr/)o($CHR.)o(gff")f(;)-45
3769 y(EVIDENCES="/$CHR.gff")j(;)-45 3868 y(#)-45 3968
y({)k($GENEID)f(-v)g(-D)g(-E)h($EW)f(-P)h($PARAM)e(-S)i($HOMOLOGY)e(\\)
354 4068 y(-R)h($EVIDENCES)f($ISEQ)h(>)h($IDIR/out/$CHR)d(;)55
4167 y(})j(2>)f($IDIR/logs/$CHR)e(;)-45 4267 y(#)100
b(})50 b(2>&1)f(|)g(tee)g($HUMUS/logs/geneid_sgp.$locus)c(;)-45
4367 y(#)p Black Black -27 4589 a FD(Check)22 b(points:)p
Black 110 4776 a Ft(\017)p Black 45 w FG(...)p Black
-128 6076 V -128 6180 a FK(Genome)e(Inf)n(ormatics)g(Resear)o(ch)g(Lab)
282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 21 26
21 25 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(6.)23 b(Masking)i(gene-predictions)k(along)24 b(mask)o(ed)h
(sequences)1236 b(21)p -128 -243 4016 9 v Black -128
35 a FM(6)120 b(Masking)30 b(gene-pr)n(edictions)h(along)f(mask)o(ed)f
(sequences)p Black Black -415 228 a Fq(21a)180 b Fp(h)p
FI(Global:)41 b Fq(4c)p Fp(i)p Fo(+)p Ft(\021)-45 328
y Fu(#)-45 428 y(#)-45 527 y(#)50 b(HUMUS="$BASE/H.sapiens")c(->)j
(.project_VARS)-45 627 y(#)-45 727 y(CHRLIST="22")f(;)-45
826 y(#)-45 926 y(for)i(n)f(in)h($CHRLIST;)55 1025 y(do)g({)304
1125 y(chrdir="$HUMUS/chr$n")c(;)304 1225 y(CheckDirs)i($chrdir)h(;)304
1324 y(CheckDirs)f($chrdir/tblastx+)f($chrdir/sgp+)h(;)205
1424 y(};)55 1524 y(done)h(;)-45 1623 y(#)-45 1723 y(CHRNUM="22")f(;)i
(#)f(length)g(->)h(47748585)-45 1822 y(CHR="chr$CHRNUM")d(;)-45
1922 y(XID="20020212";)-45 2022 y(#)p Black Black -420
2218 a Fq(21b)181 b Fp(h)21 b Fq(21b)p Fp(i)r Ft(\021)-45
2318 y Fu(#)50 b(bash)-45 2418 y(#)g(CLEAR,)f(RESET,)f(CONCEALED,)-45
2517 y(#)i(BOLD,)f(DARK,)g(UNDERLINE,)f(UNDERSCORE,)g(BLINK,)g
(REVERSE,)-45 2617 y(#)i(BLACK,)f(RED,)g(GREEN,)g(YELLOW,)f(BLUE,)h
(MAGENTA,)-45 2716 y(#)h(ON_BLACK,)e(ON_RED,)h(ON_GREEN,)f(ON_YELLOW,)g
(ON_BLUE,)g(ON_MAGENTA,)g(ON_CYAN,)g(and)h(ON_WHITE)-45
2816 y(#)-45 2916 y(function)g(show_masked)f({)155 3015
y(perl)h(-npe)g(')354 3115 y(use)g(Term::ANSIColor;)354
3215 y(s/^\(>.*?\)\(\\s+.*\)$/color\("bold)44 b
(red"\).$1.color\("reset"\).$2/oe;)354 3314 y(#)50 b(masked)354
3414 y(s/\(N+\)/color\("green"\).$1.color\("res)o(et"\)/)o(oge;)354
3513 y(s/\(n+\)/color\("yellow"\).$1.color\("re)o(set"\))o(/oge;)354
3613 y(#)g(starts)354 3713 y(s/\(ATG\)/color\("black)c
(on_green"\).$1.color\("reset"\)/oge;)e(#)49 b(forward)354
3812 y(s/\(CAT\)/color\("white)d(on_green"\).$1.color\("reset"\)/oge;)e
(#)49 b(reverse)354 3912 y(#)h(stops)354 4012 y
(s/\(TAA|TAG|TGA\)/color\("black)45 b
(on_red"\).$1.color\("reset"\)/oge;)f(#)49 b(forward)354
4111 y(s/\(TTA|CTA|TCA\)/color\("white)c
(on_red"\).$1.color\("reset"\)/oge;)f(#)49 b(reverse)155
4211 y(')g("$@")g(|)h(more)-45 4310 y(})-45 4410 y(#)-128
4707 y FL(6.1)100 b(Masking)24 b(cds)i(on)f(P)o(ankaj)g(mask)o(ed)h
(sequence)g(fragments)p Black Black -27 4860 a FD(What)d(to)g(do)g(her)
n(e:)p Black 110 5047 a Ft(\017)p Black 45 w FG(Mask)h(CDSs)e
(predicted)k(by)f Fz(S)t(G)t(P)i FG(on)d(the)f(sequence)j(fragmetns)g
(already)f(mask)o(ed)f(by)g(P)o(ankaj.)p Black Black
-415 5233 a Fq(21c)180 b Fp(h)21 b Fq(21b)p Fp(i)r Fo(+)p
Ft(\021)-45 5333 y Fu(perl)50 b(-e)f(')55 5432 y(use)g(strict;)55
5532 y(my)h(\($base,$ipath,$opath,$gnlst,@file)o(s,)254
5632 y(\045offset,\045cds,\045genes,$n,$totgns,$totcd)o(s,$tg)o(enes,$)
o(tcds\))o(;)55 5731 y(my)g($chr)f(=)g(shift)g(@ARGV;)55
5831 y($base)g(=)h("/projects/H.sapiens";)55 5930 y($ipath)f(=)g
("$base/.ftp/PankajAgarwal/20020123.se)o(q-mask)o(ed";)p
Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o
(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)
1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 22 27
22 26 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(6.1.)23 b Fx(Masking)i(cds)f(on)g(P)o(ankaj)g(mask)o(ed)g
(sequence)i(fragments)1143 b FG(22)p -128 -243 4016 9
v Black 55 35 a Fu($opath)49 b(=)g
("$base/.ftp/PankajAgarwal/20020208.se)o(q-mask)o(ed+ge)o(nes-ma)o
(sked")o(;)55 134 y(my)h($gff)f(=)g
("$base/$chr/sgp/20020122/gff/$chr";)55 234 y(#)h($gnlst)e(=)i
("$base/$chr/sgp/20020122/out.gene_l)o(ist";)55 334 y(#)g(getting)e
(input)h(filenames)55 433 y(opendir\(NA,$ipath\);)55
533 y(@files)g(=)g(grep)g({)h(/^$chr/)f(})g(readdir\(NA\);)55
632 y(closedir\(NA\);)55 732 y(print)g(STDERR)g("##)g(Found)g
(".scalar\(@files\).")d(input)j(files)g(for)g($chr...\\n";)55
832 y(#)h(get)f(sequence)f(starting)h(coord)f(offset)55
931 y(foreach)h(my)g($fl)g(\(@files\))g({)254 1031 y($fl)h(=~)f
(/_\(\\d+\)_\\d+$/o)e(&&)j(\($offset{$1})d(=)j($fl\);)55
1131 y(};)5 1230 y(#)55 1330 y(#)g(reading)e(gene)h(coords)55
1429 y(#)h(open\(GF,"<)e($gnlst"\);)55 1529 y(#)i($n)f(=)h(0;)55
1629 y(#)g(while)f(\(<GF>\))f({)55 1728 y(#)249 b(my)49
b(@l;)55 1828 y(#)249 b(next)49 b(if)g(/^#/o;)55 1928
y(#)249 b(next)49 b(if)g(/^\\s*$/o;)55 2027 y(#)249 b(chomp;)55
2127 y(#)g(@l)49 b(=)h(split)f(/\\s+/og,)f($_,)h(5;)55
2227 y(#)249 b($genes{$n++})48 b(=)h([)h(@l[1,2],"$l[0]$l[3]")c(];)55
2326 y(#)k(};)55 2426 y(#)g(close\(GF\);)55 2525 y(#)g($tgenes)e(=)i
($n;)55 2625 y(#)g(print)f(STDERR)f("##)i(Found)e($tgenes)h(genes)g(to)
g(mask)g(on)h($chr...\\n";)5 2725 y(#)55 2824 y(#)g(reading)e(from)h
(GFF)55 2924 y(open\(GFF,"<)f($gff"\);)55 3024 y($n)i(=)f(0;)55
3123 y(\045genes)g(=)g(\(\);)55 3223 y(while)g(\(<GFF>\))f({)254
3322 y(my)i(@l;)254 3422 y(next)f(if)h(/^#/o;)254 3522
y(next)f(if)h(/^\\s*$/o;)254 3621 y(chomp;)254 3721 y(@l)g(=)f(split)g
(/\\s+/og,)g($_;)254 3821 y($cds{$n++})f(=)i([)g(@l[3,4],"$l[8]$l[6]")c
(];)254 3920 y($genes{"$l[8]$l[6]"}++;)55 4020 y(};)55
4119 y(close\(GFF\);)55 4219 y($tgenes)j(=)g(scalar)g(\(keys)g
(\045genes\);)55 4319 y($tcds)149 b(=)49 b($n;)55 4418
y(print)g(STDERR)g("##)g(Found)g($tgenes)f(genes)h(\($tcds)g(cds\))g
(to)g(mask)g(on)h($chr...\\n";)55 4518 y(#)g(processing)e(fastas)55
4618 y($totgns)h(=)g($totcds)g(=)g(0;)55 4717 y(foreach)g(my)g($fl)g
(\(sort)g(keys)g(\045offset\))g({)254 4817 y(my)h
(\($sqn,$fstg,$fcds\);)254 4916 y(open\(FI,"<)e
($ipath/$offset{$fl}"\);)254 5016 y(open\(FO,">)g
($opath/$offset{$fl}.cds"\);)254 5116 y($sqn)h(=)h($fl;)254
5215 y($n)g(=)f($fstg)g(=)h($fcds)f(=)g(0;)254 5315 y(\045genes)g(=)h
(\(\);)254 5415 y(while)f(\($cds{$n}[1])f(<=)h($fl\))g({)h($n++;)f(};)g
(#)h(if)f(gene)g(ends)g(before)g(sequence)f(ori)254 5514
y(while)h(\(<FI>\))g({)454 5614 y(my)g(\(@l,$ln\);)454
5713 y(next)g(if)g(/^\\s*$/o;)454 5813 y(/^>/o)f(&&)i(do)f({)653
5913 y(print)g(FO)g($_;)p Black -128 6076 V -128 6180
a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 23 28
23 27 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(6.2.)23 b Fx(Processing)j(P)o(ankaj)36 b Fz(T)t(B)t(L)t(A)t(S)t(T)
t(X)28 b Fx(results)1715 b FG(23)p -128 -243 4016 9 v
Black 653 35 a Fu(next;)454 134 y(};)454 234 y(chomp;)454
334 y(s/\\s*$//o;)48 b(s/^\\s*//o;)454 433 y(@l)h(=)h(split)f(//,)g
(uc\($_\);)454 533 y($ln)g(=)g("";)454 632 y(for)g(\(my)g($i)h(=)f(0;)h
($i)f(<=)g($#l;)h($i++\))e({)653 732 y($sqn++;)653 832
y($ln)h(.=)h(\($sqn)e(>=)i($cds{$n}[0])e(&&)h($sqn)g(<=)h
($cds{$n}[1]\))1002 931 y(?)f("n")g(:)h($l[$i])f(;)653
1031 y(\($sqn)g(==)g($cds{$n}[0]\))f(&&)h(\($fcds++\);)653
1131 y(\($sqn)g(==)g($cds{$n}[1]\))f(&&)h(\($n++,)g
($genes{$cds{$n}[2]}++\);)454 1230 y(};)454 1330 y(print)f(FO)i
("$ln\\n";)254 1429 y(};)254 1529 y(close\(FO\);)254
1629 y(close\(FI\);)254 1728 y($fstg)f(=)h(scalar)f(\(keys)f
(\045genes\);)254 1828 y(print)h(STDERR)g("###)g($fstg)g(genes)g
(\($fcds)f(cds\))h(were)h(masked)e(on)i(\\"$offset{$fl}\\"...\\n";)254
1928 y(#)g($totgns)e(+=)i($fstg;)254 2027 y($totgns)f(+=)g($fstg;)254
2127 y($totcds)g(+=)g($fcds;)55 2227 y(};)55 2326 y(print)g(STDERR)g
("###)g($totgns)f(of)i($tgenes)e(genes)h(\($totcds)f(of)i($tcds)f
(cds\))g(were)g(masked)g(on)g($chr...\\n";)55 2426 y(#)h(counter)e
(sums)h(are)h(not)f(well)g(done...)f(but)i(masking)e(is)i(ok)-45
2525 y(')g(chr22)f(2>)g(./masking_cds.log)e(;)j(#)f(2>)h
(./masking_genes.log)c(;)-128 2813 y FL(6.2)100 b(Pr)n(ocessing)25
b(P)o(ankaj)i Fk(T)t(B)t(L)t(A)t(S)t(T)t(X)33 b FL(r)n(esults)p
Black Black -27 2965 a FD(What)23 b(to)g(do)g(her)n(e:)p
Black 110 3153 a Ft(\017)p Black 45 w FG(Process)k Fz(T)t(B)t(L)t(A)t
(S)t(T)t(X)h FG(results)d(from)e(P)o(ankaj:)p Black 309
3341 a FD(\226)p Black 46 w FG(Mask)o(ed)i(sequences)h(plus)g
Fz(S)t(G)t(P)h FG(predicted)f(cds)e(also)g(mask)o(ed)g(\(20020208\).)p
Black 309 3487 a FD(\226)p Black 46 w FG(Mouse)g(genome)h(assembly)g
(from)e(Sanger)i(Center)f(Phusion)g(assembly)h(\(20011109)i(???\).)p
Black Black 400 3644 a FB(#)54 b(Database:)105 b(/bioinfo/gapdb/)o(bl)o
(ast)o(db)o(/M)o(us)o(Ph)o(usi)o(on)400 3757 y(#)54 b(Title:)107
b(MusPhusion)400 3870 y(#)54 b(#)g(of)g(letters)d(in)j(database:)105
b(2,374,690,634)e(\(Z)54 b(=)g(3000000000\))400 3983
y(#)g(#)g(of)g(sequences)c(in)k(database:)105 b(431,480)400
4095 y(#)54 b(Format:)106 b(XDF-1)400 4208 y(#)54 b(Created:)106
b(5:32:13)51 b(PM)j(EST)f(Dec)g(10,)g(2001)400 4321 y(#)h(Posted:)106
b(5:32:14)51 b(PM)j(EST)f(Dec)g(10,)h(2001)p Black 309
4488 a FD(\226)p Black 48 w Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)28
b FG(w)o(as)c(run)g(with)f(the)h(follo)n(wing)h(parameters:)p
Black Black 400 4645 a FB(W=5)108 b(Z=3000000000)400
4758 y(matrix=blosum62)o(mo)o(d)103 b(filter=xnu+seg)400
4871 y(nogaps)j(hspmax=500)f(topcomboN=100)400 4984 y(B=9000)h(V=9000)h
(E=0.01)f(E2=0.01)g(S2=80)400 5097 y(warnings)g(cpus=4)g
(ctxfactor=36.0)p Black 110 5284 a Ft(\017)p Black 45
w FG(Get)23 b(HSPs)f Ft(\))h FG(SRs)f Ft(\))g FG(HSP-SRs)p
Black Black -382 5432 a Fq(23)180 b Fp(h)p FI(Homolo)o(gy:)40
b Fq(23)p Fp(i)q Ft(\021)-45 5532 y Fu(#)-45 5632 y(#)50
b(Unpacking)e(TBLASTX)h(results)f(obtained)h(by)g(Pankaj)-45
5731 y(#)-45 5831 y(IDIR="$HUMUS/.ftp/PankajAgarwal/200202)o(12.ge)o
(nes-m)o(asked+)o(tbxPh)o(usion")43 b(;)-45 5930 y
(ODIR="$HUMUS/$CHR/tblastx+/$XID")h(;)p Black -128 6076
V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 24 29
24 28 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(6.3.)23 b Fx(Retrie)n(ving)34 b Fz(T)t(B)t(L)t(A)t(S)t(T)t(X)29
b Fx(results)c(by)f(chromosome)1393 b FG(24)p -128 -243
4016 9 v Black -45 35 a Fu(#)-45 134 y(CheckDirs)49 b($ODIR)f
($ODIR/ori)h(;)-45 234 y(#)-45 334 y(mv)h(-v)f($IDIR/${CHR}*)f
($ODIR/ori)g(;)-45 433 y(#)-45 533 y($BIN/sbp_checkblastout.pl)e($CHR)j
($ODIR/ori)f(>)h($ODIR/ori.report)e(;)-45 632 y(#)-128
931 y FL(6.3)100 b(Retrie)o(ving)26 b Fk(T)t(B)t(L)t(A)t(S)t(T)5
b(X)33 b FL(r)n(esults)25 b(by)g(chr)n(omosome)p Black
Black -415 1092 a Fq(24a)180 b Fp(h)p FI(Homolo)o(gy:)40
b Fq(23)p Fp(i)q Fo(+)p Ft(\021)-45 1192 y Fu(#)-45 1292
y(#)50 b(Retrieving)e(TBLASTX)h(results)f(by)h(chromosome)-45
1391 y(#)-45 1491 y(IDIR="$HUMUS/$CHR/tblastx+/$XID/ori")44
b(;)-45 1591 y(ODIR="$HUMUS/$CHR/tblastx+/$XID/hsp")g(;)-45
1690 y(SDIR="$HUMUS/$CHR/annotation")h(;)-45 1790 y(#)-45
1889 y(CheckDirs)k($ODIR)f(;)-45 1989 y(#)-45 2089 y
($BIN/sbp_blast2gff.pl)e($CHR)j($SDIR/$HSAPID/length)d($IDIR)j(\\)404
2188 y(>)g($ODIR/$CHR.fullgff)e(2>)i($ODIR.report)f(;)-45
2288 y(#)-45 2388 y(perl)i(-ne)f('/^#/o)f(&&)i(next;)f(/^\\s+$/o)f(&&)i
(next;)454 2487 y($_)f(=~)g(s/;\\s+Strand//o;)454 2587
y($_)g(=~)g(s/;\\s+Frame//o;)454 2686 y($_)g(=~)g
(s/;\\s+E_value.*$//o;)454 2786 y(print)f(STDOUT)h($_;')g
($ODIR/$CHR.fullgff)e(|)i(\\)454 2886 y(sort)g(+3n)g(-6)g(+6)h(-7)f(-)h
(>)f($ODIR/$CHR.gff)f(;)-45 2985 y(#)-128 3281 y FD(6.3.1)92
b(Mer)o(ging)24 b(HSPs)e(fr)n(om)i(\002rst)h FA(T)t(B)t(L)t(A)t(S)t(T)t
(X)h FD(run)c(and)g(the)h(new)g(ones)p Black Black -420
3442 a Fq(24b)181 b Fp(h)p FI(Homolo)o(gy:)40 b Fq(23)p
Fp(i)q Fo(+)p Ft(\021)-45 3542 y Fu(#)-45 3641 y(#)50
b(Merging)f(TBLASTX)f(results)-45 3741 y(PXID="20020122")f(;)j(#)g(XID)
f(of)g(the)h(tblastx)e(run)h(we)h(want)f(to)g(merge)g(\(default)g
(PXID==XID\))-45 3841 y(IDIR="$HUMUS/$CHR/tblastx/$PXID/hsp")44
b(;)-45 3940 y(ODIR="$HUMUS/$CHR/tblastx+/$XID/hsp")g(;)-45
4040 y(#)-45 4139 y(cat)50 b($IDIR/$CHR.gff)d($ODIR/$CHR.gff)g(|)100
b(\\)454 4239 y(sort)49 b(+3n)g(-6)g(+6)h(-7)f(-)h(>)f
($ODIR/$CHR.merged.gff)d(;)-45 4339 y(#)-128 4634 y FD(6.3.2)92
b(Pr)n(ojecting)25 b(HSPs)d(into)h(SRs)p Black Black
-415 4795 a Fq(24c)180 b Fp(h)p FI(Homolo)o(gy:)40 b
Fq(23)p Fp(i)q Fo(+)p Ft(\021)-45 4895 y Fu(#)-45 4995
y(#)50 b(Projecting)e(HSPs)h(into)g(SRs)-45 5094 y(#)-45
5194 y(IDIR="$HUMUS/$CHR/tblastx+/$XID/hsp")44 b(;)-45
5293 y(ODIR="$HUMUS/$CHR/tblastx+/$XID/sr")g(;)-45 5393
y(#)-45 5493 y(CheckDirs)49 b($ODIR)f(;)-45 5592 y(#)-45
5692 y(BLAST2GFF="/projects/bin/blast2gff";)-45 5792
y($BLAST2GFF)g(-g)i($IDIR/$CHR.gff)d(>)j($ODIR/$CHR.gff)d(;)-45
5891 y($BLAST2GFF)h(-g)i($IDIR/$CHR.merged.gff)c(>)j
($ODIR/$CHR.merged.gff)d(;)p Black -128 6076 V -128 6180
a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 25 30
25 29 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(6.4.)23 b Fx(Gene)h(Prediction:)40 b Fz(S)t(G)t(P)2235
b FG(25)p -128 -243 4016 9 v Black -45 35 a Fu(#)-45
134 y(gawk)50 b(')55 234 y(BEGIN{)f(chr=ARGV[1];)e(ARGV[1]="";)h(})55
334 y($1)i(!~)f(/^#/)g({)h(a[$7.$8]++;)d(b[$7]++)i(})55
433 y(END{)155 533 y(printf)f("#)i(TOTAL)f(\045s)g(SRs)g(on)h(\045s:)f
(\045s)h(forward,)e(\045s)h(reverse.\\n",)503 632 y(b["+"]+b["-"],)f
(chr,)h(b["+"],)f(b["-"];)155 732 y(for)h(\(i)g(in)h(a\))f({)254
832 y(printf)g("#)99 b(\\t\045s)49 b(:)h(\045s\\n",)f(i,)g(a[i];)155
931 y(};)55 1031 y(})-45 1131 y(')h($CHR)f($ODIR/$CHR.gff)e(>)j
($ODIR.report)e(;)-45 1230 y(#)-45 1330 y(gawk)i(')55
1429 y(BEGIN{)f(chr=ARGV[1];)e(ARGV[1]="";)h(})55 1529
y($1)i(!~)f(/^#/)g({)h(a[$7.$8]++;)d(b[$7]++)i(})55 1629
y(END{)155 1728 y(printf)f("#)i(TOTAL)f(\045s)g(SRs)g(on)h(\045s:)f
(\045s)h(forward,)e(\045s)h(reverse.\\n",)503 1828 y(b["+"]+b["-"],)f
(chr,)h(b["+"],)f(b["-"];)155 1928 y(for)h(\(i)g(in)h(a\))f({)254
2027 y(printf)g("#)99 b(\\t\045s)49 b(:)h(\045s\\n",)f(i,)g(a[i];)155
2127 y(};)55 2227 y(})-45 2326 y(')h($CHR)f($ODIR/$CHR.merged.gff)d(>)k
($ODIR.merged.report)c(;)-45 2426 y(#)-128 2725 y FL(6.4)100
b(Gene)25 b(Pr)n(ediction:)34 b Fk(S)t(G)t(P)p Black
Black -415 2886 a Fq(25a)180 b Fp(h)p FI(SGP:)41 b Fq(17c)p
Fp(i)q Fo(+)p Ft(\021)-45 2985 y Fu(#)-45 3085 y(#)50
b(Initialization)-45 3185 y(#)-45 3284 y(ODIR="$HUMUS/$CHR/sgp+/$XID")
45 b(;)-45 3384 y(#)-45 3484 y(CheckDirs)k($ODIR)f(;)-45
3583 y(for)i(c)f(in)h(hsp-sr)e(out)i(gff)f(gtf2)g(cds)g(prot)g(logs)g
(tmp)h(;)155 3683 y(do)f({)h(CheckDirs)e($ODIR/$c)g(;)i(})f(;)h(done)f
(;)-45 3782 y(#)-128 4078 y FD(6.4.1)92 b(Re-scoring)25
b(SRs)p Black Black -420 4239 a Fq(25b)181 b Fp(h)p FI(SGP:)41
b Fq(17c)p Fp(i)q Fo(+)p Ft(\021)-45 4339 y Fu(#)-45
4438 y(#)50 b(Re-scoring)e(SRs)h(to)h(produce)e(HSP-SRs)-45
4538 y(#)-45 4638 y(IDIR="$HUMUS/$CHR/tblastx+/$XID/sr")c(;)-45
4737 y(ODIR="$HUMUS/$CHR/sgp+/$XID/hsp-sr")g(;)-45 4837
y(#)-45 4936 y($BIN/getHSPSR.pl)j($CHR)i(<)h($IDIR/$CHR.merged.gff)c
(\\)1051 5036 y(>)k($ODIR/$CHR.gff)d(2>)j($ODIR.report)d(;)-45
5136 y(#)-128 5431 y FD(6.4.2)92 b(Pr)n(eparing)24 b(auxiliarly)i
(\002les)p Black Black -415 5592 a Fq(25c)180 b Fp(h)p
FI(SGP:)41 b Fq(17c)p Fp(i)q Fo(+)p Ft(\021)-45 5692
y Fu(#)-45 5792 y(#)50 b(Preparing)e(auxiliarly)g(files:)h(CHR.termini)
-45 5891 y(#)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 26 31
26 30 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(6.4.)23 b Fx(Gene)h(Prediction:)40 b Fz(S)t(G)t(P)2235
b FG(26)p -128 -243 4016 9 v Black -45 35 a Fu
(ODIR="$HUMUS/$CHR/sgp+/$XID/tmp")44 b(;)-45 134 y
(SDIR="$HUMUS/$CHR/annotation/$HSAPID")f(;)-45 234 y(#)-45
334 y(perl)50 b(-e)f(')55 433 y(use)g(strict;)55 533
y(my)h($chr)f(=)g(shift)g(@ARGV;)55 632 y(my)h(\045SEQlen;)55
732 y(my)g($seqln)e(=)i(shift)f(@ARGV;)55 832 y(open\(FRGLEN,)f("<)h
($seqln"\);)55 931 y(while)g(\(<FRGLEN>\))f({)254 1031
y(next)h(if)h(/^#/o;)254 1131 y(next)f(if)h(/^\\s*$/o;)254
1230 y(chomp;)254 1330 y(my)g(@l)f(=)h(split)f(/\\s+/og,)f($_;)254
1429 y($SEQlen{$l[0]})g(=)h($l[1];)55 1529 y(};)h(#)f(while)55
1629 y(close\(FRGLEN\);)55 1728 y(print)g(STDOUT)g(join\("\\t",)f
($chr,)g(qw/)i(force)f(cap)99 b(-2)g(0)50 b(.)f(+)h(0)f(/)h(\)."\\n";)
55 1828 y(print)f(STDOUT)g(join\("\\t",)f($chr,)g(qw/)i(force)f(poly)g
(/,)1151 1928 y(\($SEQlen{$chr})e(-)j(1\))f(x)h(2,)f(qw/)h(.)f(+)h(0/)f
(\)."\\n";)-45 2027 y(')h($CHR)f($SDIR/length)f(>)h($ODIR/$CHR.termini)
e(;)-45 2127 y(#)-128 2423 y FD(6.4.3)92 b(Running)23
b FA(S)t(G)t(P)k FD(\()p Fr(geneid)20 b FD(with)j(homology\))p
Black Black -415 2584 a Fq(26a)180 b Fp(h)p FI(SGP:)41
b Fq(17c)p Fp(i)q Fo(+)p Ft(\021)-45 2683 y Fu(#)-45
2783 y(#)50 b(Running)f(geneid)f(with)h(homology)-45
2882 y(#)-45 2982 y(SGP2="/projects/sgp/src/geneid_v1.1-sg)o(p")44
b(;)205 3082 y(#)49 b(binaries,)f(scripts)h(and)g(params)g(in)g(SGP2)
-45 3181 y(GENEID="$SGP2/bin/geneid")d(;)j(#)h(geneid)f(v1.1-sgp)-45
3281 y(PARAM="$SGP2/param/human3iso.param.sgp)o(")44
b(;)-45 3381 y(EW=0)50 b(;)f(#)h(add)f(to)g(exon)h(weigth)-45
3480 y(#)-45 3580 y(#)g(ISEQ="$HSAP/chromFaMasked/$CHRNUM/$C)o(HR.fa)o
(.mask)o(ed")44 b(;)-45 3679 y(#->)50 b(we)f(do)h(not)f(run)g(geneid)g
(on)g(masked)g(sequences)f(at)h(this)h(moment)-45 3779
y(#->)g(we)f(are)g(using)g(original)g(un-masked)f(fasta)h(sequences)f
(from)h(GP)-45 3879 y(ISEQ="$HSAP/chromosomes/$CHR.fa")44
b(;)-45 3978 y(IDIR="$HUMUS/$CHR/sgp+/$XID/")h(;)-45
4078 y(#)50 b(ODIR="$HUMUS/$CHR/sgp/$XID/out")44 b(;)-45
4178 y(HOMOLOGY="$HUMUS/$CHR/sgp+/$XID/hsp-sr)o(/$CHR)o(.gff")f(;)-45
4277 y(#)-45 4377 y(#)50 b({)55 4476 y({)g($GENEID)e(-v)i(-DE)f($EW)g
(-P)h($PARAM)e(-S)i($HOMOLOGY)e(\\)354 4576 y(-R)h
($IDIR/tmp/$CHR.termini)d($ISEQ)j(|)h(grep)f(-v)g(evidence)f(\\)354
4676 y(>)i($IDIR/out/$CHR)d(;)55 4775 y(})j(2>)f($IDIR/logs/$CHR)e(;)
-45 4875 y(#)150 b(})49 b(2>&1)g(|)h(tee)f
($HUMUS/logs/geneid_sgp.$locus)c(;)-45 4975 y(#)-128
5270 y FD(6.4.4)92 b(Pr)n(ocessing)25 b(output)e(f)n(or)i
FA(S)t(G)t(P)i FD(\(with)c(homology\))p Black Black -420
5431 a Fq(26b)181 b Fp(h)p FI(SGP:)41 b Fq(17c)p Fp(i)q
Fo(+)p Ft(\021)-45 5531 y Fu(#)-45 5631 y(#)50 b(Processing)e(geneid)h
(format)f(from)h(sgp)h(output)e(\(with)h(homology\))-45
5730 y(#)-45 5830 y(IDIR="$HUMUS/$CHR/sgp+/$XID")c(;)-45
5929 y(#)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 27 32
27 31 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(6.4.)23 b Fx(Gene)h(Prediction:)40 b Fz(S)t(G)t(P)2235
b FG(27)p -128 -243 4016 9 v Black -45 35 a Fu(geneid_raw2GFF)48
b($IDIR)h($IDIR/out/$CHR)e(;)-45 134 y(#)-45 234 y(ls)j(-1)f
($IDIR/gff/)f(|)i(egrep)f("^$CHR")f(|)i(\\)55 334 y(while)f(read)g(n;)
155 433 y(do)g({)404 533 y(cat)g($IDIR/gff/$n;)304 632
y(};)155 732 y(done)g(|)g(sort)g(+3n)h(+4n)f(-5)g(-)h(>)g
($IDIR/gff/$CHR)d(;)-45 832 y(#)-45 931 y(get_geneid_genes)g
($IDIR/gff/$CHR)g(>)j($IDIR/out.gene_list)c(;)-45 1031
y(#)-128 1327 y FD(6.4.5)92 b(Ev)o(aluation)24 b(of)i
FA(S)t(G)t(P)g FD(pr)n(edictions)f(\(with)e(homology\))p
Black Black -382 1488 a Fq(27)180 b Fp(h)p FI(SGP:)41
b Fq(17c)p Fp(i)q Fo(+)p Ft(\021)-45 1587 y Fu(#)-45
1687 y(#)50 b(Evaluation)e(of)h(SGP)h(predictions)d(\(with)i
(homology\))-45 1787 y(#)-45 1886 y(IDIR="$HUMUS/$CHR/sgp+/$XID")c(;)
-45 1986 y(#)-45 2085 y(#)p Black -128 6076 V -128 6180
a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 28 33
28 32 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(7.)23 b(V)-5 b(isualizing)26 b(results)2423 b(28)p
-128 -243 4016 9 v Black -128 35 a FM(7)120 b(V)l(isualizing)31
b(r)n(esults)p Black Black -415 228 a Fq(28a)180 b Fp(h)p
FI(JOBheader:)19 b(V)-6 b(isualizing)19 b(Results)i(with)g(Apollo)e
Fq(28a)p Fp(i)q Ft(\021)-45 328 y Fu
(####>#########>#######################)o(<####)o(#####)o(######)o
(#####)o(######)o(#####)o(#####)o(####<#)-45 428 y(#>#)50
b(JOB_ID)198 b(APOLLO_VIEWER)-45 527 y(#>#)50 b(JOB_DESC)98
b(Preparing)48 b(all)h(the)g(files)g(required)g(to)g(show)g(the)g
(results)g(on)g(the)h(Apollo)-45 627 y(#>#)398 b(:)100
b(genomic)48 b(annotations)g(browser.)g(Apollo)h(is)h(a)f
(collaborative)f(project)-45 727 y(#>#)398 b(:)100 b(between)48
b(the)i(Berkeley)e(Drosophila)g(Genome)h(Project)f(\(www.bdgp.org\))f
(and)-45 826 y(#>#)398 b(:)100 b(Ensembl)48 b(\(www.ensembl.org\).)-45
926 y(#>#)398 b(:)100 b(URL:)49 b(http://www.ensembl.org/apollo/)-45
1025 y(#>#)h(JOB_PATH)98 b(apollo)-45 1125 y(#>#)50 b(JOB_XID)148
b(20020225)-45 1225 y(#>#)50 b(JOB_FILE)98 b(${LIBSTEP}/apollo.job)-45
1324 y(#>#)50 b(END_OF_JOB)e(#################################)o
(######)o(#####)o(######)o(#####)o(#####)o(######)p Black
Black -420 1519 a Fq(28b)181 b Fp(h)p FI(JOBS:)20 b(V)-6
b(isualizing)19 b(Results)i(with)g(Apollo)e Fq(28b)p
Fp(i)q Ft(\021)-45 1618 y Fp(h)p FI(STEPS\(Apollo)f(Br)l(owser\):)42
b Fq(28c)p Fp(i)-128 1914 y FL(7.1)100 b(V)l(isualizing)24
b(annotations)h(with)g Fd(A)n(pollo)-128 2088 y FD(7.1.1)92
b(Pr)n(eparing)24 b(GFF)e(\002les)h(f)n(or)h Fc(A)n(pollo)p
Black Black -415 2249 a Fq(28c)180 b Fp(h)p FI(STEPS\(Apollo)18
b(Br)l(owser\):)42 b Fq(28c)p Fp(i)q Ft(\021)p Black
Black -420 2444 a Fq(28d)181 b Fp(h)p FI(V)-6 b(isualizing:)40
b Fq(28d)p Fp(i)r Ft(\021)-45 2543 y Fu(#)-45 2643 y
(IDIR="$HUMUS/$CHR")47 b(;)-45 2742 y(ODIR="$IDIR/apollo")g(;)-45
2842 y(#)-45 2942 y(CheckDirs)i($ODIR)f($ODIR/$XID)g(;)-45
3041 y(#)-45 3141 y(ODIR="$ODIR/$XID")f(;)-45 3241 y(#)-45
3340 y(gawk)j('BEGIN{OFS="\\t"})254 3440 y($1)g(!~)f(/^\\#|^[)g
(\\t]*$/)f({)454 3539 y($6=1;)454 3639 y(print)g
($1,$2,$3,$4,$5,$6,$7,$8,$9;)254 3739 y(})205 3838 y(')h
($IDIR/annotation/$HSAPID/gaps/${CHR})o(.gff)43 b(\\)205
3938 y(>)49 b($ODIR/${CHR}_gaps.gff)d(;)-45 4038 y(#)-45
4137 y(gawk)k('BEGIN{OFS="\\t"})254 4237 y($1)g(!~)f(/^\\#|^[)g
(\\t]*$/)f({)454 4336 y(print)g($1,$2,$3,$4,$5,$6,$7,$8,$9;)254
4436 y(})205 4536 y(')h($IDIR/annotation/$HSAPID/repeats/${C)o(HR}.g)o
(ff)44 b(\\)205 4635 y(>)49 b($ODIR/${CHR}_repeats.gff)c(;)-45
4735 y(#)-45 4835 y(gawk)50 b('BEGIN{OFS="\\t"})254 4934
y($1)g(!~)f(/^\\#|^[)g(\\t]*$/)f({)454 5034 y($3="exon";)g($6=1;)g
(print)h($0;)254 5133 y(})205 5233 y(')g
($IDIR/annotation/$HSAPID/refseq/${CH)o(R}.gf)o(f)44
b(\\)205 5333 y(>)49 b($ODIR/${CHR}_refseq.gff)d(;)-45
5432 y(#)-45 5532 y(gawk)k('BEGIN{OFS="\\t"})254 5632
y($1)g(!~)f(/^\\#|^[)g(\\t]*$/)f({)454 5731 y($3="exon";)454
5831 y($6=1;)454 5930 y(gsub\(/ENST0+/,"ENST",$9\);)p
Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o
(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)
1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 29 34
29 33 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(7.1.)23 b Fx(V)-5 b(isualizing)26 b(annotations)h(with)c(Apollo)
1713 b FG(29)p -128 -243 4016 9 v Black 454 35 a Fu(print)48
b($0;)254 134 y(})205 234 y(')h($IDIR/annotation/$HSAPID/ensembl/${C)o
(HR}.g)o(ff)44 b(\\)205 334 y(>)49 b($ODIR/${CHR}_ensembl.gff)c(;)-45
433 y(#)-45 533 y(gawk)50 b('BEGIN{OFS="\\t"})254 632
y($1)g(!~)f(/^\\#|^[)g(\\t]*$/)f({)454 732 y($3="exon";)g($6=1;)g
(print)h($0;)254 832 y(})205 931 y(')g
($IDIR/annotation/$HSAPID/genscan/${C)o(HR}.g)o(ff)44
b(\\)205 1031 y(>)49 b($ODIR/${CHR}_genscan.gff)c(;)-45
1131 y(#)-45 1230 y(gawk)50 b('BEGIN{OFS="\\t"})254 1330
y($1)g(!~)f(/^\\#|^[)g(\\t]*$/)f({)454 1429 y($2="geneid";)454
1529 y($3="exon";)454 1629 y(gsub\(/chr.*_/,"",$9\);)454
1728 y(print)g($0;)254 1828 y(})205 1928 y(')h
($IDIR/geneid/$XID/gff/${CHR})c(\\)205 2027 y(>)k
($ODIR/${CHR}_geneid.gff)d(;)-45 2127 y(#)-45 2227 y(gawk)k
('BEGIN{OFS="\\t"})254 2326 y($1)g(!~)f(/^\\#|^[)g(\\t]*$/)f({)454
2426 y($2="homology";)454 2525 y($3="hsp-sr";)454 2625
y($8=".";)454 2725 y(print)g($0;)254 2824 y(})205 2924
y(')h($IDIR/sgp/20020122/hsp-sr/${CHR}.gff)43 b(\\)205
3024 y(>)49 b($ODIR/${CHR}_hsp-sr.gff)d(;)-45 3123 y(#)-45
3223 y(gawk)k('BEGIN{OFS="\\t"})254 3322 y($1)g(!~)f(/^\\#|^[)g
(\\t]*$/)f({)454 3422 y($2="sgp";)454 3522 y($3="exon";)454
3621 y(gsub\(/chr.*_/,"",$9\);)454 3721 y(print)g($0;)254
3821 y(})205 3920 y(')h($IDIR/sgp/20020122/gff/${CHR})c(\\)205
4020 y(>)k($ODIR/${CHR}_sgp.gff)d(;)-45 4119 y(#)-45
4219 y(gawk)k('BEGIN{OFS="\\t"})254 4319 y($1)g(!~)f(/^\\#|^[)g
(\\t]*$/)f({)454 4418 y($2="homology+";)454 4518 y($3="hsp-sr";)454
4618 y($8=".";)454 4717 y(print)g($0;)254 4817 y(})205
4916 y(')h($IDIR/sgp+/20020212/hsp-sr/${CHR}.gf)o(f)44
b(\\)205 5016 y(>)49 b($ODIR/${CHR}_hsp-sr+.gff)c(;)-45
5116 y(#)-45 5215 y(gawk)50 b('BEGIN{OFS="\\t"})254 5315
y($1)g(!~)f(/^\\#|^[)g(\\t]*$/)f({)454 5415 y($2="sgp+";)454
5514 y($3="exon";)454 5614 y(gsub\(/chr.*_/,"",$9\);)454
5713 y(print)g($0;)254 5813 y(})205 5913 y(')h
($IDIR/sgp+/20020212/gff/${CHR})44 b(\\)p Black -128
6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)
282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 30 35
30 34 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(7.1.)23 b Fx(V)-5 b(isualizing)26 b(annotations)h(with)c(Apollo)
1713 b FG(30)p -128 -243 4016 9 v Black 205 35 a Fu(>)49
b($ODIR/${CHR}_sgp+.gff)d(;)-45 134 y(#)-45 234 y(cat)k
($ODIR/${CHR}_gaps.gff)195 b(\\)155 334 y($ODIR/${CHR}_repeats.gff)45
b(\\)155 433 y($ODIR/${CHR}_refseq.gff)95 b(\\)155 533
y($ODIR/${CHR}_ensembl.gff)45 b(\\)155 632 y($ODIR/${CHR}_genscan.gff)g
(\\)155 732 y($ODIR/${CHR}_geneid.gff)95 b(\\)155 832
y($ODIR/${CHR}_hsp-sr.gff)g(\\)155 931 y($ODIR/${CHR}_sgp.gff)245
b(\\)155 1031 y($ODIR/${CHR}_hsp-sr+.gff)45 b(\\)155
1131 y($ODIR/${CHR}_sgp+.gff)195 b(\\)55 1230 y(>)50
b($ODIR/all_${CHR}.gff)-45 1330 y(#)p Black -128 6076
V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 31 36
31 35 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(A.)22 b(Auxiliarly)k(Perl)d(Scripts)2258 b(31)p
-128 -243 4016 9 v Black -128 35 a FM(A)120 b(A)-6 b(uxiliarly)31
b(P)n(erl)f(Scripts)-128 245 y FL(A.1)100 b(Annotation)25
b(phase)-128 419 y FD(A.1.1)91 b(Scripts:)30 b(r)n(etrie)o(ving)25
b(sequence)e(names)g(and)g(nucleotide)g(composition)p
Black Black -415 580 a Fq(31a)180 b Fp(h)p FI(tangling:)19
b(perl)h(scripts)i Fq(31a)p Fp(i)q Ft(\021)-45 680 y
Fu(notangle)49 b(-R"getfastadesc.pl")d($WORK/$nwfile.nw)h(|)i(cpif)h
($BIN/getfastadesc.pl)c(;)-45 780 y(is_exec)j($BIN/getfastadesc.pl)d(;)
p Black Black -420 979 a Fq(31b)181 b Fp(h)p FI(g)o(etfastadesc.pl)19
b Fq(31b)p Fp(i)r Ft(\021)-45 1078 y Fp(h)p FI(PERL)i(shebang)d
Fq(83a)p Fp(i)-45 1178 y Fu(#)50 b(getfastadesc.pl)-45
1278 y(#)-45 1377 y(#)g(USAGE:)-45 1477 y(#)150 b(getfastadesc.pl)47
b(chr_list.file)g(fasta_files.dir)g(>)j(chr_seqs.list)-45
1577 y(#)-45 1676 y(#)g([chr_seqs.list])d(->)j(chr_id)e(seq_id)h
(length)g(date_file)f(description)-45 1776 y(#)-45 1875
y(use)i(strict;)-45 1975 y(#)-45 2075 y(use)g(global;)-45
2174 y(#)-45 2274 y(#)g(VARS)-45 2374 y($PROG)f(=)h('getfastadesc.pl';)
-45 2473 y(my)g(\($chrlistfile,$ipath\))c(=)j(@ARGV;)-45
2573 y($ipath)g(=~)h(s\045/$\045\045o;)-45 2672 y(my)g
(\(@files,\045seqs,@order\);)-45 2772 y(@files)f(=)h(\(\);)-45
2872 y(\045seqs)f(=)h(\(\);)-45 2971 y(@order)f(=)h(\(\);)-45
3071 y(#)-45 3171 y(#)g(MAIN)-45 3270 y(&program_started\($PROG\);)-45
3469 y(&load_chr_tbl\(\);)-45 3569 y(&get_file_names\(\);)-45
3669 y(&parse_fasta_seqs\(\);)-45 3768 y(&output_results\(\);)-45
3968 y(&program_finished\($PROG\);)-45 4067 y(exit\(0\);)-45
4266 y(#)-45 4366 y(#)g(SUBS)-45 4466 y(sub)g(load_chr_tbl\(\))d({)155
4565 y(open\(CHR,"<)g($chrlistfile"\);)155 4665 y(while)i(\(<CHR>\))f
({)354 4765 y(my)h($chr;)354 4864 y(next)g(if)g(/^#/o;)354
4964 y(next)g(if)g(/^\\s*$/o;)354 5063 y(chomp;)354 5163
y(s/^\\s+//o;)354 5263 y(s/\\s+$//o;)354 5362 y(\($chr,undef\))f(=)h
(split)g(/\\s+/og,)f($_,)i(2;)354 5462 y(push)f(@order,)g($chr;)354
5562 y(@{)g($seqs{$chr})f(})i(=)f(\(\);)155 5661 y(};)g(#)h(while)155
5761 y(close\(CHR\);)-45 5861 y(})g(#)g(load_chr_tbl)p
Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o
(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)
1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 32 37
32 36 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(A.1.)22 b Fx(Annotation)k(phase)2370 b FG(32)p -128
-243 4016 9 v Black -45 134 a Fu(sub)50 b(get_file_names\(\))d({)155
234 y(opendir\(FA,)g($ipath\);)155 334 y(@files)h(=)i(grep)f({)h
(/\\.fa$/)e(})i(readdir\(FA\);)155 433 y(closedir\(FA\);)-45
533 y(})g(#)g(get_file_names)-45 732 y(#)-45 832 y(#)g(we)g(are)f
(going)g(to)g(assume)g(that)g(input)g(filenames)-45 931
y(#)h(have)f(the)g(following)g("chr"$chr"\(.*\).fa")d(\(so)j(we)h(can)f
(assign)-45 1031 y(#)h("automagically")d(which)i(sequence)f(correspond)
g(to)i(each)f(chromosome\))-45 1131 y(#)h(without)f(having)f(to)i(set)f
(a)h(table)e(with)i(the)f(files)g(corresponding)e(to)j(each)f
(chromosome)-45 1230 y(#)-45 1330 y(sub)h(parse_fasta_seqs\(\))c({)155
1429 y(foreach)i(my)i($fl)f(\(@files\))f({)354 1529 y(my)h
(\($thechr,$modtime,$ct,$cc,$go,@length)o(s\);)354 1629
y(\($thechr\))f(=)i(uc\($fl\))e(=~)i(/^CHR\([\\d]+|[XY]|NA|UL\)/o;)354
1728 y($fl)f(=)h("$ipath/$fl";)354 1828 y(open\(FAF,"<)e($fl"\))h(||)g
(do)g({)553 1928 y(print)g(STDERR)g("###)g(Cannot)g(open)g(file)g
(\\"$fl\\")f(for)h(chr)h(\\"$thechr\\"...\\n";)553 2027
y(next;)354 2127 y(};)354 2227 y(print)f(STDERR)g("###)g(Working)f(on)i
(chr)f(\\"$thechr\\")f(file:)g(\\"$fl\\"\\n";)354 2326
y($modtime)g(=)i(&get_fh_mod_date\(\\*FAF\);)354 2426
y($ct)f(=)h(0;)354 2525 y($cc)f(=)h(".";)354 2625 y($go)f(=)h($F;)354
2725 y(@lengths)e(=)i(\(\);)354 2824 y(while)f(\(<FAF>\))f({)553
2924 y(my)i(\($id,$desc\);)553 3024 y(next)f(if)h(/^\\s*$/o;)553
3123 y(chomp;)553 3223 y(m/^>/o)f(&&)g(do)h({)752 3322
y($go)g(=)f($T;)752 3422 y(print)g(STDERR)g("X";)752
3522 y(&add_lengths_to_hash\(\\@lengths,\\@{)44 b($seqs{$thechr})j
(}\);)752 3621 y(\($id,$desc\))h(=)i(split)f(/\\s+/og,)f($_,)h(2;)752
3721 y($id)h(=~)f(s/^>//o;)752 3821 y(defined\($desc\))f(||)h(\($desc)g
(=)g("."\);)752 3920 y(push)h(@{)f($seqs{$thechr})e(},)j([)f($id,)g
(undef,)g($modtime,)f($desc)h(];)752 4020 y(next;)553
4119 y(};)553 4219 y($go)g(&&)h(do)f({)h
(&add_to_seq_length\($_,\\@lengths\);)44 b(};)354 4319
y(})50 b(continue)e({)553 4418 y($ct++;)553 4518 y(\($ct\04510)h(==)g
(0\))h(&&)f(\(print)g(STDERR)f("$cc"\);)553 4618 y(\($ct\0451000)g(==)i
(0\))f(&&)h(\(print)e(STDERR)h(")h([$ct]\\n"\);)354 4717
y(};)f(#)h(while)f(<FAF>)354 4817 y(\($ct\0451000)f(!=)i(0\))f(&&)g
(\(print)g(STDERR)g(")g([$ct]\\n"\);)354 4916 y
(&add_lengths_to_hash\(\\@lengths,\\@{)43 b($seqs{$thechr})48
b(}\);)354 5016 y(close\(FAF\);)155 5116 y(};)h(#)h(foreach)e($fl)-45
5215 y(})i(#)g(parse_fasta_seqs)-45 5315 y(#)100 b(print)49
b(STDERR)f("#\\n#)h($chr)g(has)h(".\(scalar)e(@files\).")g(fragments)g
(\(files\)\\n#\\n#)f(".)-45 5415 y(#)648 b(\(sprintf\("\04512s)47
b(\04512s)i(\0458s)g(\0458s)h(\04510s)98 b(\045s\\n",)-45
5514 y(#)1096 b("begin","end","#seqs","#errors","ran)o(d","fi)o
(le"\)\))o(;)-45 5713 y(sub)50 b(get_fh_mod_date\(\))c({)155
5813 y(my)j($fh)g(=)h(shift;)155 5913 y(my)f
(\($year,$month,$day,$hour,$min,$sec\);)p Black -128
6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)
282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 33 38
33 37 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(A.1.)22 b Fx(Annotation)k(phase)2370 b FG(33)p -128
-243 4016 9 v Black 155 35 a Fu(\($year,$month,$day,$hour,$min,$sec)o
(\))44 b(=)553 134 y(\(localtime\(\(stat)j($fh\)[9]\)\)[5,4,3,2,1,0];)
155 234 y(#)i(stat)g(->)100 b([8])49 b(is)g(access)g(date,)155
334 y(#)498 b([9])49 b(is)g(modif)g(date)g(and)155 433
y(#)448 b([10])49 b(is)g(inode)g(change)g(date)155 533
y(return)f(sprintf\("\04504d\04502d\04502d\04502d\04502d\04502d",)902
632 y($year)h(+)g(1900,$month)f(+)i(1,$day,$hour,$min,$sec\);)-45
732 y(})g(#)g(get_fh_mod_date)-45 931 y(sub)g(add_lengths_to_hash\(\))c
({)155 1031 y(my)j(\($ref,$hsh\))f(=)i(@_;)155 1131 y
(\(scalar\(@{$ref}\))d(==)i(7\))g(&&)h(do)f({)354 1230
y($hsh->[$#{$hsh}][1])d(=)k($ref->[0];)354 1330 y($hsh->[$#{$hsh}][3])c
(=)k(sprintf\("A:\045d)d(T:\045d)i(G:\045d)g(C:\045d)g(N:\045d)h
(?:\045d)f(Desc:)f(",)1848 1429 y(@{$ref}[1..6]\).$hsh->[$#{$hsh}][3];)
354 1529 y(@{$ref})g(=)i(\(\);)155 1629 y(};)-45 1728
y(})g(#)g(add_lengths_to_hash)-45 1928 y(sub)g(add_to_seq_length\(\))c
({)155 2027 y(my)j(\($l,$a,$t,$g,$c,$n,$x\))d(=)j(\(0..6\);)155
2127 y(my)g(\($str,$ary\))f(=)i(@_;)155 2227 y(\(scalar\(@{$ary}\))d
(==)i(7\))g(||)h(do)f({)h(@{$ary})e(=)i(\(0\))f(x)h(7;)f(};)155
2326 y($str)g(=)g(uc\($str\);)155 2426 y($str)g(=~)g(s/^\\s+//o;)155
2525 y($str)g(=~)g(s/\\s+$//o;)155 2625 y($ary->[$l])f(+=)h
(length\($str\);)155 2725 y($ary->[$a])f(+=)h(scalar\($str)f(=~)h
(s/A//og\);)155 2824 y($ary->[$t])f(+=)h(scalar\($str)f(=~)h
(s/T//og\);)155 2924 y($ary->[$g])f(+=)h(scalar\($str)f(=~)h
(s/G//og\);)155 3024 y($ary->[$c])f(+=)h(scalar\($str)f(=~)h
(s/C//og\);)155 3123 y($ary->[$n])f(+=)h(scalar\($str)f(=~)h
(s/N//og\);)155 3223 y($ary->[$x])f(+=)h(length\($str\))f(>)h(0)h(?)g
(length\($str\))d(:)j(0;)-45 3322 y(})g(#)g(add_to_seq_length)-45
3522 y(sub)g(output_results\(\))d({)155 3621 y(foreach)h(my)i($cs)f
(\(@order\))f({)354 3721 y(defined\($seqs{$cs}\))e(||)k(do)f({)553
3821 y(print)g(STDERR)g("##)g(No)g(sequences)g(found)f(for)i
(chromosome)e($cs)h(!!!\\n";)553 3920 y(next;)354 4020
y(};)354 4119 y(scalar\(@{)f($seqs{$cs})g(}\))h(>)h(1)g(&&)f(do)h({)553
4219 y(@{)g($seqs{$cs})e(})h(=)h(map)f({)h($_->[1])e(})1450
4319 y(sort)h({)h($a->[0])e(cmp)h($b->[0])g(})g(#)h(ascending)e(alpha)h
(sort)1450 4418 y(map)g({)h([)f($_->[0],)g($_)g(])h(})f(@{)h
($seqs{$cs})e(};)354 4518 y(};)354 4618 y(foreach)g(my)i($sq)f(\(@{)g
($seqs{$cs})f(}\))i({)553 4717 y(\(defined\($sq->[2]\))d(&&)i($sq->[2])
f(>)i(0\))f(||)h(do)f({)752 4817 y(print)g(STDERR)g("##)g(Chromosome)f
($cs:)h(".)1400 4916 y("Sequence)f($sq->[0])g(has)i(zero)f(length)g
(!!!\\n";)752 5016 y(next;)553 5116 y(};)553 5215 y(print)g(STDOUT)g
("$cs)g(@{$sq}\\n";)354 5315 y(};)g(#)h(foreach)f($sq)155
5415 y(};)g(#)h(foreach)e($cs)-45 5514 y(})i(#)g(output_results)p
Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o
(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)
1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 34 39
34 38 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(A.1.)22 b Fx(Annotation)k(phase)2370 b FG(34)p -128
-243 4016 9 v Black -128 35 a FD(A.1.2)91 b(Scripts:)30
b(Pr)n(ocessing)25 b(Golden)d(P)o(ath)h(annotation)p
Black Black -415 196 a Fq(34a)180 b Fp(h)p FI(tangling:)19
b(perl)h(scripts)i Fq(31a)p Fp(i)q Fo(+)o Ft(\021)-45
295 y Fu(notangle)49 b(-R"gp2gff.pl")e($WORK/$nwfile.nw)g(|)j(cpif)f
($BIN/gp2gff.pl)e(;)-45 395 y(is_exec)i($BIN/gp2gff.pl)e(;)p
Black Black -420 594 a Fq(34b)181 b Fp(h)p FI(gp2gf)o(f)o(.pl)18
b Fq(34b)p Fp(i)r Ft(\021)-45 694 y Fp(h)p FI(PERL)j(shebang)d
Fq(83a)p Fp(i)-45 793 y Fu(#)50 b(Transforms)e(the)h(goldenpath)f
(format)h(to)g(gff)h(file)-45 893 y(#)150 b(retrieving)48
b(gene\(mrna\)/utr/cds)e(coordinates.)-45 993 y(#)-45
1092 y(#)k(USAGE:)f(gp2gff.pl)f("chrname")g("source")g(goldenpath_file)
f(>)j(stdout)-45 1192 y(#)-45 1292 y Fp(h)p FI(PERL)21
b(strict)g(pr)o(a)o(gma)e(+)i(info)f Fq(83b)p Fp(i)-45
1391 y Fu(my)50 b($PROG)f(=)g('gp2gff.pl';)-45 1491 y(#)-45
1590 y(use)h(Getopt::Long;)-45 1690 y(Getopt::Long::Configure)c(qw/)j
(bundling)g(/;)-45 1889 y(my)h(\($overlap,$exon_ori_fix,$exon_end_f)o
(ix\))44 b(=)49 b(\(0,0,0\);)-45 1989 y($SIG{__WARN__})f(=)h(sub)h({)
1101 2089 y(print)f(STDERR)g("###)g(UNKNOWN)f(COMMAND-LINE)g(OPTION:)g
($_[0]\\n";)1002 2188 y(};)-45 2288 y(GetOptions\()503
2387 y('no-overlap')397 b(=>)49 b(\\$overlap,)503 2487
y('exonori-nuclfix=i')e(=>)i(\\$exon_ori_fix,)503 2587
y('exonend-nuclfix=i')e(=>)i(\\$exon_end_fix,)503 2686
y(\))h(||)f(do)h({)703 2786 y(print)f(STDERR)f("###)h(ERROR)g(when)g
(PARSING)g(ARGUMENTS\\n";)703 2886 y(exit\(1\);)503 2985
y(};)-45 3085 y($SIG{__WARN__})f(=)h('DEFAULT';)-45 3284
y(my)h(\($seqname,$source,$ifile\))45 b(=)50 b(@ARGV;)-45
3384 y(my)g($c)f(=)h(0;)-45 3483 y(my)g(@exary;)-45 3583
y(my)g(\045laste)f(=)g(\(\);)-45 3782 y(open\(GPFILE,"<)f($ifile"\);)
-45 3882 y(while)h(\(<GPFILE>\))f({)155 3982 y(next)h(if)g(/^#/o;)155
4081 y(next)g(if)g(/^\\s*$/o;)155 4181 y(chomp;)155 4280
y($c++)g(if)g(&process_gene\($_\);)-45 4380 y(};)-45
4480 y(close\(GPFILE\);)-45 4579 y(print)g(STDERR)g("###)g($c)h(genes)e
(for)i($seqname)e(were)h(found)g(in)g(\\"$ifile\\".\\n";)-45
4679 y(exit\(0\);)-45 4878 y(sub)h(process_gene\(\))d({)155
4978 y(my)i($rec)g(=)h(shift;)155 5077 y(my)f($maxrec)g(=)g(10;)h(#)f
(refseq)g(record)g(structure)155 5177 y(my)g
(\($gene,$seq,$strand,$mrna_ori,$mrna_)o(end,)354 5277
y($cds_ori,$cds_end,$exons_num,$exons)o(_ori,)o($exons)o(_end\))43
b(=)50 b(\(0..\($maxrec)d(-)j(1\)\);)155 5376 y(my)f
(\(@l,@o,@e,$frame,$cdso,$cdse\);)155 5476 y(@l)g(=)h(split)f
(/\\s+/og,)f($rec;)155 5576 y(\(\(scalar\(@l\))f(>=)j($maxrec\))e(&&)h
(\($l[$seq])g(eq)g($seqname\)\))f(||)h(return)g(0;)155
5675 y(@o)g(=)h(split)f(/,/og,)f($l[$exons_ori];)155
5775 y(@e)h(=)h(split)f(/,/og,)f($l[$exons_end];)155
5874 y(#)h(fixing)g(displacement)f(at)h(exon)g(coordinates)f(\(also)h
(at)g(mrna)g(and)h(cds)f(levels\))p Black -128 6076 V
-128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 35 40
35 39 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(A.1.)22 b Fx(Annotation)k(phase)2370 b FG(35)p -128
-243 4016 9 v Black 155 35 a Fu($exon_ori_fix)47 b(==)j(0)f(||)h(do)f
({)404 134 y($l[$mrna_ori])e(+=)j($exon_ori_fix;)404
234 y($l[$cds_ori])97 b(+=)50 b($exon_ori_fix;)404 334
y(@o)f(=)h(map)f({)h($_)f(+=)h($exon_ori_fix)d(})j(@o;)155
433 y(};)155 533 y($exon_end_fix)d(==)j(0)f(||)h(do)f({)404
632 y($l[$mrna_end])e(+=)j($exon_end_fix;)404 732 y($l[$cds_end])97
b(+=)50 b($exon_end_fix;)404 832 y(@e)f(=)h(map)f({)h($_)f(+=)h
($exon_end_fix)d(})j(@e;)155 931 y(};)155 1031 y(#)155
1131 y(\($cdso,$cdse\))d(=)j(@l[$cds_ori,$cds_end];)155
1230 y(#)f(checking)g(if)g(gene)g(overlaps)f(previous)h(one...)155
1330 y(#)149 b(\(we)49 b(assume)g(they)g(are)g(sorted)g(by)g
(acceptor\))155 1429 y($overlap)f(&&)h(do)h({)354 1529
y(defined\($laste{$l[$strand]}\))45 b(&&)k(do)g({)553
1629 y(\($laste{$l[$strand]})d(>)k($cdso\))f(&&)g(return)g(0;)354
1728 y(};)354 1828 y($laste{$l[$strand]})d(=)k($cdse;)155
1928 y(};)f(#)h($overlap)155 2027 y(#)155 2127 y
(&prt_gene\(@l[$mrna_ori,$mrna_end,$)o(stran)o(d,$ge)o(ne,$ex)o(ons_n)o
(um]\);)155 2227 y(@exary)e(=)i(\(\);)155 2326 y($frame)e(=)i(0;)155
2426 y(for)f(\(my)g($j)h(=)f(0;)h($j)f(<)h($l[$exons_num];)d($j++\))i
({)354 2525 y(my)g(\($ori,$end,$p\);)354 2625 y($p)g(=)h(\($l[$strand])
e(eq)h('-'\))g(?)h(\($l[$exons_num])d(-)i(\($j)h(+)f(1\)\))h(:)f($j;)
354 2725 y(\($ori,$end\))f(=)h(\($o[$p],$e[$p]\);)354
2824 y(\($end)g(<)g($cdso)g(||)h($ori)f(>)g($cdse\))g(&&)h(do)f({)553
2924 y(&prt_utr\($ori,$end,@l[$strand,$gene])o(\);)553
3024 y(next;)354 3123 y(};)354 3223 y(\($ori)g(<)g($cdso)99
b(&&)50 b($end)f(<=)g($cdse\))g(&&)g(do)h({)553 3322
y(&prt_utr\($ori,\($cdso)c(-)k(1\),@l[$strand,$gene]\);)553
3422 y($frame)f(=)h(&prt_exon\($cdso,$end,$frame,@l[$s)o(trand)o
(,$gene)o(],$cd)o(so,$c)o(dse\);)553 3522 y(&swap_items\(0\))d(if)j
(\($l[$strand])d(eq)j('-'\);)553 3621 y(next;)354 3721
y(};)354 3821 y(\($ori)f(>=)g($cdso)g(&&)h($end)f(>)g($cdse\))g(&&)g
(do)h({)553 3920 y($frame)f(=)h(&prt_exon\($ori,$cdse,$frame,@l[$s)o
(trand)o(,$gene)o(],$cd)o(so,$c)o(dse\);)553 4020 y(&prt_utr\(\($cdse)d
(+)j(1\),$end,@l[$strand,$gene]\);)553 4119 y(&swap_items\(0\))d(if)j
(\($l[$strand])d(eq)j('-'\);)553 4219 y(next;)354 4319
y(};)354 4418 y(\($ori)f(<)g($cdso)99 b(&&)50 b($end)f(>)g($cdse\))g
(&&)g(do)h({)553 4518 y(&prt_utr\($ori,\($cdso)c(-)k
(1\),@l[$strand,$gene]\);)553 4618 y($frame)f(=)h
(&prt_exon\($cdso,$cdse,$frame,@l[$)o(stran)o(d,$gen)o(e],$c)o(dso,$)o
(cdse\);)553 4717 y(&prt_utr\(\($cdse)d(+)j
(1\),$end,@l[$strand,$gene]\);)553 4817 y(&swap_items\(1\))d(if)j
(\($l[$strand])d(eq)j('-'\);)553 4916 y(next;)354 5016
y(};)354 5116 y($frame)f(=)g(&prt_exon\($ori,$end,$frame,@l[$strand)o
(,$gen)o(e],$cd)o(so,$c)o(dse\);)155 5215 y(};)155 5315
y(\($l[$strand])e(eq)j('-'\))f(&&)g(\(@exary)g(=)g(reverse)g(@exary\);)
155 5415 y(print)g(STDOUT)f(join\(\224,@exary\);)f(#)j(each)f(line)g
(already)g(has)g(its)g(own)g(linefeed)155 5514 y(return)f(1;)-45
5614 y(})i(#)g(process_gene)-45 5713 y(#)g(GFF:)f(seqname)g(source)f
(feat)h(start)g(end)h(score)e(strand)h(frame)g(group)-45
5813 y(sub)h(prt_gene\(\))e({)155 5913 y(my)h(@data)g(=)h(@_;)p
Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o
(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)
1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 36 41
36 40 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(A.2.)22 b Fx(Homology)j(search)g(phase)2135 b FG(36)p
-128 -243 4016 9 v Black 155 35 a Fu(print)49 b(STDOUT)f("#)i(Gene:)f
($data[3])148 b(Strand:)48 b($data[2])148 b(Exons:)49
b($data[4]\\n";)155 134 y(print)g(STDOUT)f
(join\("\\t",$seqname,$source,"mrna",@da)o(ta[0,)o(1],)1051
234 y(".",$data[2],".",$data[3]\)."\\n";)-45 334 y(})i(#)g(prt_gene)-45
433 y(sub)g(prt_utr\(\))e({)155 533 y(my)h(@data)g(=)h(@_;)155
632 y(push)f(@exary,)f(join\("\\t",$seqname,$source,"utr",@dat)o(a[0,1)
o(],)1051 732 y(".",$data[2],".",$data[3]\)."\\n";)-45
832 y(})i(#)g(prt_utr)-45 931 y(sub)g(prt_exon\(\))e({)155
1031 y(my)h(\($eo,$ee,$frm,$str,$grp,$co,$ce\))44 b(=)50
b(@_;)155 1131 y(my)f($feat;)-45 1230 y(#)249 b(my)50
b(\($myfrm,$feat\);)155 1330 y(#)f(remainder)f(=)i(\(\(exon_end)e(-)i
(exon_ori)e(+)i(1\))f(+)h(frame\))e(mod)i(3;)155 1429
y(#)f(nextframe)f(=)i(\(3)g(-)f(\(\(exon_end)f(-)i(exon_ori)e(+)i(1\))f
(+)h(frame\))e(mod)i(3\))f(mod3;)-45 1529 y(#)150 b($myfrm)48
b(=)i(\($str)f(eq)g('-'\))g(#)h(exon)f(frame)g(is)g(set)h(to)f
(remainder)f(for)i(-)f(strand)-45 1629 y(#)598 b(?)50
b(\()f(\(\($ee)g(-)h($eo)f(+)h(1\))f(+)h($frm\))f(\045)g(3)h(\))-45
1728 y(#)598 b(:)50 b($frm;)155 1828 y($feat)f(=)g
(&get_feat\($eo,$ee,$str,$co,$ce\);)-45 1928 y(#)150
b($feat)49 b(=~)g(/Single/io)f(&&)h(\($myfrm)g(=)h(0\);)f(#)g(single)g
(frame)g(hack)g(\(specially)f(for)h(-\))155 2027 y(push)g(@exary,)f
(join\("\\t",$seqname,$source,$feat,$eo,)o($ee,)1051
2127 y(".",$str,$frm,$grp\)."\\n";)-45 2227 y(#)1146
b(".",$str,$myfrm,$grp\)."\\n";)155 2326 y(return)48
b(\()i(\(3)f(-)h(\(\($ee)f(-)h($eo)f(+)g(1\))h(+)g($frm\))e(\045)i(3)g
(\))f(\045)h(3)g(\);)f(#)h(return)e(nextframe)-45 2426
y(})i(#)g(prt_exon)-45 2525 y(#)g(gene)f(structure)f(GFF-feature)g
(names)-45 2625 y(sub)i(get_feat\(\))e({)155 2725 y(my)h
(\($eo,$ee,$str,$co,$ce\))d(=)j(@_;)155 2824 y(my)g
(\($fts,$fto,$fti,$fte\);)155 2924 y(\($fts,$fto,$fti,$fte\))d(=)j
(\("Single","First","Internal","Termina)o(l"\);)155 3024
y($str)g(eq)g("-")g(&&)h(do)f({)354 3123 y(\($fto,$fte\))f(=)h
(\($fte,$fto\);)155 3223 y(};)155 3322 y(\($eo)g(==)g($co)g(&&)h($ee)f
(==)h($ce\))f(&&)g(return)g($fts;)155 3422 y(\($eo)g(==)g($co\))g(&&)h
(return)e($fto;)155 3522 y(\($ee)h(==)g($ce\))g(&&)h(return)e($fte;)155
3621 y(return)g($fti;)-45 3721 y(})i(#)g(get_feat)-45
3821 y(sub)g(swap_items\(\))d({)205 3920 y(shift)h(||)i(do)f({)404
4020 y(\($exary[$#exary],$exary[$#exary-1])o(\))44 b(=)603
4119 y(\($exary[$#exary-1],$exary[$#exary]\))o(;)404
4219 y(return;)205 4319 y(};)205 4418 y
(\($exary[$#exary],$exary[$#exary-1)o(],$ex)o(ary[$)o(#exary)o(-2]\))f
(=)404 4518 y(\($exary[$#exary-2],$exary[$#exary-)o(1],$e)o(xary[$)o
(#exar)o(y]\);)205 4618 y(return;)-45 4717 y(})50 b(#)g(swap_items)-128
5016 y FL(A.2)100 b(Homology)23 b(sear)n(ch)j(phase)-128
5190 y FD(A.2.1)91 b(Scripts:)30 b(V)-9 b(erifying)24
b(SBP)f FA(T)t(B)t(L)t(A)t(S)t(T)t(X)j FD(output)c(f)n(or)i(chr)n
(omosome)h(fragments)p Black Black -415 5351 a Fq(36a)180
b Fp(h)p FI(tangling:)19 b(perl)h(scripts)i Fq(31a)p
Fp(i)q Fo(+)o Ft(\021)-45 5451 y Fu(notangle)49 b
(-R"sbp-checkblastout.pl")c($WORK/$nwfile.nw)i(|)j(\\)205
5551 y(cpif)f($BIN/sbp_checkblastout.pl)c(;)-45 5650
y(is_exec)k($BIN/sbp_checkblastout.pl)c(;)p Black -128
6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)
282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 37 42
37 41 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(A.2.)22 b Fx(Homology)j(search)g(phase)2135 b FG(37)p
-128 -243 4016 9 v Black Black Black -420 35 a Fq(36b)181
b Fp(h)p FI(sbp-c)o(hec)n(kblastout.pl)17 b Fq(36b)p
Fp(i)r Ft(\021)-45 134 y Fp(h)p FI(PERL)k(shebang)d Fq(83a)p
Fp(i)-45 234 y Fu(#)50 b(Parsing)f(tblastx)f(files)h(from)g(SBP)g(to)h
(check)f(blast)f(output)-45 334 y(#)150 b(contents)48
b(for)h(each)g(fragment)g(of)g(the)g(broken)g(chromosomic)f(sequence)
-45 433 y(#)-45 533 y(#)i(USAGE:)f(sbp_checkblastout.pl)d("chrname")i
(input_dir)g(>)i(stdout.report)-45 632 y(#)-45 732 y
Fp(h)p FI(PERL)21 b(strict)g(pr)o(a)o(gma)e(+)i(info)f
Fq(83b)p Fp(i)-45 832 y Fu(my)50 b($PROG)f(=)g('sbp_checkblastout.pl';)
-45 931 y(#)-45 1031 y(my)h($chr)f(=)h(shift)e(@ARGV;)-45
1131 y(my)i($path)f(=)g(shift)g(@ARGV;)-45 1230 y(my)h(@files)f(=)g
(\(\);)-45 1330 y(my)h(\($c,$e,$z\);)-45 1429 y(opendir\(TBX,)e
($path\);)-45 1529 y(@files)h(=)h(map)f({)h([)f($_)h(,)802
1629 y(/^.*_\(\\d+\)_\(\\d+\)\(?:\\..*\)?$/o,)802 1728
y(\(/^.*_\(\\D+\)_.*$/o)d(||)i("-"\),)703 1828 y(])g(})404
1928 y(grep)g({)g(/^[^\\.]/)g(})g(readdir\(TBX\);)-45
2027 y(closedir\(TBX\);)-45 2127 y(@files)g(=)h(map)f({)h($_->[1])e(})
404 2227 y(sort)h({)g($a->[0])g(<=>)g($b->[0])g(})404
2326 y(map)g({)h([)f($_[0],)g($_)g(])h(})g(@files;)-45
2426 y(print)f(STDOUT)g("#\\n#)g($chr)g(has)g(".\(scalar)f(@files\).")g
(fragments)h(\(files\)\\n#\\n#)e(".)603 2525 y(\(sprintf\("\04512s)g
(\04512s)i(\0458s)h(\0458s)f(\04510s)99 b(\045s\\n",)1051
2625 y("begin","end","#seqs","#errors","rand)o(","fil)o(e"\)\);)-45
2725 y($z)50 b(=)g(0;)-45 2824 y(foreach)f(my)g($fl)h(\(@files\))e({)
155 2924 y(\($c,$e\))g(=)i(\(0,0\);)155 3024 y(my)f($fname)g(=)g
("$path/$fl->[0]";)155 3123 y(print)g(STDERR)f("#)i(Working)e(on)i
($fname\\n";)155 3223 y(open\(TBXFL,"<)d($fname"\);)155
3322 y(while)i(\(<TBXFL>\))f({)354 3422 y(/^>/o)148 b(&&)50
b(\($c++,next\);)354 3522 y(/EXIT/o)e(&&)i(\($e++\);)155
3621 y(};)f(#)h(while)155 3721 y($c)f(==)h(0)f(&&)h(\($z++\);)155
3821 y(close\(TBXFL\);)155 3920 y(printf)e(STDOUT)h(")100
b(\04512s)49 b(\04512s)g(\0458s)g(\0458s)g(\04510s)99
b(\045s\\n",)503 4020 y(\($fl->[1])49 b(+)g(1\),\($fl->[1])f(+)h
($fl->[2]\),$c,$e,$fl->[3],$fl->[0];)-45 4119 y(};)h(#)g(foreach)-45
4219 y(print)f(STDOUT)g("#)g($chr)h(ran)f(into)g(".\(scalar)f
(@files\).)603 4319 y(")i(fragments,)e($z)h(of)g(which)g(having)g(NO)g
(HSPs.\\n";)-45 4418 y(#)-45 4518 y(exit\(0\);)-128 4814
y FD(A.2.2)91 b(Scripts:)30 b(P)o(arsing)23 b(SBP)h FA(T)t(B)t(L)t(A)t
(S)t(T)t(X)h FD(output)e(to)g(GFF)p Black Black -415
4975 a Fq(37a)180 b Fp(h)p FI(tangling:)19 b(perl)h(scripts)i
Fq(31a)p Fp(i)q Fo(+)o Ft(\021)-45 5074 y Fu(notangle)49
b(-R"sbp-blast2gff.pl")d($WORK/$nwfile.nw)h(|)i(\\)205
5174 y(cpif)g($BIN/sbp_blast2gff.pl)c(;)-45 5273 y(is_exec)k
($BIN/sbp_blast2gff.pl)d(;)p Black Black -420 5473 a
Fq(37b)181 b Fp(h)p FI(sbp-blast2gf)o(f)o(.pl)18 b Fq(37b)p
Fp(i)q Ft(\021)-45 5572 y Fp(h)p FI(PERL)j(shebang)d
Fq(83a)p Fp(i)-45 5672 y Fu(#)50 b(Parsing)f(tblastx)f(files)h(from)g
(SBP)g(to)h(get)f(HSPs)g(in)g(GFF)h(format)-45 5772 y(#)-45
5871 y(#)g(USAGE:)f(sbp_blast2gff.pl)e("chrname")h(length_file)f
(input_dir)i(\\)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 38 43
38 42 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(A.2.)22 b Fx(Homology)j(search)g(phase)2135 b FG(38)p
-128 -243 4016 9 v Black -45 35 a Fu(#)1295 b(>)50 b(gff_output)98
b(2>)49 b(stdout.report)-45 134 y(#)-45 234 y Fp(h)p
FI(PERL)21 b(strict)g(pr)o(a)o(gma)e(+)i(info)f Fq(83b)p
Fp(i)-45 334 y Fu(my)50 b($PROG)f(=)g('sbp_blast2gff.pl';)-45
433 y(#)-45 533 y(my)h(\($seq,$src,$ftr,$ori,$end,$sco,$str)o(,$frm)o
(\))44 b(=)50 b(\(0..7\);)-45 632 y(my)g(@frame)f(=)g(\()h(3,)f(1,)h(2)
f(\);)h(#)f(frm)h(0)f(->)h(blastfrm)e(3)1201 732 y(#)h(frm)h(1)f(->)h
(blastfrm)e(1)1201 832 y(#)h(frm)h(2)f(->)h(blastfrm)e(2)-45
931 y(my)i(\045SEQlen;)-45 1031 y(my)g(\($chr,)f($seqln,)f($input\))h
(=)g(@ARGV;)-45 1131 y(my)h(@files)f(=)g(\(\);)-45 1230
y(my)h(\045g)f(=)h(\()g("+1")f(=>)g(0,)99 b("+2")49 b(=>)h(1,)99
b("+3")49 b(=>)h(2,)99 b("+")49 b(=>)h(3,)454 1330 y("-1")f(=>)g(4,)99
b("-2")49 b(=>)h(5,)99 b("-3")49 b(=>)h(6,)99 b("-")49
b(=>)h(7,)1002 1429 y("all")e(=>)i(8,)597 b("sum")49
b(=>)h([)f(\(0\))g(x)h(9)g(])f(\);)-45 1529 y(my)h(\($cf,$cr\);)-45
1629 y(open\(FRGLEN,)e("<)h($seqln"\);)-45 1728 y(while)g(\(<FRGLEN>\))
f({)155 1828 y(next)h(if)g(/^#/o;)155 1928 y(next)g(if)g(/^\\s*$/o;)155
2027 y(chomp;)155 2127 y(my)g(@l)h(=)f(split)g(/\\s+/og,)f($_;)155
2227 y($SEQlen{$l[0]})f(=)j($l[1];)-45 2326 y(};)g(#)g(while)-45
2426 y(close\(FRGLEN\);)-45 2525 y(open\(FRGLST,)e("<)h
($input.report"\);)-45 2625 y(while)g(\(<FRGLST>\))f({)155
2725 y(next)h(if)g(/^#/o;)155 2824 y(next)g(if)g(/^\\s*$/o;)155
2924 y(chomp;)155 3024 y(s/^\\s*//o;)155 3123 y(my)g(@l)h(=)f(split)g
(/\\s+/og,)f($_;)155 3223 y(\($l[2])g(>)i(0\))f(&&)h(do)f({)354
3322 y(push)g(@files,)g([)g($l[$#l],)f(\($l[0])h(-)h(1\))f(];)155
3422 y(};)155 3522 y(#)g(skipping)g(fragments)f(without)g(HSPs)-45
3621 y(};)i(#)g(while)-45 3721 y(close\(FRGLST\);)-45
3821 y(#)-45 3920 y(print)f(STDERR)g("#\\n#)g($chr)g(has)g(".\(scalar)f
(@files\).")g(fragments)h(\(files\)\\n#\\n#)e(".)603
4020 y(\(sprintf\("\0458s)g(\0458s)j(\0458s)99 b
(\045s\\n","#hsp","#hsp\(+\)","#hsp\(-\)",")o(file")o(\)\);)-45
4119 y(system\("/bin/rm","$input.parseblast.er)o(r"\);)-45
4219 y(foreach)49 b(my)g($fl)h(\(@files\))e({)155 4319
y($cf)h(=)h($cr)f(=)g(0;)155 4418 y(my)g(\($fname,$offset\))e(=)j
(\("$input/$fl->[0]",)c($fl->[1]\);)155 4518 y(open\(TBXFL,)h
("parseblast)h(-fullgff)h(-full-scores)e(-comments".)752
4618 y(")j(-verbose)e(-bit-score)g($fname)h(2\273)g
($input.parseblast.err)d(|"\);)155 4717 y(my)j(@l;)155
4817 y(while)g(\(<TBXFL>\))f({)354 4916 y(next)h(if)g(/^\\s*$/o;)354
5016 y(/^#/o)g(&&)g(do)h({)553 5116 y(print)f(STDOUT)g($_;)553
5215 y(next;)354 5315 y(};)354 5415 y(chomp;)354 5514
y(@l)g(=)h(split)f(/\\s+/og,)f($_,)h(9;)354 5614 y($l[$seq])f(=)i
($chr;)354 5713 y($l[$src])e(=)i("tblastx";)354 5813
y($l[$ftr])e(=)i("hsp";)354 5913 y($l[$ori])e(+=)i($offset;)p
Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o
(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)
1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 39 44
39 43 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(A.3.)22 b Fx(Gene-prediction)28 b(phase)2188 b FG(39)p
-128 -243 4016 9 v Black 354 35 a Fu($l[$end])48 b(+=)i($offset;)354
134 y(if)f(\($l[$str])g(eq)g("-"\))g({)553 234 y($l[$frm])g(=)g
($frame[\(\($SEQlen{$chr})d(-)j($l[$end])g(+)g(1\))h(\045)g(3\)];)553
334 y($cr++;)354 433 y(})g(else)f({)553 533 y($l[$frm])g(=)g
($frame[\($l[$ori])e(\045)j(3\)];)553 632 y($cf++;)354
732 y(};)354 832 y(print)f(STDOUT)g(join\("\\t",)e(@l\)."\\n";)354
931 y($g{sum}[$g{"$l[$str]$l[$frm]"}]++;)155 1031 y(};)i(#)h(while)155
1131 y(close\(TBXFL\);)155 1230 y(printf)e(STDERR)h(")100
b(\0458s)49 b(\0458s)g(\0458s)99 b
(\045s\\n",\($cf+$cr\),$cf,$cr,$fl->[0];)-45 1330 y(};)50
b(#)g(foreach)-45 1429 y($g{sum}[$g{"+"}])d(=)j($g{sum}[$g{"+1"}])d(+)i
($g{sum}[$g{"+2"}])e(+)i($g{sum}[$g{"+3"}];)-45 1529
y($g{sum}[$g{"-"}])e(=)j($g{sum}[$g{"-1"}])d(+)i($g{sum}[$g{"-2"}])e(+)
i($g{sum}[$g{"-3"}];)-45 1629 y($g{sum}[$g{"all"}])e(=)j
($g{sum}[$g{"+"}])c(+)k($g{sum}[$g{"-"}];)-45 1728 y(print)f(STDERR)g
("#)g(TOTAL)g(".$g{sum}[$g{"all"}].")d(HSPs)j(on)h($chr:)e(".)603
1828 y($g{sum}[$g{"+"}].")e(forward,)j(".$g{sum}[$g{"-"}].")d
(reverse.\\n";)-45 1928 y(foreach)j(my)g($t)h(\(qw/)f(+1)g(+2)h(+3)f
(-1)h(-2)f(-3)h(/\))f({)105 2027 y(printf)g(STDERR)f("#\\t\045s)h(:)h
(\045s\\n",$t,$g{sum}[$g{$t}];)-45 2127 y(};)g(#)g(foreach)-45
2227 y(#)-45 2326 y(exit\(0\);)-128 2617 y FL(A.3)100
b(Gene-pr)n(ediction)27 b(phase)-128 2791 y FD(A.3.1)91
b(Scripts:)30 b(Running)21 b(e)o(v)o(aluation)j(f)n(or)g(gene-pr)n
(ediction)p Black Black -415 2952 a Fq(39a)180 b Fp(h)p
FI(tangling:)19 b(perl)h(scripts)i Fq(31a)p Fp(i)q Fo(+)o
Ft(\021)-45 3052 y Fu(notangle)49 b(-R"runeval.pl")e($WORK/$nwfile.nw)g
(|)i(cpif)g($BIN/runeval.pl)f(;)-45 3152 y(is_exec)h($BIN/runeval.pl)e
(;)p Black Black -420 3340 a Fq(39b)181 b Fp(h)p FI(rune)o(val.pl)19
b Fq(39b)p Fp(i)r Ft(\021)-45 3440 y Fp(h)p FI(PERL)i(shebang)d
Fq(83a)p Fp(i)-45 3539 y Fu(#)50 b(Running)f(evaluation)f(by)h
(chromosome.)-45 3639 y(#)-45 3739 y(#)h(USAGE:)f(runeval.pl)f
(chromosome)-45 3838 y(#)-45 3938 y Fp(h)p FI(PERL)21
b(strict)g(pr)o(a)o(gma)e(+)i(info)f Fq(83b)p Fp(i)-45
4038 y Fu(my)50 b($PROG)f(=)g('runeval.pl';)-45 4137
y(#)-45 4336 y(#)-45 4436 y(##)h(MAIN)-45 4536 y(open\(FSHRT,">)e("\);)
-45 4635 y(open\(FLONG,">)g("\);)-45 4835 y
(&print_file_header\(\\*FSHRT,\);)-45 4934 y
(&print_file_header\(\\*FLONG,\);)-45 5034 y(exit\(0\);)-45
5233 y(#)-45 5333 y(##)i(SUBS)-45 5432 y(sub)g(print_file_header\(\))c
({)155 5532 y(my)j(\($fh,$prog,$chr,$run,$outname,$gver\))43
b(=)50 b(;)155 5632 y(print)f($fh)g(\253"EOTXT";)-45
5731 y(###)-45 5831 y(###)h(EVALUATION)e(of)h($prog)g(RESULTS)f(on)i
(CHR)f($chr)g(\($run\))-45 5930 y(###)p Black -128 6076
V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 40 45
40 44 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(A.3.)22 b Fx(Gene-prediction)28 b(phase)2188 b FG(40)p
-128 -243 4016 9 v Black -45 35 a Fu(###)50 b($outname)-45
134 y(###)-45 234 y(###)g($USER)f(-)g($DATE)-45 334 y(###)-45
433 y(###)h($gver)-45 533 y(###)-45 632 y(EOTXT)-45 732
y(})g(#)g(print_file_header)-128 1028 y FD(A.3.2)91 b(Scripts:)30
b(Re-scoring)24 b(SRs)p Black Black -415 1189 a Fq(40a)180
b Fp(h)p FI(tangling:)19 b(perl)h(scripts)i Fq(31a)p
Fp(i)q Fo(+)o Ft(\021)-45 1288 y Fu(notangle)49 b(-R"getHSPSR.pl")e
($WORK/$nwfile.nw)g(|)i(cpif)g($BIN/getHSPSR.pl)e(;)-45
1388 y(is_exec)i($BIN/getHSPSR.pl)e(;)p Black Black -420
1587 a Fq(40b)181 b Fp(h)p FI(g)o(etHSPSR.pl)19 b Fq(40b)p
Fp(i)q Ft(\021)-45 1687 y Fp(h)p FI(PERL)i(shebang)d
Fq(83a)p Fp(i)-45 1787 y Fu(#)50 b(Re-scoring)e(SRs)h(to)h(produce)e
(HSP-SRs)h(for)g(SGP)g(homology.)-45 1886 y(#)-45 1986
y(#)h(USAGE:)f(getHSPSR.pl)f("chrname")g(<)h(SR_file.gff)f(>)i
(HSP-SR_file.gff)d(>)i(stdout.report)-45 2085 y(#)-45
2185 y Fp(h)p FI(PERL)21 b(strict)g(pr)o(a)o(gma)e(+)i(info)f
Fq(83b)p Fp(i)-45 2285 y Fu(my)50 b($PROG)f(=)g('getHSPSR.pl';)-45
2384 y(#)-45 2484 y(my)h($chr)f(=)h(shift;)-45 2584 y(my)g
(\($seq,$src,$ftr,$ori,$end,$sco,$str)o(,$frm)o(\))44
b(=)50 b(\(0..7\);)-45 2683 y(my)g(\045g)f(=)h(\()g("+1")f(=>)g(0,)99
b("+2")49 b(=>)h(1,)99 b("+3")49 b(=>)h(2,)99 b("+")49
b(=>)h(3,)454 2783 y("-1")f(=>)g(4,)99 b("-2")49 b(=>)h(5,)99
b("-3")49 b(=>)h(6,)99 b("-")49 b(=>)h(7,)1002 2882 y("all")e(=>)i(8,)
597 b("sum")49 b(=>)h([)f(\(0\))g(x)h(9)g(])f(\);)-45
2982 y(my)h($HSPminLEN)e(=)h(1;)h(#)g($ori)f(+)g($HSPminLEN)f(-)i(1)f
(==>)h(minimum)e(length)h(is)g(1)h(nucleotide)-45 3082
y(my)g($S_CUTOFF)e(=)i(26;)-45 3181 y(my)g($SCF)f(=)h(0;)f(#)h
(substract)e(to)h(tblastx)g(scores)f(S_CUTOFF)h(-)g(SCF)-45
3281 y(my)h($DSC)f(=)h($S_CUTOFF)e(-)h($SCF;)-45 3381
y(my)h($SHSP)99 b(=)49 b(0;)199 b(#)50 b(SHSP=6)e(#)i(shrink)f(hsp)g
(by)g($SHSP)-45 3480 y(my)h($WTBX)99 b(=)49 b(0.19;)g(#)h(weigth)e(of)i
(tblastx)e(score)-45 3580 y(my)i($WTBXF)f(=)g(0.30;)g(#)h(weigth)e(of)i
(tblastx)e(score)-45 3679 y(my)i($WTBXI)f(=)g(0.20;)g(#)h(weigth)e(of)i
(tblastx)e(score)-45 3779 y(my)i($WTBXT)f(=)g(0.30;)g(#)h(weigth)e(of)i
(tblastx)e(score)-45 3879 y(while)h(\(<STDIN>\))f({)155
3978 y(my)h(@l;)155 4078 y(next)g(if)g(/^#/o;)155 4178
y(next)g(if)g(/^\\s*$/o;)155 4277 y(chomp;)155 4377 y(@l)g(=)h(split)f
(/\\s+/og,)f($_;)155 4476 y(next)h(unless)f($l[$sco])h(>)g($S_CUTOFF;)
155 4576 y($l[$sco])f(=)i(\($l[$sco])e(-)h($DSC\))g(*)h($WTBX;)155
4676 y($l[$ori])e(+=)h($SHSP;)155 4775 y($l[$end])f(-=)h($SHSP;)155
4875 y(next)g(if)g($l[$end])g(<)g(\($l[$ori])f(+)i($HSPminLEN)e(-)h
(1\);)155 4975 y(print)g(STDOUT)f(join\("\\t",@l\)."\\n";)155
5074 y($g{sum}[$g{"$l[$str]$l[$frm]"}]++;)-45 5174 y(};)i(#)g(while)-45
5273 y($g{sum}[$g{"+"}])d(=)j($g{sum}[$g{"+1"}])d(+)i
($g{sum}[$g{"+2"}])e(+)i($g{sum}[$g{"+3"}];)-45 5373
y($g{sum}[$g{"-"}])e(=)j($g{sum}[$g{"-1"}])d(+)i($g{sum}[$g{"-2"}])e(+)
i($g{sum}[$g{"-3"}];)-45 5473 y($g{sum}[$g{"all"}])e(=)j
($g{sum}[$g{"+"}])c(+)k($g{sum}[$g{"-"}];)-45 5572 y(print)f(STDERR)g
("#)g(TOTAL)g(".$g{sum}[$g{"all"}].")d(HSPs)j(on)h($chr:)e(".)603
5672 y($g{sum}[$g{"+"}].")e(forward,)j(".$g{sum}[$g{"-"}].")d
(reverse.\\n";)-45 5772 y(foreach)j(my)g($t)h(\(qw/)f(+1)g(+2)h(+3)f
(-1)h(-2)f(-3)h(/\))f({)105 5871 y(printf)g(STDERR)f("#\\t\045s)h(:)h
(\045s\\n",$t,$g{sum}[$g{$t}];)p Black -128 6076 V -128
6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 41 46
41 45 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.)22 b(Job)i(Control)h(System)2363 b(41)p -128
-243 4016 9 v Black -45 35 a Fu(};)50 b(#)g(foreach)-45
134 y(#)-45 234 y(exit\(0\);)-128 576 y FM(B)120 b(J)n(ob)30
b(Contr)n(ol)g(System)-128 787 y FL(B.1)100 b(Interacting)26
b(with)f(MySQL)-128 961 y FD(B.1.1)91 b(Building)23 b(database)p
Black Black -415 1122 a Fq(41a)180 b Fp(h)p FI(MySQL:)21
b(Cr)m(eating)f(Database)f(Report)g Fq(41a)p Fp(i)r Ft(\021)-45
1222 y Fu(#)-45 1321 y(#)50 b(Creating)e(mysql)h(DataBase)g(\(root\))
-45 1421 y(#)-45 1521 y(shell>)99 b(mysql)49 b(-u)g(root)g(-p)149
b(\(u:user,)49 b(p:passwd\))-45 1620 y(Enter)g(password:)-45
1720 y(Welcome)g(to)g(the)h(MySQL)f(monitor.)98 b(Commands)48
b(end)h(with)g(;)h(or)f(\\g.)-45 1819 y(Your)h(MySQL)e(connection)g(id)
i(is)f(772)g(to)h(server)f(version:)f(3.23.36)-45 2019
y(Type)i('help;')e(or)h('\\h')h(for)f(help.)g(Type)g('\\c')g(to)g
(clear)g(the)g(buffer)-45 2218 y(mysql>)g(CREATE)g(DATABASE)f
(db_Hsapiens;)-45 2318 y(Query)h(OK,)h(1)f(row)g(affected)g(\(0.06)g
(sec\))-45 2517 y(mysql>)g(show)g(databases;)-45 2616
y(+-----------+)-45 2716 y(|)h(Database)397 b(|)-45 2816
y(+-----------+)-45 2915 y(|)50 b(admin_db)397 b(|)-45
3015 y(|)50 b(db_Hsapiens)247 b(|)-45 3115 y(|)50 b(db_SPtest)347
b(|)-45 3214 y(|)50 b(ensembl_generic)d(|)-45 3314 y(|)j(horde)547
b(|)-45 3413 y(|)50 b(mysql)547 b(|)-45 3513 y(|)50 b(ontology_db)247
b(|)-45 3613 y(|)50 b(popper)497 b(|)-45 3712 y(|)50
b(smartie)447 b(|)-45 3812 y(|)50 b(test)597 b(|)-45
3912 y(|)50 b(texbiblio_db)197 b(|)-45 4011 y(|)50 b(web_db)497
b(|)-45 4111 y(+-----------+)-45 4210 y(12)50 b(rows)f(in)g(set)h
(\(0.01)f(sec\))-45 4410 y(mysql>)g(GRANT)g(ALL)g(on)h(db_Hsapiens.*)d
(TO)j(genome@localhost)c(IDENTIFIED)i(BY)i("xxxx")e(;)-45
4509 y(Query)h(OK,)h(0)f(rows)g(affected)g(\(0.10)f(sec\))-45
4609 y(#)-45 4709 y(#)i(Accessing)e(to)i(mysql)f(DataBase)f(\(user\))
-45 4808 y(#)-45 4908 y(shell>)99 b(mysql)49 b(-u)g(genome)g(-p)g
(db_Hsapiens)-45 5007 y(#)p Black Black -420 5207 a Fq(41b)181
b Fp(h)p FI(MySQL:)21 b(Setting)e(up)h(T)-8 b(ables)20
b Fq(41b)p Fp(i)r Ft(\021)-45 5306 y Fu(/*)50 b(Setting)e(working)h
(database)f(*/)-45 5406 y(USE)i(db_Hsapiens)d(;)-45 5605
y(/*)j(Sequence)e(related)h(tables)f(*/)-45 5705 y(CREATE)h(TABLE)g
(tb_chromosome)-45 5804 y(\()55 5904 y(id)498 b(CHAR\(2\))297
b(NOT)50 b(NULL,)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 42 47
42 46 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.1.)22 b Fx(Interacting)27 b(with)c(MySQL)2112
b FG(42)p -128 -243 4016 9 v Black 55 35 a Fu(code)398
b(INT)49 b(UNSIGNED)f(NOT)i(NULL)f(AUTO_INCREMENT)e(PRIMARY)h(KEY,)55
134 y(version)248 b(VARCHAR\(50\),)55 234 y(descr)348
b(TEXT)-45 334 y(\);)-45 433 y(CREATE)49 b(TABLE)g(tb_sequence)-45
533 y(\()55 632 y(id)498 b(VARCHAR\(25\))97 b(NOT)50
b(NULL,)55 732 y(code)398 b(INT)49 b(UNSIGNED)f(NOT)i(NULL)f
(AUTO_INCREMENT)e(PRIMARY)h(KEY,)55 832 y(chr)448 b(INT)49
b(UNSIGNED)f(NOT)i(NULL,)55 931 y(length)298 b(INT)49
b(UNSIGNED)f(NOT)i(NULL,)55 1031 y(version)248 b(CHAR\(14\))f(NOT)50
b(NULL,)f(/*)g(YYYYMMDDhhmmss)e(*/)55 1131 y(composition)h
(VARCHAR\(150\))f(NOT)j(NULL,)55 1230 y(descr)348 b(TEXT)-45
1330 y(\);)-45 1529 y(/*)50 b(Process)e(related)h(tables)g(*/)-45
1629 y(CREATE)g(TABLE)g(tb_job)-45 1728 y(\()55 1828
y(id)299 b(VARCHAR\(25\))97 b(NOT)49 b(NULL,)55 1928
y(code)199 b(INT)49 b(UNSIGNED)f(NOT)h(NULL)g(AUTO_INCREMENT)f(PRIMARY)
g(KEY,)55 2027 y(descr)149 b(TEXT,)55 2127 y(path)199
b(VARCHAR\(100\))47 b(NOT)i(NULL,)55 2227 y(jxid)199
b(VARCHAR\(25\))97 b(NOT)49 b(NULL)-45 2326 y(\);)-45
2426 y(CREATE)g(TABLE)g(tb_step)-45 2525 y(\()55 2625
y(id)299 b(VARCHAR\(25\))97 b(NOT)49 b(NULL,)55 2725
y(code)199 b(INT)49 b(UNSIGNED)f(NOT)h(NULL)g(AUTO_INCREMENT)f(PRIMARY)
g(KEY,)55 2824 y(job)249 b(INT)49 b(UNSIGNED)f(NOT)h(NULL,)55
2924 y(version)g(VARCHAR\(40\),)e(/*)j(which)e(program)h(and)g(its)g
(version)g(is)g(being)g(run)h(*/)55 3024 y(descr)149
b(TEXT,)55 3123 y(path)199 b(VARCHAR\(100\))47 b(NOT)i(NULL,)55
3223 y(sxid)199 b(VARCHAR\(25\))97 b(NOT)49 b(NULL,)55
3322 y(idir)199 b(VARCHAR\(200\))47 b(NOT)i(NULL,)55
3422 y(odir)199 b(VARCHAR\(200\))47 b(NOT)i(NULL,)55
3522 y(edir)199 b(VARCHAR\(200\))47 b(NOT)i(NULL,)55
3621 y(script)99 b(TEXT)447 b(NOT)49 b(NULL)-45 3721
y(\);)-45 3920 y(/*)h(Execution)e(related)h(tables)f(*/)-45
4020 y(CREATE)h(TABLE)g(tb_status)-45 4119 y(\()55 4219
y(id)299 b(VARCHAR\(10\))97 b(NOT)49 b(NULL,)55 4319
y(code)199 b(INT)49 b(UNSIGNED)f(NOT)h(NULL)g(AUTO_INCREMENT)f(PRIMARY)
g(KEY,)55 4418 y(descr)149 b(TEXT,)55 4518 y(color)g(VARCHAR\(30\))97
b(NOT)49 b(NULL)-45 4618 y(\);)-45 4717 y(CREATE)g(TABLE)g(tb_exec)-45
4817 y(\()55 4916 y(status)348 b(INT)49 b(UNSIGNED)f(NOT)h(NULL,)55
5016 y(chr_seq)298 b(INT)49 b(UNSIGNED)f(NOT)h(NULL,)55
5116 y(job_step)248 b(INT)49 b(UNSIGNED)f(NOT)h(NULL,)55
5215 y(exec_pid)248 b(INT)49 b(UNSIGNED)f(NOT)h(NULL,)55
5315 y(exec_date)198 b(CHAR\(14\))247 b(NOT)49 b(NULL,)g(/*)h
(YYYYMMDDhhmmss)d(*/)55 5415 y(host)448 b(VARCHAR\(15\))97
b(NOT)49 b(NULL,)55 5514 y(user)448 b(VARCHAR\(15\))97
b(NOT)49 b(NULL,)55 5614 y(stdout)348 b(TEXT,)55 5713
y(stderr)g(TEXT)-45 5813 y(\);)p Black -128 6076 V -128
6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 43 48
43 47 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.1.)22 b Fx(Interacting)27 b(with)c(MySQL)2112
b FG(43)p -128 -243 4016 9 v Black -45 35 a Fu(/*)50
b(EOF)f(*/)p Black Black -415 234 a Fq(43a)180 b Fp(h)p
FI(tangling:)19 b(mySQL)h(scripts)h Fq(43a)p Fp(i)q Ft(\021)-45
334 y Fu(#)-45 433 y(#)50 b(MySQL)f(tables)g(description)e(for)j
(db_Hsapiens)-45 533 y(notangle)f(-R'MySQL:)f(Setting)g(up)i(Tables')e
($WORK/$nwfile.nw)f(|)j(\\)155 632 y(cpif)f($MySQLPAR/db_Hsapiens.sql;)
-45 732 y(#)-128 1028 y FD(B.1.2)91 b(Initialitation)26
b(\002les)p Black Black -420 1189 a Fq(43b)181 b Fp(h)p
FI(MySQL:)21 b(initialization)e(\002le)h(for)h(P)-7 b(erl)21
b(scripts)g Fq(43b)p Fp(i)q Ft(\021)-45 1288 y Fu(#)-45
1388 y(#)50 b(db_Hsapiens_in.pm)-45 1488 y(#)-45 1587
y(#)150 b(setting)48 b(user)h(access)g(to)g(db_Hsapiens)f(mySQL)h
(database)-45 1687 y(#)-45 1787 y Fp(h)p FI(V)-9 b(er)o(sion)21
b(Contr)l(ol)f(Id)g(T)-8 b(a)o(g)21 b Fq(85g)p Fp(i)-45
1886 y Fu(#)-45 1986 y(package)49 b(db_Hsapiens_in;)-45
2085 y(use)h(strict;)-45 2185 y(use)g(vars)f(qw\()g(@ISA)g(@EXPORT)g
(@EXPORT_OK)f(\045EXPORT_TAGS)f($VERSION)603 2285 y($mySQL_db)h
($mySQL_host)g($mySQL_user)g($mySQL_pswd)f(\);)-45 2484
y(use)j(Exporter;)-45 2584 y($VERSION)f(=)g(1.00;)-45
2683 y(@ISA)h(=)f(qw\(Exporter\);)-45 2783 y(@EXPORT)g(=)h(qw\()f
($mySQL_db)f($mySQL_host)g($mySQL_user)f($mySQL_pswd)h(\);)-45
2882 y(#)i(@@EXPORT_OK)e(=)h(qw\()h(\);)-45 2982 y(#)g(\045EXPORT_TAGS)
e(=)h(\(\);)-45 3181 y($mySQL_db)148 b(=)50 b('db_Hsapiens';)-45
3281 y($mySQL_host)e(=)i('monstre1.imim.es';)-45 3381
y($mySQL_user)e(=)i('genome';)-45 3480 y($mySQL_pswd)e(=)i(\224;)f(#)h
(use)f(vi)h(to)f(introduce)f(the)h(pswd)g(for)h(this)f(user!!!)-45
3679 y(1;)p Black Black -415 3879 a Fq(43c)180 b Fp(h)p
FI(B)n(ASH)20 b(V)-9 b(ariables:)19 b(P)-7 b(erl)21 b
Fq(43c)p Fp(i)r Ft(\021)-45 3978 y Fu(#)-45 4078 y
(PERL5OPT="-I$BBIN/libperl")45 b(;)-45 4178 y(export)k(PERL5OPT;)-45
4277 y(#)14 4440 y FG(This)23 b(\002le)g(w)o(as)g(tangled)i(the)f
(\002rst)f(time,)g(since)i(then)f(it)g(is)f(under)i(v)o(ersion)g
(control)g(and)f(edited)h(by)e(hand...)p Black Black
-420 4589 a Fq(43d)181 b Fp(h)p FI(tangling:)19 b(mySQL)h(par)o(am)f
Fq(43d)p Fp(i)r Ft(\021)-45 4689 y Fu(#)-45 4789 y(#)50
b(mySQL)f(perl)g(auxiliarly)f(files)-45 4888 y(#)-45
4988 y(#)i(notangle)e(-R'MySQL:)h(initialization)e(file)i(for)g(Perl)g
(scripts')f(\\)-45 5087 y(#)249 b($WORK/$nwfile.nw)47
b(|)j(cpif)f($MySQLPAR/db_Hsapiens_in.pm)c(;)-45 5187
y(#)50 b(chmod)f(660)g($MySQLPAR/db_Hsapiens_in.pm)c(;)-45
5287 y(#)14 5449 y FG(The)23 b(follo)n(wing)i(\002les)e(will)g(serv)o
(e)h(to)g(load)g(ro)n(ws)f(on)h(dif)n(ferent)h(tables)g(with)e
FB(admin_db_Hsapien)o(s.)o(pm)o FG(.)p Black -128 6076
V -128 6180 a FK(Genome)d(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 44 49
44 48 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.1.)22 b Fx(Interacting)27 b(with)c(MySQL)2112
b FG(44)p -128 -243 4016 9 v Black Black Black -415 35
a Fq(43e)180 b Fp(h)p FI(MySQL:)21 b(adm)e(\002le)i(-)f(c)o(hr)o(s)h
Fq(43e)p Fp(i)q Ft(\021)-45 134 y Fu(#)-45 234 y(#)50
b(chrs.tbl)-45 334 y(#)-45 433 y(#)150 b(chromosome)48
b(table)-45 533 y(#)-45 632 y Fp(h)p FI(V)-9 b(er)o(sion)21
b(Contr)l(ol)f(Id)g(T)-8 b(a)o(g)21 b Fq(85g)p Fp(i)-45
732 y Fu(#)-45 832 y(#)50 b(Setting)f(global)f(version)h(\(must)g
(start)g(with)g('#>#)g('\))-45 931 y(#)-45 1031 y(#>#)h(Golden)e(Path)h
(20010806)-45 1131 y(#)-45 1230 y(#)h(Record)f(Format:)-45
1330 y(#)150 b(<chr_id>)48 b(<version>)g(<description>)-45
1429 y(#)i(where:)-45 1529 y(#)349 b(<version>)48 b(==)i(.)f(->)h
(global)e(version)-45 1629 y(#)150 b(<description>)47
b(==)j(.)f(->)h(undef)5 1728 y(1)g(.)g(.)5 1828 y(2)g(.)g(.)5
1928 y(3)g(.)g(.)5 2027 y(4)g(.)g(.)5 2127 y(5)g(.)g(.)5
2227 y(6)g(.)g(.)5 2326 y(7)g(.)g(.)5 2426 y(8)g(.)g(.)5
2525 y(9)g(.)g(.)-45 2625 y(10)g(.)g(.)-45 2725 y(11)g(.)g(.)-45
2824 y(12)g(.)g(.)-45 2924 y(13)g(.)g(.)-45 3024 y(14)g(.)g(.)-45
3123 y(15)g(.)g(.)-45 3223 y(16)g(.)g(.)-45 3322 y(17)g(.)g(.)-45
3422 y(18)g(.)g(.)-45 3522 y(19)g(.)g(.)-45 3621 y(20)g(.)g(.)-45
3721 y(21)g(.)g(.)-45 3821 y(22)g(.)g(.)5 3920 y(X)g(.)g(.)5
4020 y(Y)g(.)g(.)-45 4119 y(#)-45 4219 y(NA)g(.)g(.)-45
4319 y(UL)g(.)g(.)-45 4418 y(#)p Black Black -382 4730
a Fq(44)180 b Fp(h)p FI(MySQL:)21 b(adm)e(\002le)i(-)f(seqs)h
Fq(44)p Fp(i)q Ft(\021)-45 4830 y Fu(#)-45 4930 y(#)50
b(seqs.tbl)-45 5029 y(#)-45 5129 y(#)150 b(sequences)48
b(for)h(each)g(chromosome)-45 5229 y(#)-45 5328 y Fp(h)p
FI(V)-9 b(er)o(sion)21 b(Contr)l(ol)f(Id)g(T)-8 b(a)o(g)21
b Fq(85g)p Fp(i)-45 5428 y Fu(#)-45 5527 y(#)50 b(Record)f(Format:)-45
5627 y(#)150 b(<chr_id>)48 b(<sequence_id>)f(<length>)i
(<file_modifying_date>)d(<description>)-45 5727 y(#)k(where:)-45
5826 y(#)150 b(<file_modifying_date>)46 b(is)j(in)g(YYYYMMDDhhmmss)f
(format)-45 5926 y(#)150 b(<description>)47 b(==)j(.)f(->)h(undef)p
Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o
(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)
1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 45 50
45 49 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.1.)22 b Fx(Interacting)27 b(with)c(MySQL)2112
b FG(45)p -128 -243 4016 9 v Black -45 35 a Fu(#)p Black
Black -415 340 a Fq(45a)180 b Fp(h)p FI(MySQL:)21 b(adm)e(\002le)i(-)f
(jobs)g Fq(45a)p Fp(i)q Ft(\021)-45 439 y Fu(#)-45 539
y(#)50 b(jobs.tbl)-45 638 y(#)-45 738 y(#)150 b(main)49
b(process)f(id)i(table)-45 838 y(#)-45 937 y Fp(h)p FI(V)-9
b(er)o(sion)21 b(Contr)l(ol)f(Id)g(T)-8 b(a)o(g)21 b
Fq(85g)p Fp(i)-45 1037 y Fu(#)-45 1137 y Fp(h)p FI(JOBheader:)e
(Sequence)f(Analysis)j Fq(4a)p Fp(i)-45 1236 y(h)p FI(JOBheader:)e
(HsapGP)-7 b(a)20 b(x)g(MmusPHa)g(WUTBLASTX)g Fq(10a)p
Fp(i)-45 1336 y(h)p FI(JOBheader:)f(Running)f(GENEID)i(standar)m(d)f
Fq(14a)p Fp(i)-45 1435 y(h)p FI(JOBheader:)g(SGP)h(with)h(HSAPgpa)d(x)j
(MMUSpha)e(homolo)o(gy)f Fq(17a)p Fp(i)-45 1535 y(h)p
FI(JOBheader:)h(V)-6 b(isualizing)20 b(Results)g(with)h(Apollo)e
Fq(28a)p Fp(i)p Black Black -420 1840 a Fq(45b)181 b
Fp(h)p FI(MySQL:)21 b(adm)e(\002le)i(-)f(steps)h Fq(45b)p
Fp(i)q Ft(\021)-45 1939 y Fu(#)-45 2039 y(#)50 b(steps.tbl)-45
2139 y(#)-45 2238 y(#)150 b(process)48 b(step)h(\(executable)f
(scripts\))g(id)i(table)-45 2338 y(#)-45 2438 y Fp(h)p
FI(V)-9 b(er)o(sion)21 b(Contr)l(ol)f(Id)g(T)-8 b(a)o(g)21
b Fq(85g)p Fp(i)-45 2537 y Fu(#)p Black Black -415 2842
a Fq(45c)180 b Fp(h)p FI(MySQL:)21 b(adm)e(\002le)i(-)f(status)h
Fq(45c)p Fp(i)q Ft(\021)-45 2942 y Fu(#)-45 3041 y(#)50
b(status.tbl)-45 3141 y(#)-45 3241 y(#)150 b(program)48
b(execution)g(status)h(table)-45 3340 y(#)-45 3440 y
Fp(h)p FI(V)-9 b(er)o(sion)21 b(Contr)l(ol)f(Id)g(T)-8
b(a)o(g)21 b Fq(85g)p Fp(i)-45 3539 y Fu(#)-45 3639 y(#)50
b(Record)f(format:)-45 3739 y(#)150 b(<process_ID>)47
b(<color_name>)-45 3838 y(#)150 b(<description-line_0>)-45
3938 y(#)200 b(...)-45 4038 y(#)150 b(<description-line_n>)-45
4137 y(#)g(//)49 b(#)h(this)f(is)g(the)h(new)f(record)f(separator)-45
4237 y(#)-45 4336 y(TODO)249 b(lightblue)-45 4436 y(Process)49
b(was)g(not)g(started)g(yet...)-45 4536 y(//)-45 4635
y(RUNNING)99 b(steelblue)-45 4735 y(Current)49 b(step)g(is)g(being)g
(executed)g(at)g(this)g(moment...)-45 4835 y(//)-45 4934
y(DONE)249 b(seagreen)-45 5034 y(This)50 b(step)f(has)g(finished)f
(without)h(errors...)-45 5133 y(//)-45 5233 y(CHECK)199
b(orange)-45 5333 y(Process)49 b(reported)f(warnings...)-45
5432 y(Verify)h(its)g(execution)g(log)g(but)g(following)f(steps)h(are)g
(going)g(to)h(be)f(run...)-45 5532 y(//)-45 5632 y(KILLED)149
b(salmon)-45 5731 y(Program)49 b(execution)f(was)h(interrupted)f(by)i
(user...)-45 5831 y(Following)f(steps)f(are)i(being)f(skipped...)-45
5930 y(//)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 46 51
46 50 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.1.)22 b Fx(Interacting)27 b(with)c(MySQL)2112
b FG(46)p -128 -243 4016 9 v Black -45 35 a Fu(DIED)249
b(red)-45 134 y(An)50 b(error)f(ocurred)f(when)h(running)g(this)g
(step...)-45 234 y(Please,)g(check)g(error)g(report)f(that)h(has)h
(been)f(produced...)-45 334 y(//)-45 433 y(SKIPPED)99
b(gold)-45 533 y(This)50 b(step)f(has)g(been)g(skipped)f(due)i(to)f(a)h
(unfinished)e(previous)g(step...)-45 632 y(Please,)h(check)g(previous)f
(steps)h(of)g(the)h(current)e(job...)-45 732 y(//)-45
832 y(N/A)299 b(lightgrey)-45 931 y(Job)50 b(status)e(is)i(Not)f
(Available)f(at)i(this)f(moment...)-45 1031 y(Just)h(wait)f(to)g(the)g
(next)g(update)g(round)g(to)g(see)h(if)f(connection)f(problem)h
(persist...)-45 1131 y(//)p Black Black -415 1443 a Fq(46a)180
b Fp(h)p FI(tangling:)19 b(mySQL)h(par)o(am)f Fq(43d)p
Fp(i)r Fo(+)o Ft(\021)-45 1542 y Fu(#)-45 1642 y(#)50
b(mySQL)f(perl)g(auxiliarly)f(files)-45 1742 y(for)i(n)f(in)h(chrs)f
(jobs)g(steps)g(status;)55 1841 y(do)h({)304 1941 y(notangle)e
(-R"MySQL:)h(adm)g(file)g(-)h($n")f(\\)503 2041 y($WORK/$nwfile.nw)e(|)
j(cpif)f($MySQLPAR/$n.tbl)e(;)205 2140 y(};)55 2240 y(done;)-45
2339 y(#)j(seqs.tbl)e(is)i(produced)e(by)i(initialization)d(script)h
(on)i(sequence)e(analysis)h(section)-45 2439 y({)h(notangle)e
(-R'MySQL:)h(adm)g(file)g(-)g(seqs')g($WORK/$nwfile.nw)e(;)55
2539 y(cat)i($HUMUS/seqid_list)e(;)j(})f(|)h(cpif)f($MySQLPAR/seqs.tbl)
d(;)-45 2638 y(#)-128 2934 y FD(B.1.3)91 b(P)n(erl)24
b(interface)h(to)e(mySQL)f(database)p Black Black -420
3095 a Fq(46b)181 b Fp(h)p FI(tangling:)19 b(mySQL)h(perl)h(scripts)g
Fq(46b)p Fp(i)q Ft(\021)-45 3195 y Fu(#)-45 3294 y(#)50
b(mySQL)f(perl)g(scripts:)f(interacting)g(with)h(mySQL)g(DB)-45
3394 y(notangle)g(-R'MySQL:)f(perl)h(DB)g(interface')f(\\)155
3493 y($WORK/$nwfile.nw)f(|)i(cpif)g($LIBPERL/db_Hsapiens.pm)d(;)-45
3593 y(is_exec)j($LIBPERL/db_Hsapiens.pm)c(;)-45 3693
y(#)p Black Black -415 3892 a Fq(46c)180 b Fp(h)p FI(MySQL:)21
b(perl)f(DB)h(interface)f Fq(46c)p Fp(i)q Ft(\021)-45
3992 y Fp(h)p FI(PERL)h(shebang)d Fq(83a)p Fp(i)-45 4091
y Fu(#)50 b(db_Hsapiens.pm)-45 4191 y(#)-45 4290 y(package)f
(db_Hsapiens;)-45 4390 y(use)h(strict;)-45 4490 y Fp(h)p
FI(Use)22 b(Modules)d(-)i(Dumper)f Fq(84a)p Fp(i)-45
4589 y Fu(#)-45 4689 y(use)50 b(vars)f(qw\()503 4789
y(@ISA)g(@EXPORT)g(@EXPORT_OK)f(\045EXPORT_TAGS)f($VERSION)503
4888 y($mySQL_db)i($mySQL_host)e($mySQL_user)h($MySQLPAR)g($dbh)h($sth)
503 4988 y($_verbose)g($isDBon)f(\045status)h(\045chrs)f(\045jobs)503
5087 y(\);)-45 5287 y(use)i(Exporter;)-45 5386 y($VERSION)f(=)g(1.00;)
-45 5486 y(@ISA)h(=)f(qw\(Exporter\);)-45 5586 y(@EXPORT)g(=)h(qw\()155
5685 y($mySQL_db)e($mySQL_host)g($mySQL_user)f($_verbose)h($isDBon)155
5785 y(&open_DB)g(&close_DB)g($MySQLPAR)g($dbh)h($sth)155
5885 y(&get_tbl_hash)e(&get_row_fields)g(&put_row_fields)p
Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o
(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)
1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 47 52
47 51 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.1.)22 b Fx(Interacting)27 b(with)c(MySQL)2112
b FG(47)p -128 -243 4016 9 v Black 155 35 a Fu(&get_DB_codes)47
b(\045status)i(\045chrs)f(\045jobs)55 134 y(\);)-45 234
y(@EXPORT_OK)g(=)i(qw\()155 334 y(&connection_details)c
(&load_to_tbl_ifdef)155 433 y(&list_tables)h(&show_tbl_desc)g
(&count_tbl_elements)55 533 y(\);)-45 632 y(\045EXPORT_TAGS)h(=)i(\()
155 732 y(AdminFunc)e(=>)h([)h(qw\()f(&connection_details)d
(&load_to_tbl_ifdef)1101 832 y(&list_tables)i(&show_tbl_desc)f
(&count_tbl_elements)1101 931 y(\))j(],)155 1031 y(\);)-45
1230 y(#)g(use)f(lib)h("$LIBPERL";)-45 1330 y(use)g(db_Hsapiens_in;)-45
1429 y(my)g($dsn)f(=)h("DBI:mysql:database=$mySQL_db;hos)o(t=$my)o
(SQL_ho)o(st";)-45 1529 y(#)-45 1629 y(use)g(DBI;)-45
1728 y(#)-45 1828 y(use)g(global;)-45 1928 y(#)-45 2027
y($MySQLPAR)f(=)g($ENV{MySQLPAR})e(||)j(do)f({)354 2127
y(print)g(STDERR)g($Messages{'ENVNOTDEF'}->\("MySQLPA)o(R"\);)354
2227 y(exit\(1\);)155 2326 y(};)-45 2525 y($_verbose)g(=)g($T;)-45
2625 y($isDBon)g(=)h($F;)-45 2824 y(sub)g(connection_details\(\))c({)
155 2924 y(print)j(STDERR)f($Messages{'DBIHEADER'}->\("DBI:)c
(Available)49 b(DBD)g(Drivers"\);)155 3024 y(print)g(STDERR)f
($Messages{'DBIMSG'}->\()354 3123 y("",\(map)g({)i("\\t$_")f(})g
(DBI->available_drivers\),""\);)155 3223 y(print)g(STDERR)f
($Messages{'DBIHEADER'}->\("mySQL)c(DataBase)49 b(Connection)f
(Info:"\);)155 3322 y(print)h(STDERR)f
($Messages{'DBIMSG'}->\("","\\tDBname:)c($mySQL_db",)354
3422 y("\\t)99 b(Host:)49 b($mySQL_host","\\t)97 b(User:)48
b($mySQL_user",""\);)-45 3522 y(})i(#)g(connection_details)-45
3721 y(sub)g(open_DB\(\))e({)155 3821 y(my)h($trace_level)f(=)h(shift)g
(||)h(0;)155 3920 y(print)f(STDERR)f($Messages{'DBIHEADER'}->\()354
4020 y("Openning)g(mySQL)h(connection)f(to)h(\\'$mySQL_db\\')f
(DB..."\);)155 4119 y(DBI->trace\($trace_level\);)155
4219 y($dbh)h(=)g(DBI->connect\($dsn,)e($mySQL_user,)g($mySQL_pswd,)
1151 4319 y({)j(RaiseError)e(=>)h(1,)g(AutoCommit)f(=>)i(1)f(})h(\);)
155 4418 y(#)f(put)h(here)f(error)g(processing...)155
4518 y(print)g(STDERR)f($Messages{'DBIMSG'}->\()354 4618
y("","mySQL)g(connection)g(to)h(\\'$mySQL_db\\')f(DB)h(succesfully)f
(established.",""\);)155 4717 y($isDBon)g(=)i($T;)-45
4817 y(})g(#)g(open_DB)-45 5016 y(sub)g(close_DB\(\))e({)155
5116 y(defined\($dbh\))f(&&)j($dbh->disconnect\(\);)155
5215 y(#)f(put)h(here)f(error)g(processing...)155 5315
y(print)g(STDERR)f($Messages{'DBIHEADER'}->\()354 5415
y("mySQL)h(connection)f(to)h(\\'$mySQL_db\\')e(DB)j(has)f(been)g
(closed."\);)155 5514 y($isDBon)f(=)i($F;)-45 5614 y(})g(#)g(close_DB)
-45 5813 y(sub)g(list_tables\(\))d({)155 5913 y(my)i(@tbls;)p
Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o
(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)
1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 48 53
48 52 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.1.)22 b Fx(Interacting)27 b(with)c(MySQL)2112
b FG(48)p -128 -243 4016 9 v Black 155 35 a Fu(print)49
b(STDERR)f($Messages{'DBIHEADER'}->\()354 134 y("Retrieving)g(tables)g
(definition)g(for)i('$mySQL_db')d(DB..."\);)155 234 y(@tbls)i(=)g
($dbh->func\('_ListTables'\);)155 334 y(#)g(put)h(here)f(error)g
(processing...)155 433 y(return)f(@tbls;)-45 533 y(})i(#)g(do_DB)-45
732 y(sub)g(show_tbl_desc\(\))d({)155 832 y(my)i(\($table,)f($fhref\))h
(=)h(@_;)155 931 y(my)f(@strdesc)f(=)i(\(\);)155 1031
y($sth)f(=)g($dbh->prepare\(qq{)503 1131 y(DESC)g($table)g(/*)h(Shows)e
(mySQL)h(table)g(description)f(*/)404 1230 y(}\);)155
1330 y(#)h(put)h(here)f(error)g(processing...)155 1429
y($sth->execute;)155 1529 y(#)g(put)h(here)f(error)g(processing...)155
1629 y(push)g(@strdesc,)f('|->)h(DESC)g('.$table;)155
1728 y(while)g(\(my)g(@fld)g(=)h($sth->fetchrow_array\(\)\))45
b({)354 1828 y(#)50 b(put)f(here)g(error)g(processing...)354
1928 y(push)g(@strdesc,)f(sprintf\("\\t\045-10s)f(:)j
(\045s",$fld[0],@fld[1..$#fld]\);)155 2027 y(};)155 2127
y($sth->finish;)155 2227 y(#)f(put)h(here)f(error)g(processing...)155
2326 y(print)g($fhref)f($Messages{'DBIMSG'}->\("",@strdesc\);)-45
2426 y(})i(#)g(show_tbl_desc)-45 2625 y(sub)g(count_tbl_elements\(\))c
({)155 2725 y(my)j(\($fhref\))f(=)i(@_;)155 2824 y(print)f($fhref)f
($Messages{'DBIHEADER'}->\()354 2924 y("Counting)g(elements)g(number)h
(for)g(tables)g(on)g('$mySQL_db')f(DB..."\);)155 3024
y(my)h(\045tbls)g(=)h(\(\);)155 3123 y(foreach)e(my)i($t)f
(\(&list_tables\(\)\))e({)354 3223 y(my)i($str)g(=)h(qq{)553
3322 y(SELECT)f(COUNT\(*\))f(FROM)h($t)h(/*)f(Counting)f(elements)h
(for)g(mySQL)g(table)g(*/)553 3422 y(};)354 3522 y(print)g($fhref)g
($Messages{'DBICMD'}->\("$str"\);)354 3621 y($sth)g(=)h
($dbh->prepare\($str\);)354 3721 y($sth->execute\(\);)354
3821 y($tbls{$t})e(=)i($sth->fetchrow_array\(\);)354
3920 y($sth->finish;)155 4020 y(};)f(#)h(foreach)e($t)155
4119 y(print)h($fhref)f($Messages{'DBIMSG'}->\(""\);)155
4219 y(foreach)g(my)i($k)f(\(keys)g(\045tbls\))g({)354
4319 y(print)g($fhref)g($Messages{'DBIMSG'}->\()1201
4418 y(sprintf\("-->)e(\045-15s)i(:)h(\045s",$k,$tbls{$k}\)\);)155
4518 y(};)f(#)h(foreach)e($k)155 4618 y(print)h($fhref)f
($Messages{'DBIMSG'}->\(""\);)-45 4717 y(})i(#)g(count_tbl_elements)-45
4916 y(sub)g(load_to_tbl_ifdef\(\))c({)k(#)f(mv)h($field)e(to)i(end)f
(of)g(args)h(and)f(set)g(as)h(an)f(array)g(to)g(allow)g(multi-)-45
5016 y(ple)h(fields)e(select...)h(;^D)155 5116 y(my)g(\($table,)f
($fields,)h($aryfld,)f($aryrow,)g($delflg\))h(=)g(@_;)155
5215 y(my)g(\($fldstr,$valstr,$filter,$dsth,$dstr)o(,$sst)o(h,$sst)o
(r,$is)o(th,$is)o(tr\);)155 5315 y(defined\($delflg\))e(||)i(\($delflg)
f(=)i($F\);)155 5415 y(print)f(STDERR)f($Messages{'DBIHEADER'}->\()354
5514 y("REBUILDING)g(FIELDS)g(for)i(TABLE)f(\\"$table\\""\);)155
5614 y($fldstr)f(=)i("\(".join\(',)e(',@{$aryfld}\)."\)";)155
5713 y($valstr)g(=)i("VALUES\(".join\(',',\('?'\))45
b(x)50 b(scalar\(@{$aryfld}\)\)."\)";)155 5813 y($filter)e(=)i
(join\("\\n)845 b(AND)49 b(",)902 5913 y(\()h(map)f({)g
($aryfld->[$_].'=?')e(})i(@{)h($fields)e(})i(\)\);)p
Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o
(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)
1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 49 54
49 53 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.1.)22 b Fx(Interacting)27 b(with)c(MySQL)2112
b FG(49)p -128 -243 4016 9 v Black 155 35 a Fu($dstr)49
b(=)g(qq{)354 134 y(DELETE)g(FROM)g($table)354 234 y(};)155
334 y($sstr)g(=)g(qq{)354 433 y(SELECT)g(COUNT\(*\))397
b(/*)49 b(COUNT\(Saryfld->[Sfield]\))c(*/)703 533 y(FROM)k($table)703
632 y(WHERE)g($filter)148 b(/*)49 b(Saryfld->[Sfield]=Q)d(*/)354
732 y(};)155 832 y($istr)j(=)g(qq{)354 931 y(INSERT)g($table)703
1031 y($fldstr)703 1131 y($valstr)f(/*)i(adding)e(new)i(records)e(*/)
354 1230 y(};)155 1330 y($delflg)g(&&)i(do)f({)354 1429
y(print)g(STDERR)g($Messages{'DBICMD'}->\("$dstr"\);)354
1529 y($dsth)g(=)g($dbh->prepare\($dstr\);)354 1629 y
($dsth->execute\(\);)354 1728 y($dsth->finish\(\);)354
1828 y(print)g(STDERR)g($Messages{'DBIMSG'}->\()553 1928
y("All)g(rows)g(in)h(\\"$table\\")e(were)h(deleted..."\);)155
2027 y(};)155 2127 y(print)g(STDERR)f
($Messages{'DBICMD'}->\("$sstr$istr"\);)155 2227 y($ssth)h(=)g
($dbh->prepare\($sstr\);)155 2326 y($isth)g(=)g
($dbh->prepare\($istr\);)155 2426 y(foreach)f(my)i($row)f
(\(@{$aryrow}\))e({)354 2525 y(my)i($count;)354 2625
y(my)g(@trow)g(=)h(\(map)f({)h($row->[$_])e(})h(@{)h($fields)e(}\);)354
2725 y($ssth->execute\(@trow\);)354 2824 y($count)h(=)g
($ssth->fetchrow_array\(\);)354 2924 y(\($count)f(==)i(0\))f(&&)h(do)f
({)553 3024 y(print)g(STDERR)g($Messages{'DBIMSG'}->\()752
3123 y("\\"@trow\\")f(NOT)i(found)f(in)g(\\"$table\\":)f
(INSERTING..."\);)553 3223 y($isth->execute\(@{$row}\);)553
3322 y(next;)354 3422 y(};)354 3522 y(print)h(STDERR)g
($Messages{'DBIMSG'}->\()553 3621 y("\\"@trow\\")f(already)h(defined)f
(in)i(\\"$table\\":)d(SKIPPING..."\);)155 3721 y(};)i(#)h(foreach)e
($row)155 3821 y(print)h(STDERR)f($Messages{'DBIMSG'}->\()354
3920 y("",\(scalar)g(\(@{$aryrow}\)\).")f(records)h(were)h
(checked...",""\);)155 4020 y($ssth->finish\(\);)155
4119 y($isth->finish\(\);)-45 4219 y(})h(#)g(load_to_tbl_ifdef)-45
4418 y(sub)g(get_tbl_hash\(\))d({)155 4518 y(#)i(here)g(we)h(assume)f
(that)g(the)g(first)g(element)f(of)i($aryfld)e(is)i(a)f(hash)g(key)155
4618 y(my)g(\($href,)g($table,)f($aryfld\))g(=)i(@_;)155
4717 y(print)f(STDERR)f($Messages{'DBIHEADER'}->\()354
4817 y("RETRIEVING)g(HASH)h(from)g(TABLE)g(\\"$table\\""\);)155
4916 y(my)g(\($ssth,@ary\);)155 5016 y(my)g($aryfld_len)f(=)i($#{)f
($aryfld)f(};)155 5116 y(my)h($sstr)g(=)h(qq{)354 5215
y(SELECT)f(@{[)g(join\(',)f(',@{$aryfld}\))g(]})703 5315
y(FROM)h($table)354 5415 y(};)155 5514 y(print)g(STDERR)f
($Messages{'DBICMD'}->\("$sstr"\);)155 5614 y($ssth)h(=)g
($dbh->prepare\($sstr\);)155 5713 y($ssth->execute\(\);)155
5813 y(while)g(\(@ary)f(=)i($ssth->fetchrow_array\(\)\))45
b({)354 5913 y(\045{)k($href->{$ary[0]})e(})j(=)f(map)h({)f
($aryfld->[$_])f(=>)h($ary[$_])p Black -128 6076 V -128
6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 50 55
50 54 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.1.)22 b Fx(Interacting)27 b(with)c(MySQL)2112
b FG(50)p -128 -243 4016 9 v Black 1848 35 a Fu(})50
b(\(1..$aryfld_len\);)155 134 y(};)f(#)h(while)f(@ary)155
234 y(print)g(STDERR)f($Messages{'DBIMSG'}->\()354 334
y("",\(scalar)g(\(keys)h(\045{$href}\)\).")e(records)i(were)g
(retrieved...",""\);)155 433 y($ssth->finish\(\);)-45
533 y(})h(#)g(get_tbl_hash)-45 732 y(sub)g(get_row_fields\(\))d({)155
832 y(my)i(\($table,)f($outflds,)h($queryflds,)e($queryvals\))h(=)i
(@_;)155 931 y(my)f(\($ssth,$sstr,$fldstr,$valstr,$q_len,)o(@out\))o(;)
155 1031 y(#)g(ensure)g(that)g(both)g(arys)g(\($queryflds)f(&)i
($queryvals\))155 1131 y(#)149 b(have)49 b(same)g(length)g(in)g
(calling)g(function/script,)e(and)i(that)g(are)g(paired)g(too...)155
1230 y($q_len)f(=)i(&min\($#{)e($queryflds)g(},)i($#{)f($queryvals)f
(}\);)155 1330 y($fldstr)g(=)i(join\(',)e(',@{$outflds}\);)155
1429 y($valstr)g(=)i("";)155 1529 y(for)f(\(my)g($i)h(=)f(0;)h($i)f(<=)
h($q_len;)e($i++\))h({)304 1629 y($valstr)g(.=)g("$queryflds->[$i])e(=)
i(".\($dbh->quote\($queryvals->[$i]\)\).")44 b(\\n";)155
1728 y(};)155 1828 y(chomp\($valstr\);)155 1928 y($valstr)k(=)i
(join\('\\n)746 b(AND)49 b(',)g(\(split)g(/\\n/og,)f($valstr\)\);)155
2027 y(print)h(STDERR)f($Messages{'DBIHEADER'}->\()354
2127 y("RETRIEVING)g(\\"$fldstr\\")f(ROW\(s\))i(from)g(TABLE)g
(\\"$table\\""\);)155 2227 y($sstr)g(=)g(qq{)354 2326
y(SELECT)g($fldstr)703 2426 y(FROM)g($table)703 2525
y(WHERE)g($valstr)354 2625 y(};)155 2725 y(print)g(STDERR)f
($Messages{'DBICMD'}->\("$sstr"\);)155 2824 y($ssth)h(=)g
($dbh->prepare\($sstr\);)155 2924 y($ssth->execute\(\);)155
3024 y(@out)g(=)g($ssth->fetchrow_array\(\);)155 3123
y($ssth->finish\(\);)155 3223 y(scalar\(@out\))e(>)j(0)g(||)f(do)g({)
354 3322 y(print)g(STDERR)g($Messages{'DBIMSG'}->\()553
3422 y("","NONE)g(rows)g(were)g(selected,)f(NONE)h(fields)g(were)g
(retrieved...",""\);)354 3522 y(return)g(\()g(undef)g(\);)155
3621 y(};)155 3721 y(print)g(STDERR)f($Messages{'DBIMSG'}->\()354
3821 y("",scalar\(@out\).")f(fields)h(were)h(retrieved...",""\);)155
3920 y(return)f(@out;)-45 4020 y(})i(#)g(get_row_fields)-45
4219 y(sub)g(get_DB_codes\(\))d({)155 4319 y(my)i(@sel_fields)f(=)i
(\(\);)155 4418 y(#)155 4518 y(#)f(Loading)g(Status)g(tables)155
4618 y(\045status)f(=)i(\(\);)155 4717 y(@sel_fields)d(=)100
b(qw\()49 b(id)h(code)f(descr)g(color)f(\);)155 4817
y(&get_tbl_hash\(\\\045status,)d('tb_status',)j(\\@sel_fields\);)155
4916 y(print)h(STDOUT)f(\(Data::Dumper->Dump\([)e(\\\045status)i(],)
1649 5016 y([)i(qw\()f(*status)f(\))i(]\)\);)155 5116
y(#)155 5215 y(#)f(Loading)g(Chromosome)f(tables)155
5315 y(\045chrs)h(=)g(\(\);)155 5415 y(@sel_fields)e(=)100
b(qw\()49 b(id)h(code)f(version)f(descr)h(\);)155 5514
y(&get_tbl_hash\(\\\045chrs,)d('tb_chromosome',)g(\\@sel_fields\);)-45
5614 y(#)249 b(foreach)49 b(my)g($key)g(\(keys)g(\045chrs\))g({)-45
5713 y(#)449 b(@sel_fields)47 b(=)100 b(qw\()49 b(id)g(code)h(length)e
(version)h(composition)f(descr)g(\);)-45 5813 y(#)449
b(&get_tbl_hash\(\\\045chrs,)45 b('tb_sequence',)j(\\@sel_fields\);)-45
5913 y(#)249 b(};)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 51 56
51 55 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.1.)22 b Fx(Interacting)27 b(with)c(MySQL)2112
b FG(51)p -128 -243 4016 9 v Black 105 35 a Fu(print)49
b(STDOUT)f(\(Data::Dumper->Dump\([)e(\\\045chrs)j(],)1599
134 y([)h(qw\()f(*chrs)g(\))h(]\)\);)155 234 y(#)155
334 y(#)f(Loading)g(Job)g(tables)155 433 y(\045jobs)g(=)g(\(\);)155
533 y(@sel_fields)e(=)100 b(qw\()49 b(id)h(code)f(descr)g(\);)155
632 y(&get_tbl_hash\(\\\045jobs,)d('tb_job',)i(\\@sel_fields\);)-45
732 y(#)200 b(print)48 b(STDOUT)h(\(Data::Dumper->Dump\([)d(\\\045jobs)
j(],)-45 832 y(#)1694 b([)50 b(qw\()f(*jobs)g(\))g(]\)\);)-45
931 y(})h(#)g(get_DB_codes)-45 1131 y(sub)g(put_row_fields\(\))d({)155
1230 y(my)i(\($table,)f($fields,)h($aryfld,)f($aryrow\))g(=)i(@_;)155
1330 y(my)f(\($q_len,$filter,$fldstr,$valstr,$set)o(str,)354
1429 y($usth,$ustr,$ssth,$sstr,$isth,$istr)o(,@tro)o(w,$cou)o(nt\);)155
1529 y(print)g(STDERR)f($Messages{'DBIHEADER'}->\()354
1629 y("UPDATING)g(FIELDS)h(for)g(TABLE)g(\\"$table\\""\);)155
1728 y($q_len)f(=)i(&min\($#{)e($aryfld)h(},)g($#{)h($aryrow)e(}\);)-45
1828 y(#)200 b(my)49 b(@setstr)f(=)i(\(\);)-45 1928 y(#)200
b(for)49 b(\(my)g($i)g(=)h(0;)g($i)f(<=)g($q_len;)g($i++\))g({)-45
2027 y(#)399 b(push)49 b(@setstr,)f
($aryfld->[$i].'='.\($dbh->quote\($aryr)o(ow->[$)o(i]\)\);)-45
2127 y(#)200 b(};)155 2227 y($filter)48 b(=)i(join\("\\n)845
b(AND)49 b(",)902 2326 y(\()h(map)f({)g($aryfld->[$_].'=?')e(})i(@{)h
($fields)e(})i(\)\);)155 2426 y($fldstr)e(=)i("\(".join\(',)e
(',@{$aryfld}\)."\)";)155 2525 y($valstr)g(=)i
("VALUES\(".join\(',',\('?'\))45 b(x)50 b(scalar\(@{)e($aryfld)g
(}\)\)."\)";)155 2625 y($setstr)g(=)i(join\(",\\n)945
b(",)902 2725 y(\()50 b(map)f({)g($_.'=?')g(})h(@{)f($aryfld)f(})i
(\)\);)-45 2824 y(#)200 b($setstr)48 b(=)i(join\(",\\n)944
b(",@setstr\);)155 2924 y($sstr)49 b(=)g(qq{)354 3024
y(SELECT)g(COUNT\(*\))397 b(/*)49 b(COUNT\(Saryfld->[Sfield]\))c(*/)703
3123 y(FROM)k($table)703 3223 y(WHERE)g($filter)148 b(/*)49
b(Saryfld->[Sfield]=Q)d(*/)354 3322 y(};)155 3422 y($istr)j(=)g(qq{)354
3522 y(INSERT)g($table)703 3621 y($fldstr)703 3721 y($valstr)f(/*)i
(adding)e(new)i(records)e(*/)354 3821 y(};)155 3920 y($ustr)h(=)g(qq{)
354 4020 y(UPDATE)g($table)703 4119 y(SET)g($setstr)703
4219 y(WHERE)g($filter)148 b(/*)49 b(Saryfld->[Sfield]=Q)d(*/)354
4319 y(};)155 4418 y(print)j(STDERR)f
($Messages{'DBICMD'}->\("$sstr$istr$ust)o(r"\);)155 4518
y($ssth)h(=)g($dbh->prepare\($sstr\);)155 4618 y(@trow)g(=)g(\(map)g({)
h($aryrow->[$_])d(})j(@{)f($fields)g(}\);)155 4717 y
($ssth->execute\(@trow\);)155 4817 y($count)f(=)i
($ssth->fetchrow_array\(\);)155 4916 y($ssth->finish\(\);)155
5016 y(if)f(\($count\))f({)354 5116 y(print)h(STDERR)g
($Messages{'DBIMSG'}->\()553 5215 y("","UPDATING)f(fields)g(on)i
(selected)e(record)h(from)g(\\"$table\\"...",""\);)354
5315 y($usth)g(=)g($dbh->prepare\($ustr\);)354 5415 y
($usth->execute\(@{)e($aryrow)h(},@trow\);)354 5514 y
($usth->finish\(\);)155 5614 y(})h(else)g({)354 5713
y(print)g(STDERR)g($Messages{'DBIMSG'}->\()553 5813 y("","INSERTING)f
(new)h(field)g(on)g(selected)f(record)h(from)g(\\"$table\\"...",""\);)
354 5913 y($isth)g(=)g($dbh->prepare\($istr\);)p Black
-128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g
(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 52 57
52 56 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.1.)22 b Fx(Interacting)27 b(with)c(MySQL)2112
b FG(52)p -128 -243 4016 9 v Black 354 35 a Fu($isth->execute\(@{)47
b($aryrow)h(}\);)354 134 y($isth->finish\(\);)155 234
y(};)-45 334 y(})i(#)g(put_row_fields)-45 533 y(1;)-128
829 y FD(B.1.4)91 b(Loading)23 b(administrati)o(v)o(e)j(tables)p
Black Black -415 990 a Fq(52a)180 b Fp(h)p FI(tangling:)19
b(mySQL)h(perl)h(scripts)g Fq(46b)p Fp(i)q Fo(+)p Ft(\021)-45
1089 y Fu(#)-45 1189 y(#)50 b(mySQL)f(perl)g(scripts:)f(loading)h
(mySQL)g(admin)g(tables)-45 1288 y(notangle)g(-R'MySQL:)f(Initialize)g
(administrative)f(tables')i(\\)155 1388 y($WORK/$nwfile.nw)e(|)i(cpif)g
($MySQLPAR/admin_db_Hsapiens.pl)44 b(;)-45 1488 y(is_exec)49
b($MySQLPAR/admin_db_Hsapiens.pl)44 b(;)-45 1587 y(#)p
Black Black -420 1787 a Fq(52b)181 b Fp(h)p FI(MySQL:)21
b(Initialize)f(administr)o(ative)f(tables)h Fq(52b)p
Fp(i)q Ft(\021)-45 1886 y Fp(h)p FI(PERL)h(shebang)d
Fq(83a)p Fp(i)-45 1986 y Fu(#)50 b(admin_db_Hsapiens.pl)-45
2085 y(#)-45 2185 y(use)g(strict;)-45 2285 y(#)g(use)f(lib)h
("$LIBPERL";)-45 2384 y(use)g(db_Hsapiens)d(qw\()j(:DEFAULT)e
(:AdminFunc)g(\);)-45 2484 y(#)i($MySQLPAR/$admfiles[$i].tbl)-45
2584 y(#)g(my)g(@admfiles)e(=)h(qw/)h(chrs)f(seqs)g(jobs)g(steps)g
(status)f(/;)-45 2683 y(#)-45 2783 y(use)i(global;)-45
2882 y($PROG)f(=)h('admin_db_Hsapiens.pl';)-45 2982 y(my)g
(\(\045PARAM,)e(\045tjobs\);)-45 3082 y($PARAM{LIBSTEP})f(=)j
($ENV{LIBSTEP})d(||)j(do)f({)354 3181 y(print)g(STDERR)g
($Messages{'ENVNOTDEF'}->\("MySQLPA)o(R"\);)354 3281
y(exit\(1\);)155 3381 y(};)-45 3580 y(\045CmdLineOpts)f(=)i(\()354
3679 y("version")e(=>)i(sub)f({)553 3779 y(print)g(STDERR)g("####)g
(Hi,)g(you)g(are)g(running)g($PROG)g(version)f(0.9alpha)h(...\\n";)553
3879 y(exit\(1\);)354 3978 y(})155 4078 y(\);)-45 4277
y(#)-45 4377 y(##)h(MAIN)-45 4476 y(&parse_cmdline\(\);)-45
4576 y(&program_started\($PROG\);)-45 4775 y(&connection_details\(\);)
-45 4975 y(&open_DB\(\);)-45 5174 y(&listing_tables\(\);)-45
5373 y(&load_status_tbl\("$MySQLPAR/status.tbl)o("\);)-45
5473 y(&load_chromosome_tbl\("$MySQLPAR/chrs.t)o(bl"\);)-45
5572 y(&load_sequences_tbl\("$MySQLPAR/seqs.tb)o(l"\);)-45
5672 y(&load_jobs_tbl\("$MySQLPAR/jobs.tbl"\);)-45 5871
y(&get_DB_codes\(\);)p Black -128 6076 V -128 6180 a
FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 53 58
53 57 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.1.)22 b Fx(Interacting)27 b(with)c(MySQL)2112
b FG(53)p -128 -243 4016 9 v Black -45 35 a Fu
(&count_tbl_elements\(*STDERR\);)-45 234 y(&close_DB\(\);)-45
433 y(&program_finished\($PROG\);)-45 533 y(exit\(0\);)-45
732 y(#)-45 832 y(##)50 b(SUBS)-45 931 y(sub)g(listing_tables\(\))d({)
155 1031 y(my)i(@k)h(=)f(&list_tables\(\);)155 1131 y(for)g(\(my)g
($n=0;)g($n<=$#k;)f($n++\))h({)354 1230 y(&show_tbl_desc\($k[$n],)d
(*STDERR\);)155 1330 y(};)-45 1429 y(})k(#)g(listing_tables)-45
1529 y(sub)g(load_status_tbl\(\))c({)155 1629 y(my)j($ifile)g(=)g
(shift;)155 1728 y(my)g(@rows)g(=)h(\(\);)155 1828 y(open\(IFILE,"<)d
($ifile"\);)155 1928 y(local)i($/)g(=)h("\\/\\/\\n";)155
2027 y(while)f(\(<IFILE>\))f({)354 2127 y(chomp;)354
2227 y(my)h(@r)h(=)f(\(\);)354 2326 y(my)g(@f)h(=)f(split)g(/\\n/og,)g
($_;)354 2426 y(foreach)f(my)i($l)f(\(@f\))g({)553 2525
y(next)g(if)h($l)f(=~)h(/^#/o;)553 2625 y(next)f(if)h($l)f(=~)h
(/^\\s*$/o;)553 2725 y($l)g(=~)f(s/^\\s+//o;)553 2824
y($l)h(=~)f(s/\\s+$//o;)553 2924 y(defined\($r[0]\))e(||)j(do)f({)752
3024 y(\($r[0],$r[1]\))f(=)h(\(split)g(/\\s+/o,)g($l,)g(2\);)752
3123 y(next;)553 3223 y(};)553 3322 y($r[2])g(.=)h("$l\\n";)354
3422 y(};)354 3522 y(push)f(@rows,)g([)g(@r)h(];)155
3621 y(};)155 3721 y(close\(IFILE\);)155 3821 y(my)f(@flds)g(=)h(qw\()f
(id)g(color)g(descr)g(\);)155 3920 y(my)g(\($tbl,)g(@fld\))g(=)g(qw\()h
(tb_status)e(0)h(\);)155 4020 y(&load_to_tbl_ifdef\($tbl,)c(\\@fld,)k
(\\@flds,)f(\\@rows\);)-45 4119 y(})i(#)g(load_status_tbl)-45
4219 y(sub)g(load_chromosome_tbl\(\))c({)155 4319 y(my)j($ifile)g(=)g
(shift;)155 4418 y(my)g(@rows)g(=)h(\(\);)155 4518 y(my)f($gpver)g(=)g
(\224;)155 4618 y(open\(IFILE,"<)e($ifile"\);)155 4717
y(while)i(\(<IFILE>\))f({)354 4817 y(my)h(@f;)354 4916
y(next)g(if)g(/^\\s*$/o;)354 5016 y(/^#/o)g(&&)g(do)h({)553
5116 y(/^#>#\\s+\(.*?\)\\s*$/o)c(&&)k(\($gpver)e(=)i($1\);)553
5215 y(next;)354 5315 y(};)354 5415 y(chomp;)354 5514
y(s/^\\s+//o;)354 5614 y(s/\\s+$//o;)354 5713 y(@f)f(=)h(split)f
(/\\s+/og,)f($_,)h(3;)354 5813 y(\($f[1])g(eq)g('.')g(&&)h($gpver)e(ne)
i(\224\))f(&&)h(\($f[1])e(=)i($gpver\);)354 5913 y(push)f(@rows,)g([)g
(@f)h(];)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 54 59
54 58 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.1.)22 b Fx(Interacting)27 b(with)c(MySQL)2112
b FG(54)p -128 -243 4016 9 v Black 155 35 a Fu(};)155
134 y(close\(IFILE\);)155 234 y(my)49 b(@flds)g(=)h(qw\()f(id)g
(version)g(descr)g(\);)155 334 y(my)g(\($tbl,)g(@fld\))g(=)g(qw\()h
(tb_chromosome)d(0)j(\);)155 433 y(&load_to_tbl_ifdef\($tbl,)45
b(\\@fld,)k(\\@flds,)f(\\@rows\);)-45 533 y(})i(#)g
(load_chromosome_tbl)-45 632 y(sub)g(load_sequences_tbl\(\))c({)155
732 y(my)j($ifile)g(=)g(shift;)155 832 y(my)g
(\($ctbl,$cscode,@coflds,@cqflds,$stbl)o(,@sfl)o(d,@sof)o(lds,@)o
(sqflds)o(\);)155 931 y(\($ctbl,$stbl\))e(=)j(qw\()f(tb_chromosome)e
(tb_sequence)h(\);)155 1031 y(@coflds)g(=)i(qw\()f(code)g(\);)155
1131 y(@cqflds)f(=)i(qw\()f(id)h(\);)155 1230 y(@sfld)f(=)g(qw\()g(0)h
(1)g(\);)155 1330 y(@soflds)e(=)i(qw\()f(id)h(chr)f(length)f(version)h
(composition)f(descr)h(\);)155 1429 y(@sqflds)f(=)i(\(\);)155
1529 y(open\(IFILE,"<)d($ifile"\);)155 1629 y(while)i(\(<IFILE>\))f({)
354 1728 y(my)h(@f;)354 1828 y(next)g(if)g(/^\\s*$/o;)354
1928 y(next)g(if)g(/^#/o;)354 2027 y(chomp;)354 2127
y(s/^\\s+//o;)354 2227 y(s/\\s+$//o;)354 2326 y(@f)g(=)h(split)f
(/\\s+/og,)f($_,)h(5;)354 2426 y(\(@f[4,5]\))f(=)i(split)f
(/\\s+Desc:\\s+/o,)e($f[4],)h(2;)354 2525 y(\($cscode\))g(=)i
(&get_row_fields\($ctbl,)45 b(\\@coflds,)k(\\@cqflds,)f([)h($f[0])g
(]\);)354 2625 y(@f[0,1])f(=)i(\($f[1],$cscode\);)354
2725 y(push)f(@sqflds,)f([)i(@f)f(];)354 2824 y(printf)g(STDERR)f
("\045s\(\045d\))h(\045s)g(\045s)h(\045s\\n",@f[0..2,4,5];)155
2924 y(};)155 3024 y(close\(IFILE\);)155 3123 y(foreach)e(my)i($row)f
(\(@sqflds\))f({)354 3223 y(&put_row_fields\($stbl,)e(\\@sfld,)i
(\\@soflds,)g(\\@{)i($row)f(}\);)155 3322 y(};)-45 3422
y(#)200 b(my)49 b(@flds)g(=)g(qw\()h(id)f(version)g(descr)g(\);)-45
3522 y(#)200 b(my)49 b(\($tbl,)g(@fld\))g(=)g(qw\()g(tb_chromosome)f(0)
h(\);)-45 3621 y(#)200 b(&load_to_tbl_ifdef\($tbl,)45
b(\\@fld,)k(\\@flds,)f(\\@rows\);)-45 3721 y(})i(#)g
(load_sequences_tbl)-45 3821 y(sub)g(load_jobs_tbl\(\))d({)155
3920 y(my)i($ifile)g(=)g(shift;)155 4020 y(my)g
(\($jobcnt,$skipflg,\045thsh,$ljob\);)155 4119 y(open\(JFILE,"<)e
($ifile"\);)155 4219 y($jobcnt)h(=)i(0;)155 4319 y(\045tjobs)e(=)i
(\(\);)155 4418 y(\045thsh)f(=)g(\(\);)155 4518 y($ljob)g(=)g(\224;)155
4618 y($skipflg)f(=)i($F;)155 4717 y(while)f(\(<JFILE>\))f({)354
4817 y(my)h(\($name,$desc\);)354 4916 y(next)g(unless)g(/^#>#/o;)354
5016 y(chomp;)354 5116 y(\(undef,$name,$desc\))d(=)k(split)f(/\\s+/o,)f
($_,)h(3;)354 5215 y($desc)g(=~)g(s/\\s*$//o;)354 5315
y(\($name)g(eq)g('END_OF_JOB'\))e(&&)j(do)f({)553 5415
y($skipflg)g(||)g(do)g({)752 5514 y(foreach)g(my)g($k)h(\(keys)f
(\045thsh\))f({)952 5614 y($tjobs{$ljob}{$k})e(=)k($thsh{$k};)752
5713 y(};)752 5813 y(&replace_link_holders\(\\\045{)c($tjobs{$ljob})h
(},$ljob,undef,'JOB_XID'\);)752 5913 y(\045{)j
($tjobs{$ljob}{'JOB_STEPS'})45 b(})k(=)h(\(\);)p Black
-128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g
(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 55 60
55 59 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.1.)22 b Fx(Interacting)27 b(with)c(MySQL)2112
b FG(55)p -128 -243 4016 9 v Black 752 35 a Fu
($tjobs{$ljob}{'JOB_FILE'})46 b(=~)j(s{\(\\$\\{\(.+?\)\\}\)})2247
134 y({)g(defined\($PARAM{$2}\))2346 234 y(?)h($PARAM{$2})2346
334 y(:)g($1)2346 433 y(}ogex;)752 533 y
(&load_step_tbl\($ljob,$tjobs{$ljob}{'JO)o(B_FIL)o(E'},)1599
632 y(\\\045{)g($tjobs{$ljob}{'JOB_STEPS'})45 b(}\);)553
732 y(};)553 832 y(\045thsh)k(=)h(\(\);)553 931 y($skipflg)f(=)g($F;)
553 1031 y(next;)354 1131 y(};)354 1230 y(next)g(if)g($skipflg;)354
1330 y(\($name)g(eq)g('JOB_ID'\))f(&&)i(do)f({)553 1429
y($ljob)g(=)h($desc;)553 1529 y(defined\($tjobs{$ljob}\))c(||)j(do)h({)
752 1629 y(\045{)g($tjobs{$ljob})d(})j(=)g(\(\);)752
1728 y($tjobs{$ljob}{'JOB_CNT'})c(=)j($jobcnt++;)752
1828 y(next;)553 1928 y(};)553 2027 y($skipflg)g(=)g($T;)553
2127 y(next;)354 2227 y(};)354 2326 y(\($name)g(eq)g(':'\))g(&&)h(do)f
({)553 2426 y($thsh{'JOB_DESC'})e(.=)i(")h($desc";)553
2525 y(next;)354 2625 y(};)354 2725 y($thsh{$name})e(=)h($desc;)155
2824 y(};)-45 2924 y(#)200 b(print)48 b(STDOUT)h
(\(Data::Dumper->Dump\([)d(\\\045tjobs)i(],)-45 3024
y(#)1694 b([)50 b(qw\()f(*tjobs)f(\))i(]\)\);)155 3123
y(close\(JFILE\);)155 3223 y(&load_job_steps_tbl\(\\\045tjobs\);)-45
3322 y(})g(#)g(load_jobs_tbl)-45 3422 y(sub)g(load_step_tbl\(\))d({)155
3522 y(my)i(\($sjob,$ifile,$href\))d(=)k(@_;)155 3621
y(print)f(STDERR)f("\273\273\273\273\273\273\273)h($ifile\\n";)155
3721 y(my)g(\($stpcnt,$skipflg,$codeflg,\045thsh,$ls)o(tep\);)155
3821 y(open\(SFILE,"<)e($ifile"\);)155 3920 y($stpcnt)h(=)i(0;)155
4020 y(\045thsh)f(=)g(\(\);)155 4119 y($lstep)f(=)i(\224;)155
4219 y($skipflg)e(=)i($codeflg)e(=)i($F;)155 4319 y(while)f
(\(<SFILE>\))f({)354 4418 y(my)h(\($name,$desc,$go\);)354
4518 y($go)g(=)h(/^#>#/o)e(?)i($T)f(:)h($F;)354 4618
y(next)f(unless)g(\($go)g(||)g($codeflg\);)354 4717 y(\($codeflg)f(&&)i
(!$go\))e(&&)i(do)f({)553 4817 y($href->{$lstep}{'STEP_CODE'})c(.=)k
("$_";)553 4916 y(next;)354 5016 y(};)354 5116 y(chomp;)354
5215 y(\(undef,$name,$desc\))d(=)k(split)f(/\\s+/o,)f($_,)h(3;)354
5315 y($desc)g(=~)g(s/\\s*$//o;)354 5415 y(\($name)g(eq)g
('END_OF_STEP'\))e(&&)j(do)f({)553 5514 y($skipflg)g(||)g(do)g({)752
5614 y(foreach)g(my)g($k)h(\(keys)f(\045thsh\))f({)952
5713 y($href->{$lstep}{$k})e(=)k($thsh{$k};)752 5813
y(};)752 5913 y(&replace_link_holders\(\\\045{)c($href->{$lstep})h
(},$sjob,$lstep,)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 56 61
56 60 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.1.)22 b Fx(Interacting)27 b(with)c(MySQL)2112
b FG(56)p -128 -243 4016 9 v Black 952 35 a Fu
('STEP_XID','STEP_IDIR','STEP_ODIR')o(,'STE)o(P_EDIR)o(','ST)o(EP_CO)o
(DE'\);)-45 134 y(#)797 b(print)49 b(STDERR)g(join\("\\n",)-45
234 y(#)1345 b(\()50 b(map)f({)h('#\273>)f('.$_)g(})-45
334 y(#)1644 b(\()50 b(split)f(/\\n/o,)f($href->{$lstep}{'STEP_CODE'})d
(\))-45 433 y(#)1445 b(\))49 b(\)."\\n".\(':'x40\)."\\n";)553
533 y(};)553 632 y(\045thsh)g(=)h(\(\);)553 732 y($skipflg)f(=)g
($codeflg)f(=)i($F;)553 832 y(next;)354 931 y(};)354
1031 y(next)f(if)g($skipflg;)354 1131 y(\($name)g(eq)g('STEP_ID'\))f
(&&)h(do)h({)553 1230 y($lstep)f(=)h($desc;)553 1330
y(defined\($href->{$lstep}\))c(||)j(do)g({)752 1429 y(\045{)h
($href->{$lstep})d(})j(=)f(\(\);)752 1529 y
($href->{$lstep}{'STEP_CNT'})c(=)50 b($stpcnt++;)752
1629 y(next;)553 1728 y(};)553 1828 y($skipflg)f(=)g($T;)553
1928 y(next;)354 2027 y(};)354 2127 y(\($name)g(eq)g(':'\))g(&&)h(do)f
({)553 2227 y($thsh{'STEP_DESC'})e(.=)i(")h($desc";)553
2326 y(next;)354 2426 y(};)354 2525 y(\($name)f(eq)g('STEP_CODE'\))f
(&&)h(do)h({)553 2625 y($codeflg)f(=)g($T;)553 2725 y(next;)354
2824 y(};)354 2924 y($thsh{$name})f(=)h($desc;)155 3024
y(};)155 3123 y(close\(SFILE\);)-45 3223 y(})h(#)g(load_step_tbl)-45
3322 y(sub)g(replace_link_holders\(\))45 b({)155 3422
y(my)k(\($href,$kjob,$kstp,@chk_keys\))c(=)k(@_;)155
3522 y(foreach)f(my)i($k)f(\(@chk_keys\))f({)354 3621
y($href->{$k})g(=~)h(s{\\$\\<\(.*?\){\(.*?\)}{\(.*?\)}\(?:{\(.*?\)}\))o
(?\\>})553 3721 y({)h(&get_link_vals\($kjob,)c($kstp,)i($1,)i($2,)1400
3821 y(\(defined\($4\))e(?)h(\($4,)g($3\))h(:)f(\($3,)g(undef\)\)\);)f
(}gex;)155 3920 y(};)-45 4020 y(})i(#)g(replace_link_holders)-45
4119 y(sub)g(get_link_vals\(\))d({)155 4219 y(my)i
(\($j,$s,$v,$vj,$vv,$vs\))d(=)j(@_;)155 4319 y(my)g($out;)155
4418 y($vj)g(eq)g('.')h(&&)f(\($vj)g(=)h($j\);)155 4518
y(defined\($vs\))d(&&)j(do)f({)354 4618 y($vs)g(eq)h('.')f(&&)g(\($vs)g
(=)h($s\);)354 4717 y($out)f(=)h($tjobs{$vj}{'JOB_STEPS'}{$vs}{$vv)o
(};)354 4817 y(print)f(STDERR)g("-->)g($v)g(:)h($out\\n";)354
4916 y(return)f($out;)155 5016 y(};)155 5116 y($out)g(=)g
($tjobs{$vj}{$vv};)155 5215 y(print)g(STDERR)f("-->)h($v)h(:)f
($out\\n";)155 5315 y(return)f($out;)-45 5415 y(})i(#)g(get_link_vals)
-45 5514 y(sub)g(load_job_steps_tbl\(\))c({)155 5614
y(my)j($href)g(=)h(shift;)155 5713 y(my)f
(\(@rows,@flds,$tbl,@fld,@oflds,@qryfl)o(ds,@q)o(ryvals)o(\);)155
5813 y(#)g(load)g(jobs)155 5913 y(@rows)g(=)g(map)99
b({)50 b($_->[1])e(})p Black -128 6076 V -128 6180 a
FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 57 62
57 61 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.2.)22 b Fx(Step)i(processing)i(script:)31 b FB(stepper.pl)1610
b FG(57)p -128 -243 4016 9 v Black 553 35 a Fu(sort)49
b({)h($a->[0])e(<=>)i($b->[0])e(})553 134 y(map)99 b({)50
b([)g($href->{$_}{'JOB_CNT'},)1002 234 y([)f($_,)g
($href->{$_}{'JOB_XID'},)1300 334 y($href->{$_}{'JOB_PATH'},)1300
433 y($href->{$_}{'JOB_DESC'})d(])902 533 y(])k(})553
632 y(\(keys)f(\045{)h($href)e(}\);)155 732 y(@flds)h(=)g(qw\()g(id)h
(jxid)f(path)g(descr)g(\);)155 832 y(\($tbl,)f(@fld\))h(=)h(qw\()f
(tb_job)g(0)g(\);)155 931 y(&load_to_tbl_ifdef\($tbl,)c(\\@fld,)k
(\\@flds,)f(\\@rows,)h($T\);)155 1031 y(#)g(load)g(steps)155
1131 y(@rows)g(=)g(\(\);)155 1230 y(@oflds)f(=)i(qw\()f(code)g(\);)155
1330 y(@qryflds)f(=)i(qw\()f(id)g(\);)155 1429 y(foreach)f(my)i($k)f
(\(keys)g(\045{)g($href)g(}\))h({)354 1529 y(my)f
(\(@trows,$jcode,$tref\);)354 1629 y(@qryvals)f(=)i(\()g($k)f(\);)354
1728 y(\($jcode\))f(=)i(&get_row_fields\($tbl,)c(\\@oflds,)i
(\\@qryflds,)g(\\@qryvals\);)354 1828 y($tref)h(=)g(\\\045{)h
($href->{$k}{'JOB_STEPS'})45 b(};)354 1928 y(@trows)k(=)g(map)99
b({)50 b($_->[1])e(})802 2027 y(sort)h({)h($a->[0])e(<=>)i($b->[0])e(})
802 2127 y(map)99 b({)50 b([)g($tref->{$_}{'STEP_CNT'},)1251
2227 y([)f($_,)g($jcode,)1350 2326 y($tref->{$_}{'STEP_XID'},)1350
2426 y($tref->{$_}{'STEP_PATH'},)1350 2525 y($tref->{$_}{'STEP_IDIR'},)
1350 2625 y($tref->{$_}{'STEP_ODIR'},)1350 2725 y
($tref->{$_}{'STEP_EDIR'},)1350 2824 y($tref->{$_}{'STEP_DESC'},)1350
2924 y($tref->{$_}{'STEP_CODE'})d(])1151 3024 y(])k(})802
3123 y(\(keys)f(\045{)h($tref)e(}\);)354 3223 y(push)h(@rows,)g
(@trows;)155 3322 y(};)g(#)h(foreach)e(my)i($k)155 3422
y(@flds)f(=)g(qw\()g(id)h(job)f(sxid)g(path)g(idir)g(odir)g(edir)g
(descr)g(script)g(\);)155 3522 y(\($tbl,)f(@fld\))h(=)h(qw\()f(tb_step)
g(0)g(1)h(\);)155 3621 y(&load_to_tbl_ifdef\($tbl,)45
b(\\@fld,)k(\\@flds,)f(\\@rows,)h($T\);)-45 3721 y(#)150
b(print)49 b(STDOUT)f(\(Data::Dumper->Dump\([)e(\\@rows)j(],)-45
3821 y(#)1644 b([)50 b(qw\()f(*rows)g(\))g(]\)\);)-45
3920 y(})h(#)g(load_jobs_tbl)-128 4219 y FL(B.2)100 b(Step)26
b(pr)n(ocessing)g(script:)31 b Fb(stepper.pl)p Black
Black -415 4380 a Fq(57a)180 b Fp(h)p FI(tangling:)19
b(perl)h(scripts)i Fq(31a)p Fp(i)q Fo(+)o Ft(\021)-45
4480 y Fu(#)-45 4579 y(#)50 b(mySQL)f(perl)g(scripts:)f(loading)h
(mySQL)g(admin)g(tables)-45 4679 y(notangle)g(-R'Step)f(Execution)g
(Script')h(\\)155 4779 y($WORK/$nwfile.nw)e(|)i(cpif)g($BIN/stepper.pl)
e(;)-45 4878 y(is_exec)i($BIN/stepper.pl)e(;)-45 4978
y(#)p Black Black -420 5177 a Fq(57b)181 b Fp(h)p FI(Step)20
b(Execution)f(Script)h Fq(57b)p Fp(i)r Ft(\021)-45 5277
y Fp(h)p FI(PERL)h(shebang)d Fq(83a)p Fp(i)-45 5376 y
Fu(#)50 b(stepper.pl)-45 5476 y(#)-45 5576 y(#)g(USAGE:)-45
5675 y(#)100 b(stepper.pl)48 b([)h(-chr)99 b(chr_0,...,chr_c)795
b(-chr)98 b(chr_cc)398 b(])-45 5775 y(#)648 b([)49 b(-seq)99
b(chr_c:seq_0,...,chr_c:seq_q)195 b(-seq)98 b(chr_c:seq_qq)g(])-45
5875 y(#)648 b([)49 b(-job)99 b(job_0,...,job_j)795 b(-job)98
b(job_jj)398 b(])p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 58 63
58 62 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.2.)22 b Fx(Step)i(processing)i(script:)31 b FB(stepper.pl)1610
b FG(58)p -128 -243 4016 9 v Black -45 35 a Fu(#)648
b([)49 b(-step)g(job_j:step_0,...,job_j:step_s)95 b(-step)48
b(job_j:step_ss)g(])-45 134 y(#)747 b(-param)49 b(<param_file>)-45
234 y(#)747 b(-)50 b(<jobs_file>)-45 334 y(#)-45 433
y(#)g(if)g(no)f(chr)g(or)h(seq)f(are)g(given)g(then)g(job)g(is)h(done)f
(for)g(all)g(seqs)g(on)h(every)f(chr.)-45 533 y(#)h(if)g(no)f(job)g(or)
h(step)f(are)g(given)g(then)g(all)g(steps)g(in)g(all)h(jobs)f(are)g
(done)g(for)g(each)g(seq.)-45 632 y(#)h(<param_file>)e(contains)g(all)h
(shell)g(definitions)f(to)h(make)g(child)g(shells)-45
732 y(#)150 b(runnable)48 b(anywhere)g(\(exported)g(variables,)g(shell)
h(functions,)f(...\).)-45 832 y(#)i(jobs)f(file)-45 931
y(use)h(strict;)-45 1031 y(#)-45 1131 y Fp(h)p FI(Use)22
b(Modules)d(-)i(Dumper)f Fq(84a)p Fp(i)-45 1230 y(h)p
FI(stepper)-9 b(.pl:)20 b(Use)h(modules)e Fq(59d)p Fp(i)-45
1330 y Fu(#)-45 1429 y(use)50 b(db_Hsapiens;)-45 1529
y(#)-45 1629 y(use)g(global;)-45 1728 y($PROG)f(=)h('stepper.pl';)-45
1928 y(#)g($MySQLPAR/$admfiles[$i].tbl)-45 2027 y(#)g(my)g(@admfiles)e
(=)h(qw/)h(chrs)f(seqs)g(jobs)g(steps)g(status)f(/;)-45
2227 y(&init_signals\(\);)-45 2326 y(&init_timer\(\\@exectime\);)-45
2525 y(#)-45 2625 y(##)i(VARS)-45 2725 y(my)g
(\($pre_code,$post_code\);)-45 2824 y($pre_code)f(=)g
(\253'+++EOPre+++';)-45 2924 y Fp(h)p FI(B)n(ASH)20 b(shebang)f
Fq(85d)p Fp(i)-45 3024 y Fu(#)-45 3123 y(###)50 b(SCRIPT)e(HEADER)-45
3223 y(#)-45 3322 y(+++EOPre+++)-45 3422 y($post_code)g(=)i
(\253'+++EOPre+++';)-45 3522 y(#)-45 3621 y(###)g(SCRIPT)e(TRAILER)-45
3721 y(#)-45 3821 y(TheEnd)h(OK;)-45 3920 y(+++EOPre+++)-45
4119 y(my)h(\045filter)e(=)i(\()g('CHR')f(=>)g([],)g('SEQ')g(=>)h([],)f
('JOB')g(=>)g([],)g('STP')g(=>)h([])f(\);)-45 4219 y(my)h($paramfile)e
(=)h(\224;)-45 4319 y(\()h(defined\($ENV{WORK}\))c(&&)55
4418 y(\()k(-e)f($ENV{WORK}/.project_VARS)c(&&)50 b(-r)f(_)h(\))55
4518 y(\))g(&&)f(\($paramfile)f(=)i("$ENV{WORK}/.project_VARS"\);)-45
4618 y(\045CmdLineOpts)e(=)i(\()155 4717 y("c|chr=s")98
b(=>)49 b(\\@{)g($filter{CHR})f(},)155 4817 y("q|seq=s")98
b(=>)49 b(\\@{)g($filter{SEQ})f(},)155 4916 y("j|job=s")98
b(=>)49 b(\\@{)g($filter{JOB})f(},)155 5016 y("s|step=s")g(=>)h(\\@{)g
($filter{STP})f(},)155 5116 y("p|param=s")f(=>)j(\\$paramfile,)155
5215 y("version")98 b(=>)49 b(sub)g({)553 5315 y(print)g(STDERR)g
("####)g(Hi,)g(you)g(are)g(running)g($PROG)g(version)f(0.9alpha)h
(...\\n";)553 5415 y(exit\(1\);)354 5514 y(},)155 5614
y(\);)-45 5713 y Fp(h)p FI(stepper)-9 b(.pl:)20 b(fork)o(ed)g(c)o
(hilds)g(r)m(elated)f(var)o(s)i Fq(62)p Fp(i)-45 5813
y(h)p FI(stepper)-9 b(.pl:)20 b(global)f(var)o(s)i Fq(63a)p
Fp(i)p Black -128 6076 V -128 6180 a FK(Genome)f(Inf)n(ormatics)g
(Resear)o(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h
(Guig\363,)e(R)1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black
eop
%%Page: 59 64
59 63 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.2.)22 b Fx(Step)i(processing)i(script:)31 b FB(stepper.pl)1610
b FG(59)p -128 -243 4016 9 v Black -45 35 a Fu(#)-45
134 y(##)50 b(MAIN)-45 234 y(&parse_cmdline\(\);)-45
334 y(&program_started\($PROG\);)-45 533 y(&get_param\($paramfile\);)
-45 632 y(my)g($stepfls)e(=)i(shift)f(@ARGV;)-45 732
y(&get_steps\($stepfls\);)-45 931 y(&set_filter\(\\\045filter\);)-45
1131 y(&open_DB\(\);)-45 1230 y(&get_DB_codes\(\);)e(#)j(sets)f
(\045chr,)g($chr{}{seqs},)e(\045job,)i($job{}{steps},)e(@chrs,)i(@jobs)
-45 1429 y(while)g(\(!$skip_next\))f({)155 1529 y
(&brown_dispatcher\(\);)-45 1629 y(};)-45 1828 y(&close_DB\(\);)-45
2027 y(&program_finished\($PROG\);)-45 2127 y(exit\(0\);)-45
2326 y(#)-45 2426 y(##)i(SUBS)-45 2525 y Fp(h)p FI(stepper)-9
b(.pl:)20 b(subs)g Fq(59a)p Fp(i)-45 2625 y(h)p FI(stepper)-9
b(.pl:)20 b(job)g(sc)o(heduling)e(functions)h Fq(60)p
Fp(i)p Black Black -415 2794 a Fq(59a)180 b Fp(h)p FI(stepper)-9
b(.pl:)20 b(subs)g Fq(59a)p Fp(i)q Ft(\021)-45 2893 y
Fu(sub)50 b(get_param\(\))d({)155 2993 y(my)i($ifile)g(=)g(shift;)155
3093 y(open\(PFL,"<)e($ifile"\);)155 3192 y(while)i(\(<PFL>\))f({)354
3292 y(next)h(if)g(/^\\s*$/o;)354 3391 y($pre_code)f(.=)i($_;)155
3491 y(};)f(#)h(while)f(PFL)155 3591 y(close\(PFL\);)-45
3690 y(})h(#)g(get_param)p Black Black -420 3859 a Fq(59b)181
b Fp(h)p FI(stepper)-9 b(.pl:)20 b(subs)g Fq(59a)p Fp(i)q
Fo(+)p Ft(\021)-45 3959 y Fu(sub)50 b(set_filter\(\))d({)155
4058 y(my)i($href)g(=)h(shift;)155 4158 y(foreach)e(my)i($k)f(\(keys)g
(\045{$href}\))f({)354 4257 y(@{)h($href->{$k})f(})i(=)f
(split\(/,/,join\(',',@{)d($href->{$k})i(}\)\);)155 4357
y(};)155 4457 y(#)h(print)g(STDERR)g(\(Data::Dumper->Dump\([)d
(\\\045{$href})i(],)155 4556 y(#)1544 b([)49 b(qw\()h(*{$href})e(\))i
(]\)\);)-45 4656 y(})g(#)g(set_filter)p Black Black -415
4825 a Fq(59c)180 b Fp(h)p FI(stepper)-9 b(.pl:)20 b(subs)g
Fq(59a)p Fp(i)q Fo(+)p Ft(\021)-45 4924 y Fu(sub)50 b(get_steps\(\))d
({)-45 5024 y(})j(#)g(get_steps)-128 5297 y FD(B.2.1)91
b(F)n(orking)23 b(child)g(pr)n(ocesses)i(to)f(local/r)n(emote)j
(machines)-128 5471 y FG(The)38 b FB(&brown_dispatch)o(er)31
b FG(function)40 b(requires)g(a)e(semaphore)i(v)n(ariable)g(that)f
(controls)h(ho)n(w)e(man)o(y)g(childs)i(were)-128 5584
y(fork)o(ed,)d(so)c(we)f(can)h(fork)h(a)e(ne)n(w)g(one)i(once)f(an)o(y)
g(of)g(the)g(current)i(childs)f(job)f(has)g(\002nished)h(\(no)g(matter)
f(where...\).)56 b(W)-7 b(e)-128 5697 y(require)26 b(the)d(follo)n
(wing)i(package,)h(just)e(to)f(ha)n(v)o(e)h(such)h(v)n(ariable)g
(shared)g(among)f(the)g(running)i(child)e(processes.)p
Black Black -420 5831 a Fq(59d)181 b Fp(h)p FI(stepper)-9
b(.pl:)20 b(Use)h(modules)e Fq(59d)p Fp(i)q Ft(\021)-45
5930 y Fu(use)50 b(IPC::Shareable;)p Black -128 6076
V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 60 65
60 64 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.2.)22 b Fx(Step)i(processing)i(script:)31 b FB(stepper.pl)1610
b FG(60)p -128 -243 4016 9 v Black Black Black -382 35
a Fq(60)180 b Fp(h)p FI(stepper)-9 b(.pl:)20 b(job)g(sc)o(heduling)e
(functions)h Fq(60)p Fp(i)q Ft(\021)-45 134 y Fu(sub)50
b(brown_dispatcher\(\))c({)155 234 y(open\(FHERR,)h(">)j
($BASE/run.rpt"\);)155 334 y(print)f(FHERR)f("###)i(MAIN)f($gid)g(###)g
(BEGIN)g(MAIN)g(LOOP\\n".)752 433 y("###)h(MAIN)f($gid)g(###)g
(SEMAPHORE:)f(@semaphore\\n";)155 533 y(my)h($pending_seqs)f(=)h
(scalar\(@seqs\);)155 632 y(while)g(\($pending_seqs)e(>)i(0\))h({)f(#)h
(loop)f(through)g(sequences)354 732 y(for)g(\($sem)g(=)h(0;)f($sem)g(<)
h($maxjobs;)e($sem++\))g({)503 832 y($semaphore[$sem])f(||)j(do)f({)703
931 y(next)g(if)g(\(!)h(&is_host_there\($hosts[$sem]\)\);)703
1031 y(next)f(if)g($pending_seqs)f(==)h(0;)g(#)h(next)f(unless)g
(scalar\(@seqs\))e(>)j(0;)703 1131 y(&breed_crows\()d(shift)i(@seqs,)g
($sem\);)703 1230 y(push)g(@pids,)f($pid;)703 1330 y(-$pending_seqs;)
503 1429 y(};)i(#)f(if)h(job)f(semaphore)f(==)i(0)f(then)g(fork)g
(child)503 1529 y(&do_wait\(\);)354 1629 y(};)g(#)h(for)f
(semaphores...)155 1728 y(};)g(#)h(while)155 1828 y(while)f
(\(&all_done\(\\@semaphore\)\))c({)50 b(&do_wait\(\);)d(};)155
1928 y(print)i(FHERR)f("###)i(MAIN)f($gid)g(###)g(All)g(Jobs)g(ID:)g
(\\n)h(@pids)f(\\n".)752 2027 y("###)h(MAIN)f($gid)g(###)g(END)g(MAIN)g
(LOOP\\n";)155 2127 y(close\(FHERR\);)-45 2227 y(})h(#)g
(brown_dispatcher)-45 2326 y(#)-45 2426 y(sub)g(do_wait\(\))e({)155
2525 y(sleep)h(1;)g(#)h(select\(undef,undef,undef,1\);)155
2625 y(print)f(FHERR)f("###)i(MAIN)f($gid)g(###)g(SEMAPHORE:)f
(@semaphore\\n";)-45 2725 y(})i(#)g(do_wait)-45 2824
y(sub)g(all_done\(\))e({)155 2924 y(my)h($aryref)g(=)g(shift;)155
3024 y(my)g($sum)g(=)h(0;)155 3123 y($handle->shlock\(\);)155
3223 y(for)f(\(my)g($s)h(=)f(0;)h($s)f(<)h($maxjobs;)e($s++\))h({)354
3322 y($sum)g(+=)g($semaphore[$s];)155 3422 y(};)g(#)h(for)f
(semaphores...)155 3522 y($handle->shunlock\(\);)155
3621 y(return)f(\($sum>0\))h(?)g(1)h(:)g(0;)-45 3721
y(})g(#)g(all_done)-45 3821 y(sub)g(is_host_there\(\))d({)254
3920 y(my)j($host)f(=)g(shift;)254 4020 y(system\("rsh)f($host)h(exit)g
(0"\))g(==)h(0)99 b(&&)50 b(do)f({)454 4119 y(print)f(FHERR)h("###)g
(MAIN)g($gid)h(###)f(Connection)f(to)h($host)g(available...\\n";)454
4219 y(return)f(1;)254 4319 y(};)254 4418 y(print)h(FHERR)g("###)g
(MAIN)g($gid)g(###)h(UNREACHEABLE)d(\\"$host\\",)h(SKIPPING)g(!!!\\n";)
254 4518 y(return)h(0;)-45 4618 y(})h(#)g(is_host_there)-45
4717 y(sub)g(breed_crows\(\))d({)155 4817 y(my)i
(\($run_at,$script,$scriptx,$script_st)o(at,$p)o(re_job)o(,$clh)o
(pid,$s)o(yserr)o(\);)155 4916 y(my)g(\($seq,$pos\))f(=)i(@_;)155
5016 y(return)e(if)i($pid)f(=)h(fork\(\);)e(#)i(return)e(to)i(parent,)e
(follows)h(child)g(code)155 5116 y($clhpid)f(=)i("$$.$gid";)155
5215 y(&mod_semaphore\($pos,$clhpid\);)155 5315 y(print)f(FHERR)f("##)i
($clhpid)e(##)i(Running)e(child)h(process)g(jobs)g(on)g(sequence)f
(\\"$seq\\".\\n";)155 5415 y(foreach)g(my)i($jobs)f(\(@idjobs\))f({)354
5514 y(&mark_DB_exec_todo\($thejob\);)354 5614 y(my)h
(\($thejob,@thesteps\))e(=)i(@{)h($jobs)f(};)354 5713
y(if)g(\($skip_next[0]\))e({)553 5813 y($script_stat)h(=)h
($status{'SKIPPED'}{'code'};)354 5913 y(})h(else)f({)p
Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o
(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)
1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 61 66
61 65 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.2.)22 b Fx(Step)i(processing)i(script:)31 b FB(stepper.pl)1610
b FG(61)p -128 -243 4016 9 v Black 553 35 a Fu($script_stat)48
b(=)h($status{'RUNNING'}{'code'};)553 134 y
(&update_DB_exec_tbl\($script_stat,$ch)o(rseq_c)o(ode,$)o(jobste)o
(p_cod)o(e,)1549 234 y($clhpid,undef,undef\);)553 334
y($script)99 b(=)49 b("$BASE/tmp/$clhpid.$job";)553 433
y($scriptx)g(=)g("$script.exit";)553 533 y(###)553 632
y($pre_job)g(=)g(\253"+++EOPre+++";)-45 732 y(#)-45 832
y(###)h(CURRENT)e(PROCESS)h(DEFS)-45 931 y(#)-45 1031
y(CHR=)h($chr)f(;)-45 1131 y(SEQ=)h($seq)f(;)-45 1230
y(JOB=)h($job)f(;)-45 1330 y(STEP=)g($step)g(;)-45 1429
y(XID=)h(;)-45 1529 y(MPID=)f($clhpid)g(;)-45 1629 y
(CHRDIR="\\$HUMUS/\\$CHR")d(;)-45 1728 y
(JOBDIR="\\$CHRDIR/\\$JOB/\\$XID")f(;)-45 1828 y(IDIR=)99
b(;)-45 1928 y(ODIR=)g(;)-45 2027 y(EDIR=)g(;)-45 2127
y(PSRF=)49 b($scriptx)g(;)g(#)h(Process)e(Status)h(Reporter)f(File)-45
2227 y(#)-45 2326 y(export)h(CHR)g(SEQ)h(JOB)f(STEP)g(XID)g(MPID)g
(CHRDIR)g(JOBDIR)g(IDIR)g(ODIR)g(EDIR)g(PSRF)g(;)-45
2426 y(#)-45 2525 y(#)h(Making)f(directories)-45 2625
y(CheckDirs)g(\\$ODIR)f(;)-45 2725 y([)i("\\$EDIR")e(!=)i("\\$ODIR")e
(])i(&&)f(CheckDirs)f(\\$EDIR)h(;)-45 2824 y(#)-45 2924
y(###)h(SCRIPT)e(CODE)-45 3024 y(#)-45 3123 y(+++EOPre+++)553
3223 y(###)553 3322 y(if)i(\($hosts[$pos])d(ne)i($HOST\))g({)752
3422 y($run_at)g(=)h(\253"+++EOSCRIPT+++";)-45 3522 y(#)g(Run)f(script)
g(remotely)-45 3621 y({)h(rsh)f($hosts[$pos].imim.es)d($script)j(})h
(||)f(exit)g(10)g(;)503 3721 y(#)h(exit_code==10)d(if)j(RSH)f(fails)-45
3821 y(#)h(Returning)e(exit)h(status)g(from)g(executed)f(script)-45
3920 y(exit)i(\\`cat)e(\\$PSRF)h(2>)h(/dev/null)e(||)h(echo)g(3\\`)g(;)
503 4020 y(#)h(exit_code==3)e(if)h(cannot)g(open)g(PSRF)g
(\(UNAVAILABLE\))-45 4119 y(+++EOSCRIPT+++)553 4219 y(})h(else)f({)752
4319 y($run_at)g(=)h(\253"+++EOSCRIPT+++";)-45 4418 y(#)g(Run)f(script)
g(locally)-45 4518 y($script)g(;)-45 4618 y(#)h(Returning)e(exit)h
(status)g(from)g(executed)f(script)-45 4717 y(exit)i(;)248
b(#)50 b(exit_code)e(is)i(taken)e(from)i(last)f(executed)f(command)g
(\(script\))-45 4817 y(+++EOSCRIPT+++)553 4916 y(};)i(#)f(if)h
(\($hosts[$pos])d(ne)j($HOST\))553 5016 y(###)553 5116
y(print)f(FHERR)g("##)g($clhpid)g(##)g(Running)g(job)g(\\"$job\\")f(on)
i(sequence)e(\\"$seq\\".\\n";)553 5215 y(open\(TMP,">)g($script"\);)553
5315 y(print)h(TMP)g($pre_code.$pre_job.$jobscode{$job}.$p)o(ost_co)o
(de;)553 5415 y(close\(TMP\);)553 5514 y(###)553 5614
y($syserr)g(=)g(system)g(\253"+++EOFRSH+++")-45 5713
y(##)h(LAUNCH)f(JOB)-45 5813 y(/bin/chmod)f(a+x)i($script)e(;)-45
5913 y(#)i(Process)f(Status)f(Reporter)h(File)p Black
-128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g
(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 62 67
62 66 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.2.)22 b Fx(Step)i(processing)i(script:)31 b FB(stepper.pl)1610
b FG(62)p -128 -243 4016 9 v Black -45 35 a Fu(PSRF="$scriptx")47
b(;)-45 134 y(##)-45 234 y($run_at)-45 334 y(##)j(END)f(OF)h(JOB)-45
433 y(+++EOFRSH+++)553 533 y(unlink)f(\($script,)f($scriptx\);)553
632 y(###)454 732 y(#)h(print)g(FHERR)g($mesg{};)553
832 y($script_stat)f(=)h(&report_crow_status\($syserr,$job,$seq,)o
($clhp)o(id\);)354 931 y(};)g(#)h(else)f(if)h(!$skip_next[0])354
1031 y(&update_DB_exec_tbl\($script_stat,$c)o(hrseq)o(_code,)o($jobs)o
(tep_co)o(de,)1350 1131 y($clhpid,$stdout,$stderr\);)155
1230 y(};)f(#)h(foreach)e(job)155 1330 y(&mod_semaphore\($pos,0\);)155
1429 y(print)h(FHERR)f("##)i($clhpid)e(##)i(Child)f(process)f(is)h
(exiting)g(now!!!\\n";)155 1529 y(exit\(0\);)f(#)i(child)f(process)f
(exits)h(when)g(done)-45 1629 y(})h(#)g(breed_crows)-45
1728 y(sub)g(mod_semaphore\(\))d({)155 1828 y(my)i(\($p,$v\))g(=)g(@_;)
155 1928 y($handle->shlock\(\);)155 2027 y($semaphore[$p])e(=)j($v;)155
2127 y($handle->shunlock\(\);)-45 2227 y(})g(#)g(mod_semaphore)-45
2326 y(sub)g(report_crow_status\(\))c({)155 2426 y(my)j
(\($err,$job,$seq,$pid\))d(=)k(@_;)155 2525 y(my)f
(\($okflg,$emsg,$whatever\);)155 2625 y(\($okflg,$emsg,$err\))d(=)k
(&check_syscall_exit\($err\);)155 2725 y($err)f(=)g
($exit_codes{'CODES'}{$err};)155 2824 y
($exit_codes{$err}{MSG}->\($pid,$job)o(,$seq)o(\);)155
2924 y($whatever)f(=)h($skip_next[0])752 3024 y(?)h(\()g($skip_next[1])
d(?)j($status{'DIED'}{'code'})1649 3123 y(:)g
($status{'KILLED'}{'code'})45 b(\))752 3223 y(:)50 b(\()g($okflg)397
b(?)50 b($status{'DONE'}{'code'})1649 3322 y(:)g
($status{'CHECK'}{'code'})95 b(\);)155 3422 y(return)48
b($whatever;)-45 3522 y(})i(#)g(report_crow_status)-45
3621 y(sub)g(mark_DB_exec_todo\(\))c({)k(#)f(to)h(db_Hsapiens.pm)d(?)
105 3721 y(#)j($CDATE,$HOST,$USER;)105 3821 y
(&update_DB_exec_tbl\($status{'TODO'})o({'cod)o(e'},)1101
3920 y($chrseq_code,$jobstep_code,$clhpid,u)o(ndef,u)o(ndef\))o(;)-45
4020 y(})g(#)g(update_DB_exec_tbl)-45 4119 y(sub)g
(update_DB_exec_tbl\(\))c({)j(#)h(to)f(db_Hsapiens.pm)155
4219 y(my)g(\($stat,$cseq,$cstep,$ppid,$sout,$ser)o(r\))44
b(=)49 b(@_;)155 4319 y(my)g(\(@sel_fields,@data_fields,$tbl,@fld\))o
(;)155 4418 y(defined\($sout\))e(||)i(\($sout)g(=)h('NULL'\);)155
4518 y(defined\($serr\))d(||)i(\($serr)g(=)h('NULL'\);)155
4618 y(\($tbl,)e(@fld\))h(=)h(qw\()f(tb_exec)g(0)g(1)h(2)g(\);)155
4717 y(@sel_fields)d(=)100 b(qw\()49 b(chr_seq)g(job_step)f(exec_pid)
1101 4817 y(status)h(exec_date)f(host)h(user)g(stdout)g(stderr)g(\);)
155 4916 y(@data_fields)e(=)j(\()g($stat,)e($cseq,)h($cstep,)1002
5016 y($ppid,)f($CDATE,)h($HOST,)f($USER,)h("$sout",)f("$serr")h(\);)
155 5116 y(&put_row_fields\($tbl,)d(\\@fld,)i(\\@sel_fields,)g
(\\@data_fields\);)-45 5215 y(})i(#)g(update_DB_exec_tbl)p
Black Black -382 5415 a Fq(62)180 b Fp(h)p FI(stepper)-9
b(.pl:)20 b(fork)o(ed)g(c)o(hilds)g(r)m(elated)f(var)o(s)i
Fq(62)p Fp(i)q Ft(\021)-45 5514 y Fu(my)50 b
(\(\045hosts_list,@hosts,$hc,$gid,@pids,)o($pid,)o($maxj)o(obs,)155
5614 y($sem,$handle,@semaphore,$pending_s)o(eqs\);)-45
5713 y(@pids)f(=)h(\(\);)-45 5813 y($hc)g(=)f(0;)-45
5913 y(\045hosts_list)f(=)i(\()p Black -128 6076 V -128
6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 63 68
63 67 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.3.)22 b Fx(Shared)j(code:)30 b FB(global.pm)2016
b FG(63)p -128 -243 4016 9 v Black 55 35 a Fu(#)50 b(hostname)e(=>)h([)
h(order)149 b(numjobs)98 b(pbsflg)49 b(])155 134 y(monstre1)f(=>)h([)h
($hc++,)99 b(1,)348 b($F)249 b(],)155 234 y(monstre2)48
b(=>)h([)h($hc++,)99 b(1,)348 b($F)249 b(],)155 334 y(monstre3)48
b(=>)h([)h($hc++,)99 b(1,)348 b($F)249 b(],)155 433 y(monstre4)48
b(=>)h([)h($hc++,)99 b(2,)348 b($F)249 b(],)55 533 y(#)50
b(aleph)198 b(=>)49 b([)h($hc++,)99 b(1,)348 b($T)249
b(],)155 632 y(ik12)f(=>)49 b([)h($hc++,)99 b(1,)348
b($F)249 b(],)155 732 y(ik13)f(=>)49 b([)h($hc++,)99
b(1,)348 b($F)249 b(],)155 832 y(i8)348 b(=>)49 b([)h($hc++,)99
b(1,)348 b($F)249 b(],)155 931 y(i10)298 b(=>)49 b([)h($hc++,)99
b(1,)348 b($F)249 b(],)155 1031 y(i26)298 b(=>)49 b([)h($hc++,)99
b(1,)348 b($F)249 b(],)155 1131 y(\);)-45 1230 y(@hosts)49
b(=)h(map)99 b({)49 b(shift)g(@$_;)g(@$_)h(})404 1330
y(sort)f({)g($a->[0])g(<=>)g($b->[0])g(})404 1429 y(map)99
b({)49 b([)h($hosts_list{$_}[0],)c(\($_\))j(x)h($hosts_list{$_}[1])d(])
i(})404 1529 y(keys)g(\045hosts_list;)-45 1629 y($maxjobs)g(=)g
(scalar\(@hosts\);)-45 1728 y($gid)h(=)f($$;)-45 1828
y($handle)g(=)h(tie)f(@semaphore,)f('IPC::Shareable',)e(undef,)j({)h
(destroy)e(=>)i(1)f(};)-45 1928 y(@semaphore)f(=)i(\()g(0)f(\))h(x)g
($maxjobs;)-128 2223 y FD(B.2.2)91 b(Sequence)23 b(and)f(jobs)h(r)n
(elated)i(v)o(ars)p Black Black -415 2384 a Fq(63a)180
b Fp(h)p FI(stepper)-9 b(.pl:)20 b(global)f(var)o(s)i
Fq(63a)p Fp(i)q Ft(\021)-45 2483 y Fu(my)50 b
(\($BASE,@seqs,@jobs,\045jobscode\);)-45 2583 y($BASE)f(=)h
("/home/ug/jabril/development/projec)o(ts/sg)o(p/humu)o(s/tes)o(ts/chi)
o(lds";)-45 2683 y(@seqs)f(=)h(qw\()f(seq1)99 b(seq2)g(seq3)g(seq4)g
(seq5)g(seq6)f(seq7)h(seq8)g(seq9)g(seq10)553 2782 y(seq11)49
b(seq12)g(seq13)g(seq14)g(seq15)g(seq16)f(seq17)h(seq18)g(seq19)g
(seq20)g(\);)-45 2882 y(@jobs)g(=)h(qw\()f(job1)g(job2)g(job3)g(job4)g
(job5)h(\);)-45 2981 y(\045jobscode)f(=)g(\(\);)-128
3280 y FL(B.3)100 b(Shar)n(ed)27 b(code:)32 b Fb(global.pm)p
Black Black -420 3441 a Fq(63b)181 b Fp(h)p FI(tangling:)19
b(perl)h(modules)g Fq(63b)p Fp(i)q Ft(\021)-45 3540 y
Fu(#)-45 3640 y(#)50 b(mySQL)f(perl)g(scripts:)f(interacting)g(with)h
(mySQL)g(DB)-45 3740 y(notangle)g(-R'shared)f(functions)g(and)h
(settings')f(\\)155 3839 y($WORK/$nwfile.nw)f(|)i(cpif)g
($LIBPERL/global.pm)e(;)-45 3939 y(is_exec)i($LIBPERL/global.pm)d(;)-45
4038 y(#)p Black Black -415 4237 a Fq(63c)180 b Fp(h)p
FI(shar)m(ed)20 b(functions)g(and)f(settings)h Fq(63c)p
Fp(i)r Ft(\021)-45 4336 y Fp(h)p FI(PERL)h(shebang)d
Fq(83a)p Fp(i)-45 4436 y Fu(#)50 b(global.pm)-45 4536
y(#)-45 4635 y(package)f(global;)-45 4735 y(use)h(strict;)-45
4835 y(use)g(vars)f(qw\()503 4934 y(@ISA)g(@EXPORT)g(@EXPORT_OK)f
(\045EXPORT_TAGS)f($VERSION)503 5034 y($PLVER)i($PROG)g($USAGE)g($DATE)
g($CDATE)f($USER)h($HOST)503 5133 y($T)h($F)f(@skip_next)f(@exectime)g
($_verbose)g($_color_report)503 5233 y($ERRFH)h(\045Messages)f
(\045exit_codes)g($EXIT_REPORT_FILE)503 5333 y(\045CmdLineDefs)g
(\045CmdLineOpts)503 5432 y(\);)-45 5632 y(use)i(Exporter;)-45
5731 y($VERSION)f(=)g(1.00;)-45 5831 y(@ISA)h(=)f(qw\(Exporter\);)-45
5930 y(@EXPORT)g(=)h(qw\()p Black -128 6076 V -128 6180
a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 64 69
64 68 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.3.)22 b Fx(Shared)j(code:)30 b FB(global.pm)2016
b FG(64)p -128 -243 4016 9 v Black 503 35 a Fu($PLVER)49
b($PROG)g($USAGE)g($DATE)g($CDATE)f($USER)h($HOST)503
134 y($T)h($F)f(@skip_next)f(\045Messages)g($_verbose)g($_color_report)
g($ERRFH)503 234 y(&init_timer)g(&timing)h(@exectime)503
334 y(&init_signals)f(&trap_signals)f(&trap_signals_prog)503
433 y(&program_started)g(&program_finished)503 533 y(&parse_cmdline)h
(\045CmdLineDefs)f(\045CmdLineOpts)503 632 y(&check_syscall_exit)g
(&the_end)h(\045exit_codes)g($EXIT_REPORT_FILE)503 732
y(&check_file)g(&check_dir)503 832 y(&min)h(&max)503
931 y(\);)-45 1031 y(@EXPORT_OK)f(=)i(qw\()503 1131 y(&comment_line)e
(&header)g(&left_header)g(&right_header)503 1230 y(&fill_right)g
(&fill_left)g(&fill_mid)503 1330 y(\);)-45 1429 y(\045EXPORT_TAGS)g(=)i
(\()503 1529 y(#)g(ParseCMDLN)e(=>)h([)h(qw\()f(&parse_cmdline)e
(\045CmdLineDefs)h(\045CmdLineOpts)g(\))h(],)503 1629
y(StringFill)f(=>)i([)f(qw\()h(&fill_right)d(&fill_left)h(&fill_mid)h
(\))g(],)503 1728 y(ExitStatus)f(=>)i([)f(qw\()h(&check_syscall_exit)c
(&the_end)1500 1828 y(\045exit_codes)h($EXIT_REPORT_FILE)g(\))j(],)503
1928 y(\);)155 2027 y(#)f(AdminFunc)f(=>)i([)g(qw\()f
(&connection_details)d(&load_to_tbl_ifdef)h(\))i(],)155
2127 y(#)g(\);)-45 2227 y(#)h(use)f(lib)h("$LIBPERL";)-45
2426 y(###)-45 2525 y(###)g(Setting)e(Default)h(Variables)-45
2625 y(###)-45 2725 y($ERRFH)g(=)h(\\*STDERR;)-45 2824
y(\($T,$F\))f(=)h(\(1,0\);)-45 2924 y($PLVER)f(=)h
(sprintf\("v\045vd",$^V\);)-45 3024 y($PROG)99 b(=)50
b('UNDEF';)-45 3123 y($USAGE)f(=)h('WARNING:)e(Program)g(variable)h
("$USAGE")f(was)h(not)h(defined)e(yet...';)-45 3223 y($DATE)99
b(=)50 b(localtime;)-45 3322 y($CDATE)f(=)h
(sprintf\("\04504d\04502d\04502d\04502d\04502d\04502d")o(,)155
3422 y(sub)f({)h($_[5])e(+)i(1900,)f($_[4])g(+)g(1,)h($_[3],)f($_[2],)f
($_[1],)h($_[0])g(}->\(localtime\))e(\);)-45 3522 y(if)j
(\(defined\($ENV{USER}\)\))c({)155 3621 y($USER)j(=)g($ENV{USER};)-45
3721 y(})h(else)f({)155 3821 y(chomp\($USER)e(=)j(`whoami`\);)-45
3920 y(};)-45 4020 y(if)g(\(defined\($ENV{HOSTNAME}\)\))45
b({)155 4119 y($HOST)k(=)g($ENV{HOSTNAME};)-45 4219 y(})h(else)f({)155
4319 y(chomp\($HOST)e(=)j(`hostname`\);)-45 4418 y(};)-45
4518 y($HOST)f(=~)h(s/\\.imim\\.es$//o;)-45 4618 y(if)g
(\(defined\($ENV{PSRF}\)\))c({)155 4717 y($EXIT_REPORT_FILE)g(=)k
($ENV{PSRF};)-45 4817 y(})g(else)f({)155 4916 y($EXIT_REPORT_FILE)d(=)k
("/tmp/$$";)-45 5016 y(};)-45 5116 y Fp(h)p FI(global.pm:)19
b(messa)o(g)o(es)h Fq(66b)p Fp(i)-45 5215 y(h)p FI(global.pm:)f
(normalized)g(e)n(xit)i(codes)f Fq(74a)p Fp(i)-45 5415
y Fu(###)-45 5514 y(###)50 b(Shareable)e(functions)-45
5614 y(###)-45 5713 y Fp(h)p FI(global.pm:)19 b(timing)h
Fq(65a)p Fp(i)-45 5813 y(h)p FI(global.pm:)f(tr)o(apping)f(signals)i
Fq(65b)p Fp(i)-45 5913 y(h)p FI(global.pm:)f(r)m(eporting)g(messa)o(g)o
(es)i Fq(68)p Fp(i)p Black -128 6076 V -128 6180 a FK(Genome)f(Inf)n
(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f
(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20 b(6,)g(2002)p
Black eop
%%Page: 65 70
65 69 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.3.)22 b Fx(Shared)j(code:)30 b FB(global.pm)2016
b FG(65)p -128 -243 4016 9 v Black -45 35 a Fp(h)p FI(global.pm:)19
b(par)o(sing)g(command-line)f(ar)m(gs)i Fq(70)p Fp(i)-45
134 y(h)p FI(global.pm:)f(validate)g(\002le/dir)h Fq(72b)p
Fp(i)-45 234 y(h)p FI(global.pm:)f(c)o(hec)n(k)g(e)n(xit)i(status)g
(for)g(sys)g(calls)f Fq(72c)p Fp(i)-45 334 y(h)p FI(global.pm:)f
(normalized)g(e)n(xit)i Fq(73)p Fp(i)-45 433 y(h)p FI(global.pm:)e(g)o
(ener)o(al)g(functions)g Fq(75b)p Fp(i)-45 632 y Fu(#)-45
732 y(#)50 b(Exiting)f(from)g("global")f(package)-45
832 y(1;)-128 1127 y FD(B.3.1)91 b(T)n(iming)23 b(pr)n(ocesses)p
Black Black -415 1288 a Fq(65a)180 b Fp(h)p FI(global.pm:)19
b(timing)g Fq(65a)p Fp(i)r Ft(\021)-45 1388 y Fu(#)-45
1488 y(#)50 b(Timing)f(definitions)-45 1587 y(use)h(Benchmark;)-45
1687 y(@exectime)f(=)g(\(\);)-45 1787 y(sub)h(init_timer\(\))d({)155
1886 y(my)i($refary)g(=)g(shift;)155 1986 y(@{)g($refary)g(})g(=)h
(\(new)f(Benchmark\);)155 2085 y(return;)-45 2185 y(})h(#)g(init_timer)
-45 2285 y(sub)g(timing\(\))e({)155 2384 y(my)h(\($refary,$tmp\))e(=)j
(@_;)155 2484 y(my)f($flg)g(=)h(defined\($tmp\))d(||)j($F;)155
2584 y(push)f(@{)g($refary)g(})g(,)h(\(new)f(Benchmark\);)155
2683 y(my)g($mx)g(=)h($#{)f($refary)g(};)155 2783 y(#)g(partial)g(time)
155 2882 y($flg)g(||)g(do)h({)354 2982 y(return)f
(timestr\(timediff\($refary->[$mx],$)o(refary)o(->[\($)o(mx)44
b(-)50 b(1\)]\)\);)155 3082 y(};)155 3181 y(#)f(total)g(time)155
3281 y(return)f(timestr\(timediff\($refary->[$mx],$refa)o(ry->[0)o
(]\)\);)-45 3381 y(})i(#)g(timing)-128 3676 y FD(B.3.2)91
b(T)-7 b(rapping)23 b(system)h(signals)p Black Black
-420 3837 a Fq(65b)181 b Fp(h)p FI(global.pm:)19 b(tr)o(apping)f
(signals)i Fq(65b)p Fp(i)q Ft(\021)-45 3937 y Fu(#)-45
4036 y(#)50 b(Trapping)e(signals)-45 4136 y(sub)i(init_signals\(\))d({)
155 4236 y($SIG{HUP})98 b(=)49 b(\\&trap_signals_prog;)155
4335 y($SIG{ABRT})f(=)h(\\&trap_signals;)155 4435 y($SIG{INT})98
b(=)49 b(\\&trap_signals;)155 4535 y($SIG{QUIT})f(=)h(\\&trap_signals;)
155 4634 y($SIG{TERM})f(=)h(\\&trap_signals;)155 4734
y($SIG{KILL})f(=)h(\\&trap_signals;)155 4833 y($SIG{CHLD})f(=)h
('IGNORE';)f(#)i(child)f(processes)f(are)h(automatically)f(reaped)155
4933 y(@skip_next)g(=)h(\($F,)g(undef\);)-45 5033 y(})h(#)g
(init_signals)-45 5132 y(sub)g(trap_signals\(\))d({)155
5232 y(print)i($ERRFH)f($Messages{'USER_HALT'}->\($PROG\);)155
5332 y(@skip_next)g(=)h(\($T,)g($F\);)-45 5431 y(})h(#)g(trap_signals)
-45 5531 y(sub)g(trap_signals_prog\(\))c({)155 5631 y(print)j($ERRFH)f
($Messages{'PROCESS_HALT'}->\($PROG\);)155 5730 y(@skip_next)g(=)h
(\($T,)g($T\);)-45 5830 y(})h(#)g(trap_signals_prog)p
Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o
(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)
1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 66 71
66 70 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.3.)22 b Fx(Shared)j(code:)30 b FB(global.pm)2016
b FG(66)p -128 -243 4016 9 v Black Black Black -415 35
a Fq(66a)180 b Fp(h)p FI(global:)19 b(warnings)h(-)h(input/output)c
Fq(66a)p Fp(i)q Ft(\021)-45 134 y Fu(USER_HALT)198 b(=>)49
b(sub)h({)404 234 y(my)f($name)g(=)h(shift;)404 334 y(return)503
433 y(&header\()603 533 y($mlin{'warn_len'}->\(\),$mlin{'warn_b)o
(ase'}-)o(>\(\),)603 632 y($mlin{'warn_pre'}->\(\),$mlin{'warn_p)o
(ost'}-)o(>\(\),)603 732 y($mlin{'warn_line'}->\(\),$mlin{'empty)o
(_warn_)o(line')o(}->\(\),)603 832 y("$name)f(has)g(been)g(stopped)g
(by)g(user)g(!!!",)603 931 y("-------)f(Exiting)h(NOW)g(!!!)g
(-------",)603 1031 y($mlin{'empty_warn_line'}->\(\),$mlin{)o('warn_)o
(line')o(}->\(\),)603 1131 y(\);)205 1230 y(},)-45 1330
y(PROCESS_HALT)f(=>)h(sub)h({)404 1429 y(my)f($name)g(=)h(shift;)404
1529 y(return)503 1629 y(&header\()603 1728 y
($mlin{'warn_len'}->\(\),$mlin{'warn_b)o(ase'}-)o(>\(\),)603
1828 y($mlin{'warn_pre'}->\(\),$mlin{'warn_p)o(ost'}-)o(>\(\),)603
1928 y($mlin{'warn_line'}->\(\),$mlin{'empty)o(_warn_)o(line')o
(}->\(\),)603 2027 y("-----)f($name)g(is)g(down)g(!!!)g(-----",)603
2127 y("-------)f(Exiting)h(NOW)g(!!!)g(-------",)603
2227 y($mlin{'empty_warn_line'}->\(\),$mlin{)o('warn_)o(line')o
(}->\(\),)603 2326 y(\);)205 2426 y(},)-128 2721 y FD(B.3.3)91
b(Pr)n(ocessing)26 b(messages)p Black Black -420 2882
a Fq(66b)181 b Fp(h)p FI(global.pm:)19 b(messa)o(g)o(es)h
Fq(66b)p Fp(i)r Ft(\021)-45 2982 y Fu(#)-45 3082 y(#)50
b(Program)f(status)f(strings.)-45 3181 y($_verbose)h(=)g($F;)-45
3281 y($_color_report)f(=)h($F;)-45 3381 y(#)-45 3480
y(use)h(Term::ANSIColor;)-45 3580 y(my)g($_pre_flg)e(=)i($F;)-45
3679 y(my)g($term_width)e(=)h(80;)-45 3779 y(my)h(\045mlin)f(=)g(\()155
3879 y(error_base)247 b(=>)49 b(sub)h({)1151 3978 y(my)f($str)g(=)h
("\\<\\<\\<\\<)e(ERROR)h(\\>\\>\\>\\>";)1151 4078 y($_color_report)e
(&&)1350 4178 y(\($str)i(=)h(color\("bold)d
(red"\).$str.color\("reset"\)\);)1151 4277 y(return)i($str.")f(";)1051
4377 y(},)155 4476 y(error_pre)297 b(=>)49 b(sub)h({)1151
4576 y(my)f($str)g(=)h("\\<\\<\\<";)1151 4676 y($_color_report)d(&&)
1350 4775 y(\($str)i(=)h(color\("yellow"\).$str.color\("reset")o(\)\);)
1151 4875 y(return)f($str;)1051 4975 y(},)155 5074 y(error_post)247
b(=>)49 b(sub)h({)1151 5174 y(my)f($str)g(=)h("\\>\\>\\>";)1151
5273 y($_color_report)d(&&)1350 5373 y(\($str)i(=)h
(color\("yellow"\).$str.color\("reset")o(\)\);)1151 5473
y(return)f($str;)1051 5572 y(},)155 5672 y(error_len)297
b(=>)49 b(sub)h({)f(return)g(\($term_width)e(-)j(\()g(16)f(+)h(3)f(+)h
(3)g(\)\))f(},)254 5772 y(#)h(error_base)e(+)i(error_pre)e(+)h
(error_post)155 5871 y(warn_base)297 b(=>)49 b(sub)h({)p
Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o
(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)
1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 67 72
67 71 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.3.)22 b Fx(Shared)j(code:)30 b FB(global.pm)2016
b FG(67)p -128 -243 4016 9 v Black 1151 35 a Fu(my)49
b($str)g(=)h("\\<\\<\\<)f(WARNING)f(\\>\\>\\>";)1151
134 y($_color_report)f(&&)1350 234 y(\($str)i(=)h(color\("bold)d
(yellow"\).$str.color\("reset"\)\);)1151 334 y(return)i($str.")f(";)
1051 433 y(},)155 533 y(warn_pre)347 b(=>)49 b(sub)h({)1151
632 y(my)f($str)g(=)h("\\<\\<\\<";)1151 732 y($_color_report)d(&&)1350
832 y(\($str)i(=)h(color\("yellow"\).$str.color\("reset")o(\)\);)1151
931 y(return)f($str;)1051 1031 y(},)155 1131 y(warn_post)297
b(=>)49 b(sub)h({)1151 1230 y(my)f($str)g(=)h("\\>\\>\\>";)1151
1330 y($_color_report)d(&&)1350 1429 y(\($str)i(=)h
(color\("yellow"\).$str.color\("reset")o(\)\);)1151 1529
y(return)f($str;)1051 1629 y(},)155 1728 y(warn_len)347
b(=>)49 b(sub)h({)f(return)g(\($term_width)e(-)j(\()g(16)f(+)h(3)f(+)h
(3)g(\)\))f(},)254 1828 y(#)h(error_base)e(+)i(error_pre)e(+)h
(error_post)155 1928 y(comment_base)147 b(=>)49 b(sub)h({)f(return)g
("")g(},)155 2027 y(comment_pre)197 b(=>)49 b(sub)h({)1151
2127 y(my)f($str)g(=)h("###";)1151 2227 y($_color_report)d(&&)1350
2326 y(\($str)i(=)h(color\("green"\).$str.color\("reset"\))o(\);)1151
2426 y(return)f($str;)1051 2525 y(},)155 2625 y(comment_post)147
b(=>)49 b(sub)h({)1151 2725 y(my)f($str)g(=)h("###";)1151
2824 y($_color_report)d(&&)1350 2924 y(\($str)i(=)h
(color\("green"\).$str.color\("reset"\))o(\);)1151 3024
y(return)f($str;)1051 3123 y(},)155 3223 y(comment_len)197
b(=>)49 b(sub)h({)f(return)g(\($term_width)e(-)j(\()g(0)f(+)h(3)g(+)f
(3)h(\)\))f(},)254 3322 y(#)h(comment_base)e(+)h(comment_pre)f(+)i
(comment_post)155 3422 y(dbi_base)347 b(=>)49 b(sub)h({)1151
3522 y(my)f($str)g(=)h("###)f(";)1151 3621 y($_color_report)e(&&)1350
3721 y(\($str)i(=)h(color\("cyan"\).$str.color\("reset"\)\))o(;)1151
3821 y(return)f($str;)1051 3920 y(},)155 4020 y(dbi_pre)397
b(=>)49 b(sub)h({)1151 4119 y(my)f($str)g(=)h("MySQL)f(*";)1151
4219 y($_color_report)e(&&)1350 4319 y(\($str)i(=)h
(color\("cyan"\).$str.color\("reset"\)\))o(;)1151 4418
y(return)f($str;)1051 4518 y(},)155 4618 y(dbi_post)347
b(=>)49 b(sub)h({)1151 4717 y(my)f($str)g(=)h("*";)1151
4817 y($_color_report)d(&&)1350 4916 y(\($str)i(=)h
(color\("cyan"\).$str.color\("reset"\)\))o(;)1151 5016
y(return)f($str;)1051 5116 y(},)155 5215 y(dbi_len)397
b(=>)49 b(sub)h({)f(return)g(\($term_width)e(-)j(\()g(4)f(+)h(7)g(+)f
(1)h(\)\))f(},)254 5315 y(#)h(dbi_base)e(+)i(dbi_pre)e(+)i(dbi_post)155
5415 y(spacer)447 b(=>)49 b(sub)h({)f(return)g("###")g(},)155
5514 y(\);)-45 5614 y(#)-45 5713 y($mlin{'error_line'})e(=)i(sub)h({)
1151 5813 y(my)f($str)g(=)h(\('-')f(x)h($mlin{'error_len'}->\(\)\);)
1151 5913 y($_color_report)d(&&)p Black -128 6076 V -128
6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 68 73
68 72 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.3.)22 b Fx(Shared)j(code:)30 b FB(global.pm)2016
b FG(68)p -128 -243 4016 9 v Black 1350 35 a Fu(\($str)49
b(=)h(color\("yellow"\).$str.color\("reset")o(\)\);)1151
134 y(return)f($str;)1051 234 y(};)-45 334 y($mlin{'empty_error_line'})
d(=)j(sub)g({)h(return)f(\(')g(')h(x)f($mlin{'error_len'}->\(\)\))d(};)
-45 433 y(#)-45 533 y($mlin{'warn_line'})h(=)j(sub)f({)g(return)g
($mlin{'error_line'}->\(\))d(};)-45 632 y($mlin{'empty_warn_line'})g(=)
j(sub)h({)f(return)g($mlin{'empty_error_line'}->\(\))44
b(};)-45 732 y(#)-45 832 y($mlin{'comment_line'})i(=)k(sub)f({)1151
931 y(my)g($str)g(=)h(\("#")f(x)h($mlin{'comment_len'}->\(\)\);)1151
1031 y($_color_report)d(&&)1350 1131 y(\($str)i(=)h
(color\("green"\).$str.color\("reset"\))o(\);)1151 1230
y(return)f($str;)1051 1330 y(};)-45 1429 y($mlin{'empty_comment_line'})
c(=)50 b(sub)f({)h(return)e(\(')i(')f(x)h($mlin{'comment_len'}->\(\)\))
45 b(};)-45 1529 y(#)-45 1629 y($mlin{'dbi_line'})i(=)j(sub)f({)1151
1728 y(my)g($str)g(=)h(\("*")f(x)h($mlin{'dbi_len'}->\(\)\);)1151
1828 y($_color_report)d(&&)1350 1928 y(\($str)i(=)h
(color\("cyan"\).$str.color\("reset"\)\))o(;)1151 2027
y(return)f($str;)1051 2127 y(};)-45 2227 y($mlin{'empty_dbi_line'})d(=)
k(sub)f({)g(return)g(\(')h(')f(x)h($mlin{'dbi_len'}->\(\)\))c(};)-45
2326 y(#)-45 2426 y(\045Messages)j(=)g(\()155 2525 y(#)g(ERROR)g
(MESSAGES)155 2625 y Fp(h)p FI(global:)19 b(warnings)g(-)i(en)m(vir)l
(onment)e(settings)h Fq(69b)p Fp(i)155 2725 y(h)p FI(global:)f
(warnings)g(-)i(input/output)d Fq(66a)p Fp(i)155 2824
y(h)p FI(global:)h(warnings)g(-)i(par)o(sing)e(command-line)f(options)h
Fq(71b)p Fp(i)155 2924 y Fu(#)49 b(WORKING)g(MESSAGES)155
3024 y Fp(h)p FI(global:)19 b(messa)o(g)o(es)h(-)h(pr)l(o)o(gr)o(am)e
(start-stop)h Fq(69a)p Fp(i)155 3123 y(h)p FI(global:)f(messa)o(g)o(es)
h(-)h(inter)o(acting)e(with)h(DB)h Fq(69c)p Fp(i)155
3223 y(h)p FI(global:)e(messa)o(g)o(es)h(-)h(par)o(sing)e(command-line)
f(options)h Fq(71a)p Fp(i)105 3322 y Fu(\);)49 b(#)h(\045Messages)p
Black Black -382 3522 a Fq(68)180 b Fp(h)p FI(global.pm:)19
b(r)m(eporting)g(messa)o(g)o(es)i Fq(68)p Fp(i)q Ft(\021)-45
3621 y Fu(#)-45 3721 y(#)50 b(Reporting)e(program)h(status)f(and)i
(messages)-45 3821 y(sub)g(comment_line\(\))d({)155 3920
y(my)i(\($tlen,$base,$pre,@lns\))d(=)j(@_;)155 4020 y(my)g
(\($comment,$ln\);)155 4119 y(foreach)f($ln)h(\(@lns\))g({)354
4219 y($ln)g(=~)h(s/^$/)f(/o;)354 4319 y($comment)f(.=)i("$base$pre)e
($ln\\n";)354 4418 y(};)155 4518 y(return)g($comment;)-45
4618 y(})i(#)g(header)-45 4717 y(sub)g(header\(\))e({)155
4817 y(my)h(\($tlen,$base,$pre,$post,@lns\))c(=)k(@_;)155
4916 y(my)g($comment)f(=)i($_pre_flg)e(?)i($mlin{'spacer'}->\(\)."\\n")
45 b(:)50 b(\224;)155 5016 y($_pre_flg)e(||)h(\($_pre_flg)f(=)i($T\);)
155 5116 y(foreach)e(my)i($ln)f(\(@lns\))g({)354 5215
y($comment)f(.=)i("$base$pre".)952 5315 y(\(&fill_mid\($ln,$tlen,")45
b("\)\)."$post\\n";)354 5415 y(};)155 5514 y(return)j($comment;)-45
5614 y(})i(#)g(header)-45 5713 y(sub)g(left_header\(\))d({)155
5813 y(my)i(\($tlen,$base,$pre,$post,@lns\))c(=)k(@_;)155
5913 y(my)g($comment)f(=)i($_pre_flg)e(?)i($mlin{'spacer'}->\(\)."\\n")
45 b(:)50 b(\224;)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 69 74
69 73 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.3.)22 b Fx(Shared)j(code:)30 b FB(global.pm)2016
b FG(69)p -128 -243 4016 9 v Black 155 35 a Fu($_pre_flg)48
b(||)h(\($_pre_flg)f(=)i($T\);)155 134 y(foreach)e(my)i($ln)f(\(@lns\))
g({)354 234 y($comment)f(.=)i("$base$pre".)952 334 y
(\(&fill_left\($ln,$tlen,")45 b("\)\)."$post\\n";)354
433 y(};)155 533 y(return)j($comment;)-45 632 y(})i(#)g(left_header)-45
732 y(sub)g(right_header\(\))d({)155 832 y(my)i
(\($tlen,$base,$pre,$post,@lns\))c(=)k(@_;)155 931 y(my)g($comment)f(=)
i($_pre_flg)e(?)i($mlin{'spacer'}->\(\)."\\n")45 b(:)50
b(\224;)155 1031 y($_pre_flg)e(||)h(\($_pre_flg)f(=)i($T\);)155
1131 y(foreach)e(my)i($ln)f(\(@lns\))g({)354 1230 y($comment)f(.=)i
("$base$pre".)952 1330 y(\(&fill_right\($ln,$tlen,")45
b("\)\)."$post\\n";)354 1429 y(};)155 1529 y(return)j($comment;)-45
1629 y(})i(#)g(right_header)-45 1728 y(sub)g(program_started\(\))c({)
155 1828 y(my)j($prog)g(=)h(shift;)155 1928 y(print)f($ERRFH)f
($Messages{'HEADER'}->\("RUNNING)c($prog",\224,)354 2027
y("Host:)49 b($HOST","User:)e($USER","Perl:)g($PLVER",\224,"Date:)g
($DATE"\);)-45 2127 y(})j(#)g(program_started)-45 2227
y(sub)g(program_finished\(\))c({)155 2326 y(my)j($prog)g(=)h(shift;)155
2426 y(print)f($ERRFH)f($Messages{'HEADER'}->\("$prog)d(HAS)k
(FINISHED",\224,)1898 2525 y(&timing\(\\@exectime,$T\)\);)-45
2625 y(})h(#)g(program_finished)p Black Black -415 2824
a Fq(69a)180 b Fp(h)p FI(global:)19 b(messa)o(g)o(es)i(-)f(pr)l(o)o(gr)
o(am)g(start-stop)g Fq(69a)p Fp(i)q Ft(\021)-45 2924
y Fu(HEADER)348 b(=>)49 b(sub)h({)404 3024 y(my)f(@mssg)g(=)h(@_;)404
3123 y(return)503 3223 y(&header\()603 3322 y
($mlin{'comment_len'}->\(\),$mlin{'com)o(ment_b)o(ase'})o(->\(\),)603
3422 y($mlin{'comment_pre'}->\(\),$mlin{'com)o(ment_p)o(ost'})o
(->\(\),)603 3522 y($mlin{'comment_line'}->\(\),)603
3621 y("",)f(@mssg,)g("",)603 3721 y($mlin{'comment_line'}->\(\),)603
3821 y(\);)205 3920 y(},)p Black Black -420 4119 a Fq(69b)181
b Fp(h)p FI(global:)19 b(warnings)h(-)h(en)m(vir)l(onment)d(settings)j
Fq(69b)p Fp(i)q Ft(\021)-45 4219 y Fu(ENVNOTDEF)198 b(=>)49
b(sub)h({)404 4319 y(my)f($mssg)g(=)h(shift;)404 4418
y(return)503 4518 y(&header\()603 4618 y
($mlin{'error_len'}->\(\),$mlin{'error)o(_base')o(}->\(\))o(,)603
4717 y($mlin{'error_pre'}->\(\),$mlin{'error)o(_post')o(}->\(\))o(,)603
4817 y($mlin{'error_line'}->\(\),$mlin{'empt)o(y_erro)o(r_lin)o
(e'}->\()o(\),)603 4916 y("Following)e(environment)g(variable)g(is)h
(NOT)h(defined:)e($mssg",)603 5016 y
($mlin{'empty_error_line'}->\(\),$mlin)o({'erro)o(r_lin)o(e'}->\()o
(\),)603 5116 y(\);)205 5215 y(},)-128 5511 y FD(B.3.4)91
b(Interacting)25 b(with)e(DB)f(standard)h(messages)p
Black Black -415 5672 a Fq(69c)180 b Fp(h)p FI(global:)19
b(messa)o(g)o(es)i(-)f(inter)o(acting)f(with)i(DB)g Fq(69c)p
Fp(i)q Ft(\021)-45 5772 y Fu(DBIHEADER)198 b(=>)49 b(sub)h({)404
5871 y(my)f(@mssg)g(=)h(@_;)p Black -128 6076 V -128
6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 70 75
70 74 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.3.)22 b Fx(Shared)j(code:)30 b FB(global.pm)2016
b FG(70)p -128 -243 4016 9 v Black 404 35 a Fu(return)503
134 y(&right_header\()603 234 y($mlin{'dbi_len'}->\(\),$mlin{'dbi_bas)o
(e'}->\()o(\),)603 334 y($mlin{'dbi_pre'}->\(\),$mlin{'dbi_pos)o
(t'}->\()o(\),)603 433 y($mlin{'dbi_line'}->\(\),)603
533 y(&prespc\(@mssg\),)603 632 y($mlin{'dbi_line'}->\(\),)603
732 y(\);)205 832 y(},)-45 931 y(DBIMSG)348 b(=>)49 b(sub)h({)404
1031 y(my)f(@mssg)g(=)h(@_;)404 1131 y(return)e
(&comment_line\($mlin{'dbi_len'}->\(\),$ml)o(in{'d)o(bi_bas)o(e'}->)o
(\(\),)1450 1230 y($mlin{'dbi_pre'}->\(\),@mssg\);)205
1330 y(},)-45 1429 y(DBICMD)348 b(=>)49 b(sub)h({)404
1529 y(my)f(@mssg)g(=)h(\(split)e(/[\\n]/o,)h($_[0]\);)404
1629 y(@mssg)g(=)g(map)h({)f(s/^\\s{6}//o;)f($_)h(})h(@mssg;)404
1728 y(return)e(&comment_line\($mlin{'dbi_len'}->\(\),$ml)o(in{'d)o
(bi_bas)o(e'}->)o(\(\),)1450 1828 y($mlin{'dbi_pre'}->\(\),@mssg\);)205
1928 y(},)-128 2223 y FD(B.3.5)91 b(P)o(arsing)24 b(command-line)p
Black Black -382 2384 a Fq(70)180 b Fp(h)p FI(global.pm:)19
b(par)o(sing)g(command-line)f(ar)m(gs)i Fq(70)p Fp(i)q
Ft(\021)-45 2484 y Fu(#)-45 2584 y(#)50 b(Parsing)f(command-line)e
(options)-45 2683 y(use)j(Getopt::Long;)-45 2783 y
(Getopt::Long::Configure)c(qw/)j(bundling)g(/;)-45 2882
y(\045CmdLineDefs)f(=)i(\(\);)-45 2982 y(\045CmdLineOpts)e(=)i(\(\);)
-45 3181 y(sub)g(parse_cmdline\(\))d({)155 3281 y(#)i(we)h(ensure)e
(here)i(that)f(options)f(hash)h(always)g(exist)155 3381
y(#)g(\(and)g(that)g(it)h(has)f(a)h(default)e(option:)h('help'\))155
3480 y($CmdLineOpts{'v|verbose'})c(=)k(sub)h({)553 3580
y($_verbose)e(=)i($T;)354 3679 y(};)155 3779 y
($CmdLineOpts{'V|color-verbose'})44 b(=)49 b(sub)h({)553
3879 y(\($_verbose,)e($_color_report\))f(=)j(\($T,)f($T\);)354
3978 y(};)155 4078 y($CmdLineOpts{'h|help|?'})c(=)50
b(sub)f({)553 4178 y(print)g($ERRFH)g
($Messages{'SHOW_HELP'}->\($USAGE\);)553 4277 y(exit\(1\);)354
4377 y(};)155 4476 y(#)g(looking)g(for)g(STDIN)g("-")g(to)h(avoid)f
(problems)f(with)h(GetOptions)155 4576 y(my)g($cmdln_stdin)f(=)h
(undef;)155 4676 y(for)g(\(my)g($a)h(=)f(0;)h($a)f(<=)h($#ARGV;)e
($a++\))h({)354 4775 y(next)g(unless)g($ARGV[$a])f(=~)h(/^-$/o;)354
4875 y($cmdln_stdin)f(=)h($a)h(-)f($#ARGV;)354 4975 y
(splice\(@ARGV,$a,1\);)155 5074 y(};)155 5174 y(#)g(parsing)g
(command-line)155 5273 y($SIG{__WARN__})e(=)j(sub)f({)553
5373 y(print)g($ERRFH)g($Messages{'CMDLINE_OPT_ERR'}->\($_[)o(0]\);)354
5473 y(};)155 5572 y(GetOptions\(\045CmdLineOpts\))c(||)k(do)h({)553
5672 y(&program_started\($PROG\);)553 5772 y(print)f($ERRFH)g
($Messages{'CMDLINE_ERROR'}->\($PROG)o(,"@ARG)o(V"\);)553
5871 y(exit\(1\);)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 71 76
71 75 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.3.)22 b Fx(Shared)j(code:)30 b FB(global.pm)2016
b FG(71)p -128 -243 4016 9 v Black 354 35 a Fu(};)155
134 y($SIG{__WARN__})47 b(=)j('DEFAULT';)155 234 y(#)f(if)h("-")f
(return)g(to)g(its)g(position)g(on)g(cmd-line)155 334
y(my)g($t)h(=)f(scalar\(@ARGV\);)155 433 y(defined\($cmdln_stdin\))d
(&&)j(do)g({)354 533 y(abs\($cmdln_stdin\))e(>)i($t)h(&&)f
(\($cmdln_stdin)e(=)j(-$t\);)354 632 y($cmdln_stdin)e(>)h(0)100
b(&&)49 b(\($cmdln_stdin)e(=)j(0)g(\);)354 732 y($t)f(+=)h
($cmdln_stdin;)354 832 y(splice\(@ARGV,$t,0,'-'\);)155
931 y(};)-45 1031 y(})g(#)g(parse_cmdline)p Black Black
-415 1230 a Fq(71a)180 b Fp(h)p FI(global:)19 b(messa)o(g)o(es)i(-)f
(par)o(sing)g(command-line)e(options)h Fq(71a)p Fp(i)q
Ft(\021)-45 1330 y Fu(SHOW_HELP)198 b(=>)49 b(sub)h({)404
1429 y(my)f(@mssg)g(=)h(split)f(/[\\n]/og,)f(shift;)404
1529 y(return)503 1629 y(&right_header\()603 1728 y
($mlin{'comment_len'}->\(\),$mlin{'com)o(ment_b)o(ase'})o(->\(\),)603
1828 y($mlin{'comment_pre'}->\(\),$mlin{'com)o(ment_p)o(ost'})o
(->\(\),)603 1928 y($mlin{'comment_line'}->\(\),)603
2027 y(&prespc\(@mssg\),)603 2127 y($mlin{'comment_line'}->\(\),)603
2227 y(\);)205 2326 y(},)p Black Black -420 2525 a Fq(71b)181
b Fp(h)p FI(global:)19 b(warnings)h(-)h(par)o(sing)e(command-line)f
(options)h Fq(71b)p Fp(i)r Ft(\021)-45 2625 y Fu(CMDLINE_OPT_ERR)47
b(=>)j(sub)f({)404 2725 y(my)g($mssg)g(=)h(shift;)404
2824 y($mssg)f(=~)g(s/^\\s*//o;)404 2924 y($mssg)g(=~)g(s/\\s*$//o;)404
3024 y(return)503 3123 y(&right_header\()603 3223 y
($mlin{'warn_len'}->\(\),$mlin{'warn_b)o(ase'}-)o(>\(\),)603
3322 y($mlin{'warn_pre'}->\(\),$mlin{'warn_p)o(ost'}-)o(>\(\),)603
3422 y($mlin{'warn_line'}->\(\),)603 3522 y(&prespc\("Error)e(trapped)i
(while)g(processing)f(command-line:",)1002 3621 y(\(")h("x8\)."->)f
($mssg)h(<-"\),)603 3721 y($mlin{'warn_line'}->\(\),)603
3821 y(\);)205 3920 y(},)-45 4020 y(CMDLINE_ERROR)147
b(=>)50 b(sub)f({)404 4119 y(my)g(\($name,@mssg\))f(=)h(@_;)404
4219 y(return)503 4319 y(&right_header\()603 4418 y
($mlin{'error_len'}->\(\),$mlin{'error)o(_base')o(}->\(\))o(,)603
4518 y($mlin{'error_pre'}->\(\),$mlin{'error)o(_post')o(}->\(\))o(,)603
4618 y($mlin{'error_line'}->\(\),)603 4717 y(&prespc\("???)f(@mssg",)g
("",)1002 4817 y("Please,)g(check)h(your)g(command-line)e(options!!!",)
1002 4916 y(\(")i("x8\)."Type)f(\\"$name)g(-help\\")h(for)g
(help..."\),)603 5016 y($mlin{'error_line'}->\(\),)603
5116 y(\);)205 5215 y(},)-128 5511 y FD(B.3.6)91 b(V)-8
b(alidating)24 b(\002lenames)f(and)g(dir)n(ectories)p
Black Black -415 5722 a Fq(71c)180 b Fp(h)p FI(warnings)21
b(-)f(input/output)e Fq(71c)p Fp(i)q Ft(\021)-45 5821
y Fu(FILE_NO_OPEN)48 b(=>)55 5921 y($spl.$Warn."Cannot)f(Open)i
(Current)f(file)h(\\"\\\045s\\")g(.)g(Not)h(used)f(!!!\\n".$spl,)p
Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o
(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)
1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 72 77
72 76 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.3.)22 b Fx(Shared)j(code:)30 b FB(global.pm)2016
b FG(72)p -128 -243 4016 9 v Black Black Black -415 35
a Fq(72a)180 b Fp(h)p FI(messa)o(g)o(es)21 b(-)g(input/output)d
Fq(72a)p Fp(i)q Ft(\021)-45 134 y Fu(CHECKING_FILENAMES)47
b(=>)55 234 y($sp."###)h(Validating)g(INPUT)h(FILENAMES\\n".$sp,)-45
334 y(READING_FILE)f(=>)55 433 y("###-->)h(\\"\\\045s\\")f(exists,)h
(including)f(as)h(Input)g(File.\\n",)-45 533 y(READING_STDIN)f(=>)55
632 y("###-->)h(Including)f(GFF)h(records)f(from)i(standard)e
(input.\\n",)p Black Black -420 824 a Fq(72b)181 b Fp(h)p
FI(global.pm:)19 b(validate)g(\002le/dir)h Fq(72b)p Fp(i)q
Ft(\021)-45 924 y Fu(#)-45 1023 y(sub)50 b(check_dir\(\))d({)155
1123 y(my)i(\($flg,@odir\))f(=)h(@_;)155 1223 y(\(scalar\(@odir\))e(==)
i(0\))h(&&)f(\(return)g(0\);)155 1322 y(my)g(@okdir)g(=)g(\(\);)155
1422 y(foreach)f(my)i($thisdir)e(\(@odir\))g({)354 1521
y(\()i(-e)f($thisdir)f(&&)i(-d)f(_)h(\))f(||)h(do)f({)-45
1621 y(#)598 b(print)49 b($ERRFH)g("#)g(Making)g(chr)g($chr)g
(directory:)f($odir\\n";)553 1721 y(\(mkdir)h($thisdir\))f(||)h(do)h({)
-45 1820 y(#)797 b(print)49 b($ERRFH)g("#)g(Error)g(making)g(directory)
f(\\"$odir\\")g(".)-45 1920 y(#)1445 b("for)49 b(chr)g($chr)g(:)h
(SKIPPING)e(!!!\\n";)752 2020 y(push)i(@okdir,)e($F;)752
2119 y(next;)553 2219 y(};)553 2319 y(push)h(@okdir,)g($T;)553
2418 y(next;)354 2518 y(};)-45 2617 y(#)399 b(print)49
b($ERRFH)f("#)i(Directory)e(\\"$odir\\")g(for)h(chr)h($chr)f(ALREADY)f
(EXIST...\\n".)354 2717 y(push)h(@okdir,)g($T;)155 2817
y(};)g(#)h(foreach)e($d)155 2916 y(return)g(@okdir;)-45
3016 y(})i(#)g(check_dir)-128 3306 y FD(B.3.7)91 b(Checking)23
b(exit)h(status)g(f)n(or)f(system)i(calls)-128 3480 y
FG(W)-7 b(e)23 b(check)h(for)f(e)o(xit)g(signals)i(returned)h(by)d
(system)h(once)f(it)g(has)h(run)f(the)h(command-line)h(de\002ned)f(in)f
FB($cmdline)c FG(v)n(ariable)-128 3593 y(\(we)k(use)h(the)g(recipe)h
(sho)n(wn)f(in)f(the)h(O'Reilly)g(book,)g(\223Programming)h(Perl\224,)f
(2)2448 3560 y Fa(n)2518 3593 y FG(edition,)h(page)f(230\).)p
Black Black -415 3739 a Fq(72c)180 b Fp(h)p FI(global.pm:)19
b(c)o(hec)n(k)g(e)n(xit)i(status)g(for)f(sys)i(calls)e
Fq(72c)p Fp(i)q Ft(\021)-45 3838 y Fu(#)-45 3938 y(#)50
b(Checking)e(exit)h(status)g(for)g(sys)h(calls)-45 4038
y(sub)g(check_syscall_exit\(\))c({)155 4137 y(my)j($prog_exit)f(=)i
(0xffff)e(&)i(shift;)155 4237 y(my)f(\($exitflg,$exitstr\))d(=)k
(\($F,\224\);)155 4336 y($exitstr)e(=)i(sprintf\("Command)c(returned)j
(\045#04x)g(:)g(",)h($prog_exit\);)155 4436 y(if)f(\($prog_exit)f(==)h
(0\))h({)354 4536 y($exitflg)e(=)i($T;)354 4635 y($exitstr)e(.=)i("ran)
f(with)g(normal)g(exit)g(...";)155 4735 y(})155 4835
y(elsif)g(\($prog_exit)e(==)j(0xff00\))e({)354 4934 y($exitstr)g(.=)i
("command)e(failed:)h($!)g(...";)155 5034 y(})155 5133
y(elsif)g(\(\($prog_exit)e(&)j(0xff\))f(==)g(00\))g({)354
5233 y($prog_exit)f(\273=)h(8;)354 5333 y($exitstr)f(.=)i("ran)f(with)g
(non-zero)f(exit)h(status)g($prog_exit)f(...";)155 5432
y(})155 5532 y(else)h({)354 5632 y($exitstr)f(.=)i("ran)f(with)g(";)354
5731 y(if)g(\($prog_exit)f(&)149 b(0x80\))49 b({)553
5831 y($prog_exit)f(&=)i(~0x80;)553 5930 y($exitstr)f(.=)g("coredump)f
(from)h(";)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 73 78
73 77 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.3.)22 b Fx(Shared)j(code:)30 b FB(global.pm)2016
b FG(73)p -128 -243 4016 9 v Black Black Black Black
184 -53 3393 4 v 184 60 4 113 v 237 26 a FD(EXIT)22 b(KEY)431
b(EXIT)22 b(CODE)98 b(DESCRIPTION)p 3573 60 V 184 63
3393 4 v 184 83 V 184 196 4 113 v 237 162 a FG(OK)1204
b(0)100 b(Ev)o(erything)26 b(w)o(as)d(OK)f(\(as)i(def)o(ault\))p
3573 196 V 184 309 V 237 275 a(K)m(O)1207 b(1)100 b(Errors)24
b(found)h(\(standard\))p 3573 309 V 184 422 V 237 388
a(UNDEF)1031 b(2)100 b(Unkno)n(wn)24 b(e)o(xit)g(status)h(\(not)f
(de\002ned\))p 3573 422 V 184 535 V 237 501 a(UN)m(A)-12
b(V)g(AILABLE)708 b(3)100 b(Could)24 b(not)g(\002nd/create)i(status)f
(\002le)p 3573 535 V 184 538 3393 4 v 184 558 V 184 671
4 113 v 237 637 a(USERHAL)-8 b(T)866 b(4)100 b(Process)25
b(halted)g(by)e(user)i(\()p FB(CTRL+C)p FG(\))p 3573
671 V 184 784 V 237 750 a(PR)l(OGDO)m(WN)815 b(6)100
b(Process)25 b(is)e(do)n(wn)p 3573 784 V 184 896 V 237
863 a(NOFORK)960 b(8)100 b(Could)24 b(not)g(fork)g(child)p
3573 896 V 184 1009 V 237 976 a(RSH)1113 b(10)100 b(RSH)22
b(command)i(f)o(ailed)p 3573 1009 V 184 1122 V 237 1088
a(PBS)1128 b(12)100 b(PBS)22 b(command)i(f)o(ailed)p
3573 1122 V 184 1126 3393 4 v 184 1146 V 184 1258 4 113
v 237 1225 a(NOFILE)966 b(20)100 b(File)24 b(not)f(found)p
3573 1258 V 184 1371 V 237 1338 a(NOREADFILE)717 b(22)100
b(Could)24 b(not)g(open)h(\002le)e(to)g(read)p 3573 1371
V 184 1484 V 237 1450 a(NO)m(WRITEFILE)680 b(24)100 b(Could)24
b(not)g(open)h(\002le)e(to)g(write)p 3573 1484 V 184
1597 V 237 1563 a(NO)m(APPENDFILE)613 b(26)100 b(Could)24
b(not)g(open)h(\002le)e(to)g(append)p 3573 1597 V 184
1601 3393 4 v 184 1713 4 113 v 237 1680 a(NODIR)1002
b(30)100 b(Dir)23 b(not)h(found)p 3573 1713 V 184 1826
V 237 1792 a(NOREADDIR)753 b(32)100 b(Could)24 b(not)g(open)h(dir)e(to)
h(read)p 3573 1826 V 184 1939 V 237 1905 a(NO)m(WRITEDIR)716
b(34)100 b(Could)24 b(not)g(open)h(dir)e(to)h(write)p
3573 1939 V 184 2052 V 237 2018 a(NONEWDIR)794 b(36)100
b(Could)24 b(not)g(create)h(ne)n(w)e(dir)p 3573 2052
V 184 2055 3393 4 v 184 2168 4 113 v 237 2135 a(NOB)m(ASHPIPE)730
b(40)100 b(Error)24 b(found)h(in)e(bash)i(pipe)p 3573
2168 V 184 2281 V 237 2247 a(NOREADPIPE)722 b(42)100
b(Could)24 b(not)g(open)h(pipe)f(to)f(read)p 3573 2281
V 184 2394 V 237 2360 a(NO)m(WRITEPIPE)685 b(44)100 b(Could)24
b(not)g(open)h(pipe)f(to)f(write)p 3573 2394 V 184 2398
3393 4 v 184 2417 V 184 2530 4 113 v 237 2496 a(COMMANDLINE)596
b(60)100 b(Error)24 b(trapped)h(when)f(parsing)h(commandline)h(options)
p 3573 2530 V 184 2643 V 237 2609 a(B)m(ADCMDLINEOPT)512
b(62)100 b(Wrong)25 b(command-line)g(option)h(forced)e(program)h(e)o
(xit)p 3573 2643 V 184 2756 V 237 2722 a(ENVERR)l(OR)802
b(70)100 b(Error)24 b(trapped)h(when)f(setting)h(shell)g(en)l
(vironment)p 3573 2756 V 184 2869 V 237 2835 a(ENVUNDEFV)-12
b(AR)617 b(72)100 b(En)l(vironment)26 b(v)n(ariable)f(not)f(de\002ned)p
3573 2869 V 184 2872 3393 4 v 184 2892 V 184 3005 4 113
v 237 2971 a(DBCONNECT)686 b(100)101 b(Could)24 b(not)g(connect)i(to)d
(DataBase)p 3573 3005 V 184 3118 V 237 3084 a(NO)l(TRANSA)l(CTION)476
b(110)101 b(Could)24 b(not)g(process)i(transaction)p
3573 3118 V 184 3121 3393 4 v 184 3141 V 184 3254 4 113
v 237 3220 a(NOCMD)905 b(127)101 b(Command)24 b(not)g(found)p
3573 3254 V 184 3258 3393 4 v -128 3412 a(T)-7 b(able)36
b(1:)53 b FD(Exit)36 b(codes)g(de\002nition.)64 b FG(When)37
b(running)g(e)o(xternal)h(scripts)f(will)e(be)h(interesting)j(to)d
(retrie)n(v)o(e)h(the)f(cause)g(of)-128 3525 y(abnormal)31
b(e)o(xiting)f(\(gi)n(v)o(en)g(that)g(OK)d(e)o(xit)j(is)f(set)g(to)g
(its)g(def)o(ault)i(system)f(e)o(xit)f(code\),)i(so)e(we)f(set)i(here)f
(a)g(\002x)o(ed)g(code)h(error)-128 3637 y(description)i(to)c(be)h
(shared)g(along)h(dif)n(ferent)g(scripts.)45 b(This)28
b(enables)i(us)e(to)h(distingish)i(between)e(remote)g(shell)g(e)o(x)o
(ecution)-128 3750 y(errors)c(and)f(the)g(errors)h(generated)h(by)d
(submitted)j(scripts.)p Black 553 4127 a Fu(};)354 4227
y($exitstr)48 b(.=)i("signal)e($prog_exit)g(...";)155
4326 y(};)155 4426 y(return)g(\($exitflg,$exitstr,$prog_exit\);)-45
4526 y(})i(#)g(check_syscall_exit)p Black Black -382
4725 a Fq(73)180 b Fp(h)p FI(global.pm:)19 b(normalized)g(e)n(xit)i
Fq(73)p Fp(i)q Ft(\021)-45 4824 y Fu(#)-45 4924 y(#)50
b(Return)f(to)g(program)g(caller)f(a)i("normalized")e(error)g(code)-45
5024 y(sub)i(the_end\(\))e({)155 5123 y(my)h($k)h(=)f(shift)g(||)h
('UNDEF';)155 5223 y(defined\($exit_codes{$k}\))45 b(||)k(\($k)h(=)f
('UNDEF'\);)155 5323 y(\($k)g(eq)g('OK')g(||)h($k)f(eq)h('KO'\))f(||)g
(do)h({)354 5422 y($exit_codes{$k}{MSG}->\(\);)155 5522
y(};)155 5621 y(open\(XRF,">)d($EXIT_REPORT_FILE"\))g(||)i(do)h({)354
5721 y(exit\($exit_codes{'UNAVAILABLE'}{COD)o(E}\);)155
5821 y(};)155 5920 y(print)f(XRF)g($exit_codes{$k}{CODE};)p
Black -128 6076 4016 9 v -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g
(Resear)o(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h
(Guig\363,)e(R)1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black
eop
%%Page: 74 79
74 78 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.3.)22 b Fx(Shared)j(code:)30 b FB(global.pm)2016
b FG(74)p -128 -243 4016 9 v Black 155 35 a Fu(close\(XRF\);)155
134 y(exit\($exit_codes{$k}{CODE}\);)-45 234 y(})50 b(#)g(the_end)p
Black Black -415 433 a Fq(74a)180 b Fp(h)p FI(global.pm:)19
b(normalized)g(e)n(xit)i(codes)f Fq(74a)p Fp(i)q Ft(\021)-45
533 y Fu(\045exit_codes)48 b(=)i(\()155 632 y('OK')597
b(=>)49 b({)h(CODE)f(=>)149 b(0,)49 b(MSG)h(=>)f(sub)g({})h(},)155
732 y('KO')597 b(=>)49 b({)h(CODE)f(=>)149 b(1,)49 b(MSG)h(=>)f(sub)g
({})h(},)155 832 y('UNDEF')447 b(=>)49 b({)h(CODE)f(=>)149
b(2,)49 b(MSG)h(=>)f(sub)g({})h(},)155 931 y('UNAVAILABLE')147
b(=>)49 b({)h(CODE)f(=>)149 b(3,)49 b(MSG)h(=>)f(sub)g({})h(},)155
1031 y('USERHALT')297 b(=>)49 b({)h(CODE)f(=>)149 b(4,)49
b(MSG)h(=>)f(sub)g({})h(},)155 1131 y('PROGDOWN')297
b(=>)49 b({)h(CODE)f(=>)149 b(6,)49 b(MSG)h(=>)f(sub)g({})h(},)155
1230 y('NOFORK')397 b(=>)49 b({)h(CODE)f(=>)149 b(8,)49
b(MSG)h(=>)f(sub)g({})h(},)155 1330 y('RSH')547 b(=>)49
b({)h(CODE)f(=>)99 b(10,)49 b(MSG)h(=>)f(sub)g({})h(},)155
1429 y('PBS')547 b(=>)49 b({)h(CODE)f(=>)99 b(12,)49
b(MSG)h(=>)f(sub)g({})h(},)155 1529 y('NOFILE')397 b(=>)49
b({)h(CODE)f(=>)99 b(20,)49 b(MSG)h(=>)f(sub)g({})h(},)155
1629 y('NOREADFILE')197 b(=>)49 b({)h(CODE)f(=>)99 b(22,)49
b(MSG)h(=>)f(sub)g({})h(},)155 1728 y('NOWRITEFILE')147
b(=>)49 b({)h(CODE)f(=>)99 b(24,)49 b(MSG)h(=>)f(sub)g({})h(},)155
1828 y('NOAPPENDFILE')97 b(=>)49 b({)h(CODE)f(=>)99 b(26,)49
b(MSG)h(=>)f(sub)g({})h(},)155 1928 y('NODIR')447 b(=>)49
b({)h(CODE)f(=>)99 b(30,)49 b(MSG)h(=>)f(sub)g({})h(},)155
2027 y('NOREADDIR')247 b(=>)49 b({)h(CODE)f(=>)99 b(32,)49
b(MSG)h(=>)f(sub)g({})h(},)155 2127 y('NOWRITEDIR')197
b(=>)49 b({)h(CODE)f(=>)99 b(34,)49 b(MSG)h(=>)f(sub)g({})h(},)155
2227 y('NONEWDIR')297 b(=>)49 b({)h(CODE)f(=>)99 b(36,)49
b(MSG)h(=>)f(sub)g({})h(},)155 2326 y('NOBASHPIPE')197
b(=>)49 b({)h(CODE)f(=>)99 b(40,)49 b(MSG)h(=>)f(sub)g({})h(},)155
2426 y('NOREADPIPE')197 b(=>)49 b({)h(CODE)f(=>)99 b(42,)49
b(MSG)h(=>)f(sub)g({})h(},)155 2525 y('NOWRITEPIPE')147
b(=>)49 b({)h(CODE)f(=>)99 b(44,)49 b(MSG)h(=>)f(sub)g({})h(},)155
2625 y('COMMANDLINE')147 b(=>)49 b({)h(CODE)f(=>)99 b(60,)49
b(MSG)h(=>)f(sub)g({})h(},)155 2725 y('BADCMDLINEOPT')d(=>)i({)h(CODE)f
(=>)99 b(62,)49 b(MSG)h(=>)f(sub)g({})h(},)155 2824 y('ENVERROR')297
b(=>)49 b({)h(CODE)f(=>)99 b(70,)49 b(MSG)h(=>)f(sub)g({})h(},)155
2924 y('ENVUNDEFVAR')147 b(=>)49 b({)h(CODE)f(=>)99 b(72,)49
b(MSG)h(=>)f(sub)g({})h(},)155 3024 y('DBCONNECT')247
b(=>)49 b({)h(CODE)f(=>)g(100,)g(MSG)h(=>)f(sub)g({})h(},)155
3123 y('NOTRANSACTION')d(=>)i({)h(CODE)f(=>)g(110,)g(MSG)h(=>)f(sub)g
({})h(},)155 3223 y('NOCMD')447 b(=>)49 b({)h(CODE)f(=>)g(127,)g(MSG)h
(=>)f(sub)g({})h(},)155 3322 y(\);)-45 3422 y(\045{)g
($exit_codes{'CODES'})c(})k(=)f(\()h(map)f({)h
($exit_codes{$_}{'CODE'},)45 b($_)50 b(})1450 3522 y(keys)f
(\045exit_codes)f(\);)-128 3817 y FD(B.3.8)91 b(Execution)24
b(status)g(helper)f(scripts:)30 b FB(exit.pl)20 b FD(and)p
Black Black -420 3978 a Fq(74b)181 b Fp(h)p FI(e)n(xit.pl:)21
b(r)m(etrie)o(ving)f(status)g(codes)g Fq(74b)p Fp(i)q
Ft(\021)-45 4078 y Fp(h)p FI(PERL)h(shebang)d Fq(83a)p
Fp(i)-45 4178 y Fu(#)50 b(exit.pl)-45 4277 y(#)-45 4377
y(use)g(strict;)-45 4476 y(use)g(global)e(qw\()i(:ExitStatus)d(\);)-45
4576 y(my)j($key)f(=)h(shift)e(@ARGV)h(||)h('UNDEF';)-45
4676 y(printf)f(STDOUT)g("\045d",)g(\()g(defined\($exit_codes{$key}\))
1151 4775 y(?)h($exit_codes{$key}{CODE})1151 4875 y(:)g
($exit_codes{UNDEF}{CODE})45 b(\);)-45 4975 y(exit\(0\);)14
5137 y FG(The)24 b(follo)n(wing)h(short)h(script)f(informs)h(us)e
(about)i(fe)n(w)d(parameters)k(we)c(must)i(check)g(on)g(remote)g
(machines)h(that)f(af)n(fect)-128 5250 y(the)f(e)o(x)o(ecution)i(of)d
(all)h(the)g(scripts)h(we)d(could)j(launch)g(via)f FB(rsh)d
FG(from)j FB(stepper.pl)p FG(:)p Black Black -415 5400
a Fq(74c)180 b Fp(h)p FI(g)o(etr)m(emoteinfo.pl:)19 b(c)o(hec)n(king)g
(r)m(emote)h(hosts)g(shar)m(ed)g(par)o(ams)g Fq(74c)p
Fp(i)q Ft(\021)-45 5499 y Fp(h)p FI(PERL)h(shebang)d
Fq(83a)p Fp(i)-45 5599 y Fu(#)50 b(getremoteinfo.pl)-45
5699 y(#)-45 5798 y(#)g(Get)f(hostname)-45 5898 y(if)h
(\(defined\($ENV{HOSTNAME}\)\))45 b({)p Black -128 6076
V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 75 80
75 79 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.3.)22 b Fx(Shared)j(code:)30 b FB(global.pm)2016
b FG(75)p -128 -243 4016 9 v Black 155 35 a Fu($HOST)49
b(=)g($ENV{HOSTNAME};)-45 134 y(})h(else)f({)155 234
y(chomp\($HOST)e(=)j(`hostname`\);)-45 334 y(};)-45 433
y($HOST)f(=~)h(s/\\.imim\\.es$//o;)-45 533 y(#)-45 632
y(#)g(Directories)e(that)h(must)g(exist)g(in)g(host)-45
732 y(if)h(\(-e)f("/usr/local/molbio")d(&&)k(-d)f(_\))h({)f
($DIRFLG="YES")f(})-45 832 y(else)i({)f($DIRFLG="NO")f(};)-45
931 y(#)-45 1031 y(#)i(Output)f(required)f(info)h(about)g(host)-45
1131 y(print)g(STDOUT)g(sprintf\("->)f(\04516s)h(->)g(perl)g(v\045vd)g
(->)h(Is)f(\\"molbio\\")f(there?)h(\045s)g(\\n",)1002
1230 y("$HOST.imim.es",$^V,$DIRFLG\);)-45 1330 y(#)-45
1429 y(exit\(0\);)p Black Black -415 1629 a Fq(75a)180
b Fp(h)p FI(tangling:)19 b(perl)h(scripts)i Fq(31a)p
Fp(i)q Fo(+)o Ft(\021)-45 1728 y Fu(#)-45 1828 y(#)50
b(Retrieve)e(status)h(codes)g(from)g(step)g(scripts)g(execution)-45
1928 y(notangle)g(-R'exit.pl:)f(retrieving)f(status)i(codes')g(\\)155
2027 y($WORK/$nwfile.nw)e(|)i(cpif)g($BIN/exit.pl)f(;)-45
2127 y(notangle)h(-R'getremoteinfo.pl:)d(checking)i(remote)h(hosts)g
(shared)f(params')h(\\)155 2227 y($WORK/$nwfile.nw)e(|)i(cpif)g
($BIN/getremoteinfo.pl)d(;)-45 2326 y(is_exec)j($BIN/exit.pl)f
($BIN/getremoteinfo.pl)d(;)-45 2426 y(#)-45 2525 y(for)50
b(n)f(in)h(monstre1)e(monstre2)g(monstre3)h(monstre4)f(ik12)h(ik13)g
(i8)h(i10)f(i26)g(aleph)g(;)55 2625 y(do)h({)304 2725
y(rsh)f($n.imim.es)f($BIN/getremoteinfo.pl)e(;)155 2824
y(})j(;)55 2924 y(done)g(;)-45 3024 y(#)-128 3319 y FD(B.3.9)91
b(General)24 b(functions)p Black Black -420 3480 a Fq(75b)181
b Fp(h)p FI(global.pm:)19 b(g)o(ener)o(al)g(functions)g
Fq(75b)p Fp(i)q Ft(\021)-45 3580 y Fu(#)-45 3679 y(#)50
b(General)f(functions)-45 3779 y(sub)h(max\(\))f({)155
3879 y(my)g($z)h(=)f(shift)g(@_;)155 3978 y(foreach)f(my)i($l)f(\(@_\))
g({)h($z)f(=)h($l)f(if)h($l)f(>)h($z)f(};)155 4078 y(return)f($z;)-45
4178 y(})i(#)g(max)-45 4277 y(sub)g(min\(\))f({)155 4377
y(my)g($z)h(=)f(shift)g(@_;)155 4476 y(foreach)f(my)i($l)f(\(@_\))g({)h
($z)f(=)h($l)f(if)h($l)f(<)h($z)f(};)155 4576 y(return)f($z;)-45
4676 y(})i(#)g(min)-45 4775 y(#)-45 4875 y(sub)g(fill_right\(\))d({)j
(return)f($_[0].\($_[2])e(x)j(\($_[1])e(-)i(length\($_[0]\)\)\))d(})-45
4975 y(sub)j(fill_left\(\))97 b({)50 b(return)f(\($_[2])f(x)i(\($_[1])f
(-)g(length\($_[0]\)\)\).$_[0])d(})-45 5074 y(sub)k(fill_mid\(\))147
b({)155 5174 y(my)49 b($l)h(=)f(length\($_[0]\);)155
5273 y(my)g($k)h(=)f(int\(\($_[1])f(-)i($l\)/2\);)155
5373 y(return)e(\($_[2])h(x)h($k\).$_[0].\($_[2])d(x)i(\($_[1])g(-)g
(\($l)h(+)f($k\)\)\);)-45 5473 y(})h(#)g(fill_mid)-45
5572 y(sub)g(prespc\(\))e({)i(return)e(\()i(map)f({)h(")f($_")h(})f(@_)
h(\);)f(})p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 76 81
76 80 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.4.)22 b Fx(Implementing)k(scripts)f(with)f FB(Tk)1924
b FG(76)p -128 -243 4016 9 v Black -128 35 a FL(B.4)100
b(Implementing)26 b(scripts)f(with)g Fb(Tk)p Black Black
-415 196 a Fq(76a)180 b Fp(h)p FI(tangling:)19 b(perl)h(Tk)h(scripts)g
Fq(76a)p Fp(i)r Ft(\021)-45 295 y Fu(#)-45 395 y(#)50
b(Tk)g(perl)f(scripts)-45 495 y(notangle)g(-R'stv:)f(Status)h(Table)g
(Viewer')f($WORK/$nwfile.nw)f(|)j(cpif)f($BIN/stv)f(;)-45
594 y(is_exec)h($BIN/stv)f(;)-45 694 y(#)p Black Black
-420 893 a Fq(76b)181 b Fp(h)p FI(stv:)21 b(Status)f(T)-8
b(able)20 b(V)-6 b(ie)o(wer)21 b Fq(76b)p Fp(i)q Ft(\021)-45
993 y Fp(h)p FI(PERL)g(shebang)d Fq(83a)p Fp(i)-45 1092
y Fu(#)50 b(stv)f(-)h(visualizing)e(a)h(dinamic)g(status)g(table)f(in)i
(perl)f(Tk)g(\(pTk\))-45 1192 y(#)-45 1292 y(use)h(strict;)-45
1391 y(use)g(Tk;)-45 1491 y(#)g(database)e(interface)h(module)-45
1590 y(#)h(use)f(lib)h("$LIBPERL";)-45 1690 y(use)g(db_Hsapiens;)-45
1790 y(#)-45 1889 y(use)g(global;)-45 1989 y($PROG)f(=)h('stv';)-45
2188 y Fp(h)p FI(RGB)21 b(color)f(codes)g(hash)f Fq(77)p
Fp(i)-45 2288 y Fu(my)50 b(@chrom)f(=)g(qw/)g(1)h(2)g(3)f(4)h(X)g(Y)f
(/;)h(#)f(to)h(load)f(from)g(DB)-45 2387 y(my)h(@jobs)99
b(=)49 b(qw/)g(Masking)g(Homology)f(GenePred)h(SGP)g(/;)g(#)h(to)f
(load)g(from)h(DB)-45 2487 y(my)g(\(\045col,\045row\);)-45
2686 y(#)-45 2786 y(##)g(MAIN)-45 2886 y(&parse_cmdline\(\);)-45
2985 y(&program_started\($PROG\);)-45 3085 y(#)g(Open)f(mySQL)g
(DataBase)f(conection)-45 3185 y(&open_DB\(\);)-45 3284
y(#)i(Initialize)e(Tk)h(table)-45 3384 y(&Init_Window\(\);)-45
3483 y(#)h(Infinite)e(loop)h(to)h(dispatch)e(incoming)h(events)-45
3583 y(MainLoop\(\);)-45 3683 y(#)h(Disconecting)e(from)h(mySQL)g(DB)
-45 3782 y(&close_DB\(\);)-45 3882 y(#)-45 3982 y
(&program_finished\($PROG\);)-45 4081 y(exit\(0\);)-45
4280 y(#)-45 4380 y(##)h(SUBS)-45 4480 y(sub)g(Init_Window\(\))d({)155
4579 y(#)i(Create)g(main)g(window)155 4679 y(my)g($main_window)f(=)h
(MainWindow->new\(\);)155 4779 y($main_window->title\("Status)44
b(Table)49 b(Viewer"\);)155 4978 y(#)g(Instatiating)f(widgets)155
5077 y($col{HEADER})f(=)j($main_window->Frame\()952 5177
y(borderwidth)d(=>)j(2,)952 5277 y(foreground)97 b(=>)50
b($color{yellow},)952 5376 y(\)->pack\()1151 5476 y(side)149
b(=>)49 b('left',)1151 5576 y(fill)149 b(=>)49 b('y',)1151
5675 y(expand)g(=>)g('y',)1151 5775 y(\);)155 5874 y
($row{HEADER}{HEADER})d(=)j($col{HEADER}->Label\()p Black
-128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g
(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 77 82
77 81 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.4.)22 b Fx(Implementing)k(scripts)f(with)f FB(Tk)1924
b FG(77)p -128 -243 4016 9 v Black 1500 35 a Fu(text)397
b(=>)50 b("CHR->\\nPROG-v",)1400 134 y(#)g(anchor)297
b(=>)50 b('n',)1500 234 y(width)347 b(=>)50 b(10,)1500
334 y(height)297 b(=>)50 b(2,)1500 433 y(foreground)97
b(=>)50 b($color{black},)1500 533 y(background)97 b(=>)50
b($color{lightgrey},)1500 632 y(borderwidth)d(=>)j(2,)1500
732 y(\)->pack\(\);)155 832 y(foreach)e(my)i($j)f(\(@jobs\))g({)354
931 y($row{HEADER}{$j})e(=)i($col{HEADER}->Label\()1500
1031 y(text)397 b(=>)50 b("$j",)1400 1131 y(#)g(anchor)297
b(=>)50 b('n',)1500 1230 y(width)347 b(=>)50 b(10,)1500
1330 y(height)297 b(=>)50 b(2,)1500 1429 y(foreground)97
b(=>)50 b($color{black},)1500 1529 y(background)97 b(=>)50
b($color{dodgerblue},)c(#'lightblue',)1500 1629 y(borderwidth)h(=>)j
(2,)1500 1728 y(\)->pack\(\);)155 1828 y(};)f(#)h(foreach)e(@jobs)155
2027 y(foreach)g(my)i($j)f(\(@chrom\))f({)354 2127 y(my)h($frame)g(=)h
($main_window->Frame\()952 2227 y(borderwidth)d(=>)j(2,)952
2326 y(foreground)97 b(=>)50 b($color{yellow},)952 2426
y(\)->pack\()1151 2525 y(side)149 b(=>)49 b('left',)1151
2625 y(fill)149 b(=>)49 b('y',)1151 2725 y(expand)g(=>)g('y',)1151
2824 y(\);)354 2924 y(\045{)g($row{$j})g(})g(=)h(\(\);)354
3024 y($col{$j})e(=)i($frame;)354 3123 y($row{$j}{HEADER})d(=)i
($col{$j}->Label\()1500 3223 y(text)397 b(=>)50 b("Chr)f($j",)1400
3322 y(#)h(anchor)297 b(=>)50 b('n',)1500 3422 y(width)347
b(=>)50 b(6,)1500 3522 y(height)297 b(=>)50 b(2,)1500
3621 y(foreground)97 b(=>)50 b($color{black},)1500 3721
y(background)97 b(=>)50 b($color{lightgrey},)1500 3821
y(borderwidth)d(=>)j(2,)1500 3920 y(\)->pack\(\);)354
4020 y(foreach)e(my)i($i)f(\(@jobs\))g({)553 4119 y($row{$j}{$i})f(=)h
($col{$j}->Label\()1500 4219 y(text)397 b(=>)50 b("-",)1400
4319 y(#)g(anchor)297 b(=>)50 b('n',)1500 4418 y(width)347
b(=>)50 b(6,)1500 4518 y(height)297 b(=>)50 b(2,)1500
4618 y(foreground)97 b(=>)50 b($color{black},)1500 4717
y(background)97 b(=>)50 b($color{orange},)1500 4817 y(borderwidth)d(=>)
j(2,)1500 4916 y(\)->pack\(\);)354 5016 y(};)f(#)h(foreach)f(@jobs)155
5116 y(};)g(#)h(foreach)e(@chrom)-45 5215 y(})i(#)g(Init_Window)p
Black Black -382 5415 a Fq(77)180 b Fp(h)p FI(RGB)21
b(color)f(codes)g(hash)f Fq(77)p Fp(i)q Ft(\021)-45 5514
y Fu(my)50 b(\045color)f(=)g(\()-45 5614 y(#)354 5713
y('white')397 b(=>)50 b('#FFFFFF',)354 5813 y('black')397
b(=>)50 b('#000000',)354 5913 y('slategrey')197 b(=>)50
b('#9FB6CD',)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 78 83
78 82 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.5.)22 b Fx(T)-6 b(ests)2827 b FG(78)p -128 -243
4016 9 v Black 354 35 a Fu('grey')447 b(=>)50 b('#BEBEBE',)354
134 y('lightgrey')197 b(=>)50 b('#D3D3D3',)354 234 y('lightslategrey')d
(=>)i('#708090',)-45 334 y(#)354 433 y('magenta')297
b(=>)50 b('#FF00FF',)354 533 y('lightpink')197 b(=>)50
b('#FFB6C1',)354 632 y('purple')347 b(=>)50 b('#9370DB',)354
732 y('lavender')247 b(=>)50 b('#E6E6FA',)-45 832 y(#)354
931 y('cyan')447 b(=>)50 b('#00FFFF',)354 1031 y('lightcyan')197
b(=>)50 b('#E0FFFF',)354 1131 y('skyblue')297 b(=>)50
b('#87CEEB',)354 1230 y('palecyan')247 b(=>)50 b('#AFEEEE',)-45
1330 y(#)354 1429 y('blue')447 b(=>)50 b('#0000FF',)354
1529 y('lightblue')197 b(=>)50 b('#ADD8E6',)354 1629
y('steelblue')197 b(=>)50 b('#4682B4',)354 1728 y('dodgerblue')147
b(=>)50 b('#1C86EE',)354 1828 y('midnightblue')d(=>)j('#191970',)-45
1928 y(#)354 2027 y('green')397 b(=>)50 b('#00FF00',)354
2127 y('seagreen')247 b(=>)50 b('#2E8B57',)354 2227 y('forestgreen')97
b(=>)50 b('#228B22',)354 2326 y('darkgreen')197 b(=>)50
b('#006400',)354 2426 y('palegreen')197 b(=>)50 b('#98FB98',)-45
2525 y(#)354 2625 y('yellow')347 b(=>)50 b('#FFFF00',)354
2725 y('orange')347 b(=>)50 b('#FFA500',)354 2824 y('gold')447
b(=>)50 b('#FFD700',)354 2924 y('khaki')397 b(=>)50 b('#F0E68C',)-45
3024 y(#)354 3123 y('red')497 b(=>)50 b('#FF0000',)354
3223 y('salmon')347 b(=>)50 b('#FA8072',)354 3322 y('coral')397
b(=>)50 b('#FF7F50',)354 3422 y('firebrick')197 b(=>)50
b('#B22222',)-45 3522 y(#)354 3621 y('brown')397 b(=>)50
b('#A52A2A',)354 3721 y('siena')397 b(=>)50 b('#A0522D',)354
3821 y('saddlebrown')97 b(=>)50 b('#8B4513',)354 3920
y('tan')497 b(=>)50 b('#D2B48C',)354 4020 y('burlywood')197
b(=>)50 b('#FFD39B',)155 4119 y(\);)-128 4418 y FL(B.5)100
b(T)-9 b(ests)p Black Black -382 4579 a Fq(78)180 b Fp(h)p
FI(T)-8 b(esting)21 b(scripts:)42 b Fq(78)p Fp(i)q Ft(\021)-45
4679 y Fu(#)-45 4779 y(perl)50 b(-e)f(')55 4878 y(use)g(strict;)55
4978 y(my)h(\($seq,$src,$ftr,$ori,$end,$sco,$s)o(tr,$f)o(rm\))44
b(=)49 b(\(0..7\);)55 5078 y(my)h(@frame)e(=)i(\()f(3,)h(1,)f(2)h(\);)f
(#)h(frm)f(0)h(->)f(blastfrm)g(3)1300 5177 y(#)h(frm)f(1)h(->)f
(blastfrm)g(1)1300 5277 y(#)h(frm)f(2)h(->)f(blastfrm)g(2)55
5376 y(my)h(\045SEQlen;)55 5476 y(my)g(\($chr,)e($seqln,)h($input,)f
($odir\))h(=)h(@ARGV;)55 5675 y(&child\("$odir/$chr"\);)55
5775 y(&main\(\);)55 5875 y(close\(STDOUT\);)p Black
-128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g
(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 79 84
79 83 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.5.)22 b Fx(T)-6 b(ests)2827 b FG(79)p -128 -243
4016 9 v Black -45 134 a Fu(sub)50 b(child\(\))e({)55
234 y(my)i($base)e(=)i(shift;)55 334 y(open\(FGFF,">)e
($base.fullgff"\);)55 433 y(open\(CGFF,"|)g(sort)h(+3n)g(-6)g(+6)h(-7)f
(-)h(>)g($base.gff"\);)55 533 y(#)g(reopen)e(STDOUT)h(in)h(parent)e
(and)h(return)55 632 y(return)g(if)g(my)h($pid)f(=)g(open\(STDOUT,)f
("|)h(-"\);)55 732 y(die\("###)f(Cannot)h(fork:)g($!"\))g(unless)g
(defined\($pid\);)55 832 y(#)h(process)e(STDIN)h(in)h(child)55
931 y(while)f(\(<STDIN>\))f({)254 1031 y(my)i($j)f(=)h($_;)254
1131 y(print)f(FGFF)g($j;)254 1230 y(next)g(if)h($j)f(=~)h(/^#/o;)254
1330 y(next)f(if)h($j)f(=~)h(/^\\s*$/o;)254 1429 y($j)g(=~)f
(s/;\\s+Strand//o;)254 1529 y($j)h(=~)f(s/;\\s+Frame//o;)254
1629 y($j)h(=~)f(s/;\\s+E_value.*$//o;)254 1728 y(print)g(CGFF)g($j;)55
1828 y(};)h(#)f(STDIN)55 1928 y(#)h(do)f(not)g(let)h(child)f(return)f
(to)i(main!!!)55 2027 y(exit;)-45 2127 y(})g(#)g(sub)f(child)-45
2326 y(sub)h(main\(\))e({)55 2426 y(my)i(@files)e(=)i(\(\);)55
2525 y(my)g(\045g)f(=)h(\()f("+1")g(=>)h(0,)99 b("+2")49
b(=>)g(1,)100 b("+3")49 b(=>)g(2,)99 b("+")50 b(=>)f(3,)553
2625 y("-1")g(=>)h(4,)99 b("-2")49 b(=>)g(5,)100 b("-3")49
b(=>)g(6,)99 b("-")50 b(=>)f(7,)1101 2725 y("all")g(=>)g(8,)598
b("sum")49 b(=>)g([)h(\(0\))f(x)h(9)f(])h(\);)55 2824
y(my)g(\($cf,$cr\);)55 2924 y(open\(FRGLEN,)e("<)h($seqln"\);)55
3024 y(while)g(\(<FRGLEN>\))f({)254 3123 y(next)h(if)h(/^#/o;)254
3223 y(next)f(if)h(/^\\s*$/o;)254 3322 y(chomp;)254 3422
y(my)g(@l)f(=)h(split)f(/\\s+/og,)f($_;)254 3522 y($SEQlen{$l[0]})g(=)h
($l[1];)55 3621 y(};)h(#)f(while)55 3721 y(close\(FRGLEN\);)55
3821 y(open\(FRGLST,)f("<)h($input.report"\);)55 3920
y(while)g(\(<FRGLST>\))f({)254 4020 y(next)h(if)h(/^#/o;)254
4119 y(next)f(if)h(/^\\s*$/o;)254 4219 y(chomp;)254 4319
y(s/^\\s*//o;)254 4418 y(my)g(@l)f(=)h(split)f(/\\s+/og,)f($_;)254
4518 y(\($l[2])h(>)h(0\))f(&&)h(do)f({)454 4618 y(push)g(@files,)f([)i
($l[$#l],)e(\($l[0])h(-)g(1\))h(];)254 4717 y(};)254
4817 y(#)g(skipping)e(fragments)g(without)h(HSPs)55 4916
y(};)h(#)f(while)55 5016 y(close\(FRGLST\);)55 5116 y(#)55
5215 y(print)g(STDERR)g("#\\n#)g($chr)g(has)g(".\(scalar)f(@files\).")g
(fragments)g(\(files\)\\n#\\n#)g(".)703 5315 y(\(sprintf\("\0458s)f
(\0458s)i(\0458s)99 b(\045s\\n","#hsp","#hsp\(+\)","#hsp\(-\)","fil)o
(e"\)\);)55 5415 y(system\("/bin/rm","$input.parseblast.)o(err"\))o(;)
55 5514 y(foreach)49 b(my)g($fl)g(\(@files\))g({)254
5614 y($cf)h(=)f($cr)g(=)h(0;)254 5713 y(my)g(\($fname,$offset\))d(=)i
(\("$input/$fl->[0]",)d($fl->[1]\);)254 5813 y(open\(TBXFL,)i
("parseblast)g(-fullgff)g(-full-scores)g(-comments".)852
5913 y(")i(-verbose)e(-bit-score)g($fname)h(2\273)g
($input.parseblast.err)d(|"\);)p Black -128 6076 V -128
6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 80 85
80 84 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.5.)22 b Fx(T)-6 b(ests)2827 b FG(80)p -128 -243
4016 9 v Black 254 35 a Fu(my)50 b(@l;)254 134 y(while)f(\(<TBXFL>\))f
({)454 234 y(next)h(if)g(/^\\s*$/o;)454 334 y(/^#/o)f(&&)i(do)f({)653
433 y(print)g(STDOUT)f($_;)653 533 y(next;)454 632 y(};)454
732 y(chomp;)454 832 y(@l)h(=)h(split)f(/\\s+/og,)f($_,)h(9;)454
931 y($l[$seq])f(=)i($chr;)454 1031 y($l[$src])e(=)i("tblastx";)454
1131 y($l[$ftr])e(=)i("hsp";)454 1230 y($l[$ori])e(+=)h($offset;)454
1330 y($l[$end])f(+=)h($offset;)454 1429 y(if)g(\($l[$str])f(eq)i
("-"\))f({)653 1529 y($l[$frm])f(=)i($frame[\(\($SEQlen{$chr})45
b(-)50 b($l[$end])e(+)i(1\))g(\045)f(3\)];)653 1629 y($cr++;)454
1728 y(})g(else)g({)653 1828 y($l[$frm])f(=)i($frame[\($l[$ori])d(\045)
i(3\)];)653 1928 y($cf++;)454 2027 y(};)454 2127 y(print)f(STDOUT)h
(join\("\\t",)f(@l\)."\\n";)454 2227 y
($g{sum}[$g{"$l[$str]$l[$frm]"}]++)o(;)254 2326 y(};)i(#)f(while)254
2426 y(close\(TBXFL\);)254 2525 y(printf)g(STDERR)g(")99
b(\0458s)49 b(\0458s)h(\0458s)99 b
(\045s\\n",\($cf+$cr\),$cf,$cr,$fl->[0];)55 2625 y(};)50
b(#)f(foreach)55 2725 y($g{sum}[$g{"+"}])e(=)j($g{sum}[$g{"+1"}])c(+)k
($g{sum}[$g{"+2"}])c(+)k($g{sum}[$g{"+3"}];)55 2824 y($g{sum}[$g{"-"}])
d(=)j($g{sum}[$g{"-1"}])c(+)k($g{sum}[$g{"-2"}])c(+)k
($g{sum}[$g{"-3"}];)55 2924 y($g{sum}[$g{"all"}])d(=)i
($g{sum}[$g{"+"}])e(+)j($g{sum}[$g{"-"}];)55 3024 y(print)f(STDERR)g
("#)g(TOTAL)g(".$g{sum}[$g{"all"}].")d(HSPs)j(on)g($chr:)g(".)703
3123 y($g{sum}[$g{"+"}].")d(forward,)i(".$g{sum}[$g{"-"}].")f
(reverse.\\n";)55 3223 y(foreach)i(my)g($t)g(\(qw/)h(+1)f(+2)g(+3)h(-1)
f(-2)h(-3)f(/\))h({)205 3322 y(printf)e(STDERR)h("#\\t\045s)g(:)g
(\045s\\n",$t,$g{sum}[$g{$t}];)55 3422 y(};)h(#)f(foreach)-45
3522 y(})h(#)g(sub)f(main)-45 3621 y(')h($CHR)f($SDIR/$HSAPID/length)d
($IDIR)j($ODIR)g(2>)g($ODIR.report)f(;)-45 3721 y(#)p
Black Black -382 3920 a Fq(80)180 b Fp(h)p FI(T)-8 b(esting)21
b(scripts:)42 b Fq(78)p Fp(i)q Fo(+)p Ft(\021)-45 4020
y Fu(#)-45 4119 y(#)50 b(cat)f(>)h(run_local_childs)d(\253'###EOF###';)
-45 4219 y(cat)j(>)f(run_remote_childs)e(\253'###EOF###';)-45
4319 y(#!/usr/local/bin/perl)f(-w)55 4418 y(use)j(strict;)55
4518 y(use)g(IPC::Shareable;)e(#)j(XAVI)f(must)g(install)g(this)g
(!!!!!)55 4618 y(my)h(@seqs)e(=)i(qw\()f(seq1)99 b(seq2)g(seq3)g(seq4)g
(seq5)g(seq6)g(seq7)f(seq8)h(seq9)g(seq10)802 4717 y(seq11)49
b(seq12)g(seq13)g(seq14)g(seq15)g(seq16)g(seq17)f(seq18)h(seq19)g
(seq20)g(\);)55 4817 y(my)h(@jobs)e(=)i(qw\()f(job1)g(job2)g(job3)g
(job4)h(job5)f(\);)55 4916 y(my)h($BASE)e(=)i
("/home/ug/jabril/development/projec)o(ts/sgp)o(/humu)o(s/test)o(s/chi)
o(lds";)55 5016 y(my)g(\045jobscode)e(=)h(\()254 5116
y(job1)g(=>)h(\253'$$$EOF$$$',)-45 5215 y(#)-45 5315
y(perl)g(-e)f(')55 5415 y(\($jn,$dr\))f(=)i(@ARGV;)55
5514 y(print)f(STDOUT)g("Running)f($jn)h(on)h($ENV{CWD}:)e($ENV{USER})g
(at)h($ENV{HOSTNAME}\\n";)55 5614 y(print)g(STDERR)g("##)g(Output)g
(was)g(sent)g(to)g($jn.out";)55 5713 y(sleep\(5\);)55
5813 y(print)g(STDERR)g("##)g(Sleep)g(period)f(has)i(finished";)55
5913 y(exit\(0\);)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 81 86
81 85 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.5.)22 b Fx(T)-6 b(ests)2827 b FG(81)p -128 -243
4016 9 v Black 55 35 a Fu(')50 b("job1\($MPID\)")d($HOME)i(>)h
($SEQ.job1.out)d(2>)i($SEQ.job1.err;)-45 134 y(#)-45
234 y($$$EOF$$$)254 334 y(job2)g(=>)h(\253'$$$EOF$$$',)-45
433 y(#)-45 533 y(STRING=`hostname`;)-45 632 y(#)-45
732 y(echo)g("HEY)f(it)g(is)g(me:)h($USER)f(@)g($STRING")g(>)g
($SEQ.job2.out)f(2>)h($SEQ.job2.err;)-45 832 y(#)-45
931 y($$$EOF$$$)254 1031 y(job3)g(=>)h(\253'$$$EOF$$$',)-45
1131 y(#)-45 1230 y(STRING=`hostname`;)-45 1330 y(wc)g
(/seq/genomes/H.sapiens/golden_path_)o(20010)o(806/c)o(hromos)o(omes/)o
(chr1.f)o(a)44 b(|)50 b(\\)55 1429 y(perl)f(-e)h('$h)f(=)g(shift;)503
1529 y($wc)h(=)f(<>;)503 1629 y(print)g("#)h($ENV{USER})e(at)h($h)h
(\\n#)f(File)g(length)g(is:)g($wc\\n";)454 1728 y(')g($STRING)g(-)g(\\)
454 1828 y(>)g($SEQ.job3.out)f(\\)404 1928 y(2>)h($SEQ.job3.err)f(;)-45
2027 y(#)-45 2127 y($$$EOF$$$)254 2227 y(job4)h(=>)h("",)254
2326 y(job5)f(=>)h("",)55 2426 y(\);)-45 2525 y(#)100
b($jobscode{job1})47 b(=~)i(s/\(\\n\)/$1#->)f(/og)h(;)-45
2625 y(#)100 b(print)49 b(STDOUT)f("#->)i(".$jobscode{job1}."\\n")45
b(;)55 2824 y(my)50 b(@pids)e(=)i(\(\);)55 2924 y(my)g(\($pid,$sem\);)
55 3024 y(my)g(@hosts)e(=)i(qw\()f(monstre1)f(monstre2)h(monstre3)f
(monstre4)g(ik12)h(ik13)h(i8)f(i10)g(i26)g(\);)55 3123
y(my)h($maxjobs)e(=)h(scalar\(@hosts\);)55 3223 y(my)h(@semaphore)d(;)
55 3322 y(my)j($gid)f(=)g($$;)55 3522 y(my)h($handle)e(=)i(tie)f
(@semaphore,)f('IPC::Shareable',)e(undef,)j({)h(destroy)e(=>)i(1)f(};)
55 3621 y(@semaphore)f(=)i(\()f(0)h(\))g(x)f($maxjobs;)-45
3821 y(open\(FHERR,)f(">)i($BASE/run.rpt"\);)55 3920
y(#)g(BEGIN)f(brown_dispatcher)55 4020 y(print)g(FHERR)g("###)g(MAIN)g
($gid)g(###)g(BEGIN)g(MAIN)g(LOOP\\n".)653 4119 y("###)g(MAIN)g($gid)g
(###)g(SEMAPHORE:)f(@semaphore\\n";)55 4219 y(my)i($pending_seqs)d(=)j
(scalar\(@seqs\);)55 4319 y(while)f(\($pending_seqs)e(>)j(0\))f({)254
4418 y(for)h(\($sem)e(=)i(0;)g($sem)f(<)g($maxjobs;)f($sem++\))h({)404
4518 y($semaphore[$sem])e(||)i(do)g({)603 4618 y(next)g(if)h(\(!)f
(&is_host_there\($hosts[$sem]\)\);)603 4717 y(next)g(if)h
($pending_seqs)d(==)i(0;)h(#)f(next)g(unless)g(scalar\(@seqs\))f(>)h
(0;)603 4817 y(&breed_crows\()e(shift)i(@seqs,)g($sem\);)603
4916 y(push)g(@pids,)g($pid;)603 5016 y(-$pending_seqs;)404
5116 y(};)g(#)h(if)f(job)h(semaphore)e(==)h(0)h(then)f(fork)g(child)404
5215 y(&do_wait\(\);)254 5315 y(};)h(#)f(for)h(semaphores...)55
5415 y(};)g(#)f(while)55 5514 y(while)g(\(&all_done\(\\@semaphore\)\))c
({)50 b(&do_wait\(\);)e(};)55 5614 y(print)h(FHERR)g("###)g(MAIN)g
($gid)g(###)g(All)h(Jobs)f(ID:)g(\\n)g(@pids)g(\\n".)653
5713 y("###)g(MAIN)g($gid)g(###)g(END)h(MAIN)f(LOOP\\n";)55
5813 y(#)h(END)f(brown_dispatcher)p Black -128 6076 V
-128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 82 87
82 86 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(B.5.)22 b Fx(T)-6 b(ests)2827 b FG(82)p -128 -243
4016 9 v Black -45 35 a Fu(close\(FHERR\);)55 134 y(exit\(0\);)55
334 y(sub)49 b(do_wait\(\))f({)254 433 y(sleep)h(1;)h(#)f
(select\(undef,undef,undef,1\);)254 533 y(print)g(FHERR)g("###)g(MAIN)g
($gid)g(###)h(SEMAPHORE:)d(@semaphore\\n";)55 632 y(})j(#)f(do_wait)55
732 y(sub)g(all_done\(\))f({)254 832 y(my)i($aryref)e(=)i(shift;)254
931 y(my)g($sum)f(=)g(0;)254 1031 y($handle->shlock\(\);)254
1131 y(for)h(\(my)f($s)g(=)h(0;)f($s)h(<)f($maxjobs;)g($s++\))f({)454
1230 y($sum)h(+=)g($semaphore[$s];)254 1330 y(};)h(#)f(for)h
(semaphores...)254 1429 y($handle->shunlock\(\);)254
1529 y(return)f(\($sum>0\))f(?)i(1)g(:)f(0;)55 1629 y(})h(#)f(all_done)
55 1728 y(sub)g(is_host_there\(\))e({)254 1828 y(my)j($host)f(=)g
(shift;)254 1928 y(system\("rsh)f($host)h(echo)g($host)g(2>/dev/null)f
(1>&2;)h(exit"\))f(==)i(0)99 b(&&)50 b(do)f({)454 2027
y(print)f(FHERR)h("###)g(MAIN)g($gid)h(###)f(Connection)f(to)h($host)g
(available...\\n";)454 2127 y(return)f(1;)254 2227 y(};)254
2326 y(print)h(FHERR)g("###)g(MAIN)g($gid)g(###)h(Connection)d(to)j
($host)f(NOT)g(available...\\n";)254 2426 y(return)g(0;)55
2525 y(})h(#)f(is_host_there)55 2625 y(sub)g(breed_crows\(\))f({)254
2725 y(my)i(\($pre,$clhpid\);)254 2824 y(my)g(\($seq,$pos\))e(=)h(@_;)
254 2924 y(return)g(if)g($pid)h(=)f(fork\(\);)g(#)g(return)g(to)g
(parent,)g(follows)f(child)h(code)254 3024 y($clhpid)g(=)g("$$.$gid";)
254 3123 y($handle->shlock\(\);)254 3223 y($semaphore[$pos])e(=)j
($clhpid;)254 3322 y($handle->shunlock\(\);)254 3422
y(print)f(FHERR)g("##)g($clhpid)g(##)g(Running)g(child)g(\\"$clhpid\\")
e(on)j(sequence)e(\\"$seq\\".\\n";)254 3522 y($pre)h(=)h
(sprintf\("SEQ=$BASE/data/\045s)45 b(;\\nMPID=\045s)j
(;\\n",$seq,$clhpid\);)254 3621 y(foreach)h(my)g($job)g(\(qw\()g(job1)g
(job2)h(job3)f(\)\))g({)454 3721 y(print)f(FHERR)h("##)h($clhpid)e(##)i
(Running)e(job)h(\\"$job\\")g(on)g(sequence)f(\\"$seq\\".\\n";)454
3821 y(open\(TMP,">)f($BASE/tmp/$clhpid"\);)454 3920
y(print)h(TMP)i($pre.$jobscode{$job};)454 4020 y(close\(TMP\);)454
4119 y(system)e(\253"#@#EOF#@#")-45 4219 y(/bin/chmod)g(a+x)i
($BASE/tmp/$clhpid)c(;)-45 4319 y(rsh)k($hosts[$pos].imim.es)c
($BASE/tmp/$clhpid)g(;)-45 4418 y(/bin/rm)j($BASE/tmp/$clhpid)e(;)-45
4518 y(#@#EOF#@#)254 4618 y(};)j(#)f(foreach)g(job)254
4717 y($handle->shlock\(\);)254 4817 y($semaphore[$pos])e(=)j(0;)254
4916 y($handle->shunlock\(\);)254 5016 y(print)f(FHERR)g("##)g($clhpid)
g(##)g(Child)g(\\"$clhpid\\")f(is)h(going)g(to)h(finish.\\n";)254
5116 y(exit\(0\);)f(#)g(child)g(process)g(exits)g(when)g(done)55
5215 y(})h(#)f(breed_crows)-45 5315 y(###EOF###)-45 5415
y(#)p Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g
(Resear)o(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h
(Guig\363,)e(R)1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black
eop
%%Page: 83 88
83 87 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(C.)22 b(Common)h(code)i(blocks)2289 b(83)p -128
-243 4016 9 v Black -128 35 a FM(C)120 b(Common)30 b(code)g(blocks)-128
245 y FL(C.1)100 b(PERL)25 b(scripts)p Black Black -415
406 a Fq(83a)180 b Fp(h)p FI(PERL)21 b(shebang)d Fq(83a)p
Fp(i)q Ft(\021)-45 506 y Fu(#!/usr/local/bin/perl)46
b(-w)-45 605 y(#)k(This)f(is)h(perl,)e(version)h(5.6.1)g(built)g(for)g
(i386-linux)-45 705 y(#)-45 805 y Fp(h)p FI(V)-9 b(er)o(sion)21
b(Contr)l(ol)f(Id)g(T)-8 b(a)o(g)21 b Fq(85g)p Fp(i)-45
904 y Fu(#)p Black Black -420 1103 a Fq(83b)181 b Fp(h)p
FI(PERL)21 b(strict)g(pr)o(a)o(gma)e(+)i(info)f Fq(83b)p
Fp(i)q Ft(\021)-45 1203 y Fu(use)50 b(strict;)-45 1303
y(#)-45 1402 y(my)g($PVER)f(=)g(sprintf\("v\045vd",$^V\);)-45
1502 y(my)h($DATE)f(=)g(localtime;)-45 1602 y(my)h(\($USER,$HOST\);)-45
1701 y(if)g(\(defined\($ENV{USER}\)\))c({)155 1801 y($USER)j(=)g
($ENV{USER};)-45 1900 y(})h(else)f({)155 2000 y(chomp\($USER)e(=)j
(`whoami`\);)-45 2100 y(};)-45 2199 y(if)g
(\(defined\($ENV{HOSTNAME}\)\))45 b({)155 2299 y($HOST)k(=)g
($ENV{HOSTNAME};)-45 2399 y(})h(else)f({)155 2498 y(chomp\($HOST)e(=)j
(`hostname`\);)-45 2598 y(};)-45 2697 y(my)g($host)f(=)g($HOST;)g(###)
-45 2797 y(#)p Black Black -415 2996 a Fq(83c)180 b Fp(h)p
FI(Global)20 b(Constants)g(-)g(Boolean)f Fq(83c)p Fp(i)q
Ft(\021)-45 3096 y Fu(my)50 b(\($T,$F\))e(=)i(\(1,0\);)f(#)g(for)h
('T'rue)e(and)i('F'alse)-128 3392 y FD(C.1.1)91 b(T)n(iming)23
b(our)g(scripts)-128 3566 y FG(The)f(')p FB(Benchmark)p
FG(')17 b(module)23 b(encapsulates)j(a)21 b(number)i(of)f(routines)i
(to)e(help)g(to)g(\002gure)g(out)h(ho)n(w)e(long)i(it)e(tak)o(es)i(to)f
(e)o(x)o(ecute)-128 3679 y(a)i(piece)g(of)g(code)g(and)g(the)g(whole)g
(script.)p Black Black -420 3828 a Fq(83d)181 b Fp(h)p
FI(Use)22 b(Modules)d(-)i(Benc)o(hmark)d Fq(83d)p Fp(i)r
Ft(\021)-45 3928 y Fu(use)50 b(Benchmark;)55 4028 y Fp(h)p
FI(T)-5 b(imer)22 b(ON)f Fq(83e)p Fp(i)14 4190 y FG(See)k(')p
FB(man)53 b(Benchmark)p FG(')21 b(for)26 b(further)i(info)e(about)h
(this)g(package.)37 b(W)-7 b(e)25 b(set)h(an)g(array)g(to)g(k)o(eep)h
(record)g(of)f(timing)g(for)-128 4303 y(each)f(section.)p
Black Black -415 4453 a Fq(83e)180 b Fp(h)p FI(T)-5 b(imer)22
b(ON)f Fq(83e)p Fp(i)r Ft(\021)-45 4552 y Fu(my)50 b(@Timer)f(=)g
(\(new)g(Benchmark\);)p Black Black -407 4751 a Fq(83f)180
b Fp(h)p FI(Common)20 b(PERL)g(subs)h(-)f(Benc)o(hmark)f
Fq(83f)p Fp(i)q Ft(\021)-45 4851 y Fu(sub)50 b(timing\(\))e({)155
4951 y(my)h($flg)g(=)h(shift)f(||)g(0;)155 5050 y(push)g(@Timer,)f
(\(new)h(Benchmark\);)155 5150 y(#)g(partial)g(time)155
5250 y($flg)g(||)354 5349 y(\(return)f
(timestr\(timediff\($Timer[$#Timer],$Time)o(r[\($#)o(Timer)43
b(-)50 b(1\)]\)\)\);)155 5449 y(#)f(total)g(time)155
5548 y(return)f(timestr\(timediff\($Timer[$#Timer],$Tim)o(er[0]\))o
(\);)-45 5648 y(})i(#)g(timing)p Black -128 6076 V -128
6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 84 89
84 88 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(C.1.)22 b Fx(PERL)f(scripts)2532 b FG(84)p -128
-243 4016 9 v Black -128 35 a FD(C.1.2)91 b(Printing)23
b(complex)h(Data)g(Structur)n(es)-128 209 y FG(W)l(ith)g(')p
FB(Data::Dumper)p FG(')18 b(we)23 b(are)h(able)g(to)f(pretty)i(print)g
(comple)o(x)f(data)g(structures)i(for)e(deb)n(ugging)j(them.)p
Black Black -415 358 a Fq(84a)180 b Fp(h)p FI(Use)22
b(Modules)d(-)i(Dumper)e Fq(84a)p Fp(i)r Ft(\021)-45
458 y Fu(use)50 b(Data::Dumper;)-45 558 y(local)f
($Data::Dumper::Purity)d(=)k(0;)-45 657 y(local)f
($Data::Dumper::Deepcopy)d(=)j(1;)-128 953 y FD(C.1.3)91
b(Common)23 b(functions)p Black Black -420 1114 a Fq(84b)181
b Fp(h)p FI(Skip)20 b(comments)g(and)f(empty)i(r)m(ecor)m(ds)f
Fq(84b)p Fp(i)q Ft(\021)-45 1214 y Fu(next)50 b(if)f(/^\\#/o;)-45
1313 y(next)h(if)f(/^\\s*$/o;)-45 1413 y(chomp;)p Black
Black -415 1612 a Fq(84c)180 b Fp(h)p FI(Common)20 b(PERL)g(subs)h(-)f
(Min)h(Max)f Fq(84c)p Fp(i)q Ft(\021)-45 1712 y Fu(#)-45
1811 y(sub)50 b(max\(\))f({)155 1911 y(my)g($z)h(=)f(shift)g(@_;)155
2011 y(foreach)f(my)i($l)f(\(@_\))g({)h($z)f(=)h($l)f(if)h($l)f(>)h($z)
f(};)155 2110 y(return)f($z;)-45 2210 y(})i(#)g(max)-45
2310 y(sub)g(min\(\))f({)155 2409 y(my)g($z)h(=)f(shift)g(@_;)155
2509 y(foreach)f(my)i($l)f(\(@_\))g({)h($z)f(=)h($l)f(if)h($l)f(<)h($z)
f(};)155 2608 y(return)f($z;)-45 2708 y(})i(#)g(min)p
Black Black -420 2907 a Fq(84d)181 b Fp(h)p FI(Common)20
b(PERL)g(subs)h(-)f(T)-8 b(e)n(xt)22 b(\002ll)e Fq(84d)p
Fp(i)q Ft(\021)-45 3007 y Fu(#)-45 3107 y(sub)50 b(fill_right\(\))d({)j
($_[0].\($_[2])d(x)j(\($_[1])f(-)g(length\($_[0]\)\)\))e(})-45
3206 y(sub)j(fill_left\(\))97 b({)50 b(\($_[2])f(x)g(\($_[1])g(-)h
(length\($_[0]\)\)\).$_[0])45 b(})-45 3306 y(sub)50 b(fill_mid\(\))147
b({)155 3405 y(my)49 b($l)h(=)f(length\($_[0]\);)155
3505 y(my)g($k)h(=)f(int\(\($_[1])f(-)i($l\)/2\);)155
3605 y(\($_[2])e(x)i($k\).$_[0].\($_[2])d(x)i(\($_[1])g(-)h
(\($l+$k\)\)\);)-45 3704 y(})g(#)g(fill_mid)14 3867 y
FG(These)22 b(functions)j(are)e(used)g(to)f(report)h(to)g(STDERR)c(a)j
(single)h(char)g(for)g(each)g(record)h(processed)g(\(useful)g(for)f
(reporting)-128 3980 y(parsed)i(records\).)p Black Black
-415 4129 a Fq(84e)180 b Fp(h)p FI(Common)20 b(PERL)g(subs)h(-)f
(Counter)g Fq(84e)p Fp(i)q Ft(\021)-45 4229 y Fu(#)-45
4329 y(sub)50 b(counter)e({)i(#)f($_[0]~current_pos++)e($_[1]~char)155
4428 y(print)i(STDERR)f("$_[1]";)155 4528 y(\(\($_[0])g(\045)i(50\))f
(==)h(0\))f(&&)g(\(print)g(STDERR)g
("[".&fill_left\($_[0],6,"0"\)."]\\n"\))o(;)-45 4627
y(})h(#)g(counter)-45 4727 y(#)-45 4827 y(sub)g(counter_end)d({)j(#)g
($_[0]~current_pos)146 b($_[1]~char)155 4926 y(\(\($_[0])48
b(\045)i(50\))f(!=)h(0\))f(&&)g(\(print)g(STDERR)g
("[".&fill_left\($_[0],6,"0"\)."]\\n"\))o(;)-45 5026
y(})h(#)g(counter_end)p Black Black -407 5225 a Fq(84f)180
b Fp(h)p FI(Global)20 b(V)-9 b(ar)o(s)21 b(-)f(Counter)g
Fq(84f)p Fp(i)q Ft(\021)-45 5325 y Fu(my)50 b(\($n,$c\);)e(#)i(counter)
e(and)i(char)f(\(for)g(&counter)f(function\))-128 5621
y FD(C.1.4)91 b(Common)23 b(functions)g(f)n(or)h(r)n(eporting)g(pr)n
(ogram)h(pr)n(ocesses)-128 5795 y FG(Function)38 b(')p
FB(report)p FG(')33 b(requires)39 b(that)d(a)g(hash)h(v)n(ariable)h(')p
FB(\045MessageList)p FG(')31 b(has)36 b(been)h(set,)j(such)d(hash)g
(contains)h(the)-128 5908 y(strings)26 b(for)e(each)h(report)g(message)
g(we)e(will)h(need.)31 b(The)23 b(\002rst)h(parameter)i(for)e(')p
FB(report)p FG(')d(is)j(a)f(k)o(e)o(y)h(for)g(that)h(hash,)f(in)g
(order)p Black -128 6076 V -128 6180 a FK(Genome)c(Inf)n(ormatics)g
(Resear)o(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h
(Guig\363,)e(R)1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black
eop
%%Page: 85 90
85 89 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(C.2.)22 b Fx(A)-8 b(WK)22 b(scripts)2545 b FG(85)p
-128 -243 4016 9 v Black -128 35 a(to)32 b(retrie)n(v)o(e)h(the)g
(message)g(string,)i(the)d(other)h(parameters)h(passed)f(are)f
(processed)j(by)d(the)g FB(sprintf)c FG(function)34 b(on)e(that)-128
148 y(string.)p Black Black -415 297 a Fq(85a)180 b Fp(h)p
FI(Common)20 b(PERL)g(subs)h(-)f(STDERR)g Fq(85a)p Fp(i)q
Ft(\021)-45 397 y Fu(sub)50 b(report\(\))e({)i(print)f(STDERR)f
(sprintf\($MessageList{)e(shift)j(@_)g(},@_\))g(})14
559 y FG(The)24 b(same)h(happens)i(to)d(')p FB(warn)p
FG(')f(function)k(which)e(also)h(requires)h(a)d(hash)i(v)n(ariable)g(')
p FB(\045ErrorList)p FG(')20 b(containing)28 b(the)-128
672 y(error)d(messages.)p Black Black -420 822 a Fq(85b)181
b Fp(h)p FI(Common)20 b(PERL)g(subs)h(-)f(STDERR)g Fq(85a)p
Fp(i)q Fo(+)p Ft(\021)-45 921 y Fu(sub)50 b(warn\(\))e({)i(print)f
(STDERR)g(sprintf\($ErrorList{)d(shift)j(@_)g(},)h(@_\))f(})-128
1220 y FL(C.2)100 b(A)-13 b(WK)24 b(scripts)p Black Black
-415 1381 a Fq(85c)180 b Fp(h)p FI(GA)-8 b(WK)22 b(shebang)c
Fq(85c)p Fp(i)q Ft(\021)-45 1481 y Fu(#!/usr/bin/gawk)47
b(-f)-45 1581 y(#)j(GNU)f(Awk)h(3.0.4)-45 1680 y Fp(h)p
FI(V)-9 b(er)o(sion)21 b(Contr)l(ol)f(Id)g(T)-8 b(a)o(g)21
b Fq(85g)p Fp(i)-128 1979 y FL(C.3)100 b(B)m(ASH)25 b(scripts)p
Black Black -420 2140 a Fq(85d)181 b Fp(h)p FI(B)n(ASH)20
b(shebang)f Fq(85d)p Fp(i)q Ft(\021)-45 2240 y Fu(#!/usr/bin/bash)-45
2340 y(#)50 b(GNU)f(bash,)g(version)g(2.03.6\(1\)-release)d
(\(i386-redhat-linux-gnu\))-45 2439 y Fp(h)p FI(V)-9
b(er)o(sion)21 b(Contr)l(ol)f(Id)g(T)-8 b(a)o(g)21 b
Fq(85g)p Fp(i)p Black Black -415 2638 a Fq(85e)180 b
Fp(h)p FI(B)n(ASH)20 b(script)h(start)g Fq(85e)p Fp(i)q
Ft(\021)-45 2738 y Fp(h)p FI(B)n(ASH)f(shebang)f Fq(85d)p
Fp(i)-45 2838 y Fu(#)-45 2937 y(SECONDS=0)49 b(#)g(Reset)g(Timing)-45
3037 y(#)h(Which)f(script)g(are)g(we)g(running...)-45
3137 y(L="####################")-45 3236 y({)h(echo)f("$L$L$L$L";)55
3336 y(echo)g("###)g(RUNNING)g([$0]";)55 3435 y(echo)g("###)g(Current)g
(date:`date`";)55 3535 y(echo)g("###";)g(})g(1>&2;)p
Black Black -407 3734 a Fq(85f)180 b Fp(h)p FI(B)n(ASH)20
b(script)h(end)f Fq(85f)p Fp(i)q Ft(\021)-45 3834 y Fu({)50
b(echo)f("###";)g(echo)g("###)g(Execution)f(time)h(for)g([$0])g(:)h
($SECONDS)e(secs";)55 3934 y(echo)h("$L$L$L$L";)55 4033
y(echo)g("";)g(})h(1>&2;)-45 4133 y(#)-45 4232 y(exit)g(0)-128
4531 y FL(C.4)100 b(V)-10 b(ersion)25 b(contr)n(ol)g(tags)-128
4706 y FG(This)20 b(document)h(is)f(under)h(Re)n(vision)g(Control)f
(System)g(\(RCS\).)e(The)h(v)o(ersion)i(you)g(are)f(currently)i
(reading)f(is)f(the)g(follo)n(wing:)p Black Black -420
4855 a Fq(85g)181 b Fp(h)p FI(V)-9 b(er)o(sion)21 b(Contr)l(ol)f(Id)g
(T)-8 b(a)o(g)20 b Fq(85g)p Fp(i)r Ft(\021)-45 4955 y
Fu(#)50 b($Id:)f(humus.nw,v)f(1.4)h(2002/02/15)f(17:29:05)h(jabril)f
(Exp)i($)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 86 91
86 90 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(D.)22 b(Extracting)k(code)e(blocks)h(from)f(this)g(document)1509
b(86)p -128 -243 4016 9 v Black -128 35 a FM(D)120 b(Extracting)30
b(code)g(blocks)g(fr)n(om)f(this)h(document)-128 242
y FG(From)23 b(this)h(\002le)f(we)g(can)h(obtain)h(both)f(the)g(code)g
(and)g(the)g(documentation.)32 b(The)24 b(follo)n(wing)h(instructions)h
(are)e(needed:)-128 491 y FL(D)n(.1)100 b(Extracts)25
b(Script)h(code)g(chunks)g(fr)n(om)g(the)h Fk(N)t(OW)t(E)t(B)32
b FL(\002le)-128 665 y FG(Remember)f(when)f(tangling)j(that)e('-L)-8
b(')30 b(option)i(allo)n(ws)e(you)h(to)g(include)h(program)f
(line-numbering)j(relati)n(v)o(e)e(to)e(original)-126
778 y Fz(N)t(O)r(W)t(E)t(B)h FG(\002le.)43 b(Then)28
b(the)h(\002rst)f(line)h(of)f(the)h(e)o(x)o(ecutable)i(\002les)d(is)g
(a)g(comment,)i(not)f(a)f(shebang,)k(and)d(must)f(be)g(remo)o(v)o(ed)h
(to)-128 891 y(mak)o(e)24 b(scripts)h(runnable.)p Black
Black -415 1040 a Fq(86a)180 b Fp(h)p FI(tangling)19
b(pr)l(o)o(gr)o(ams)h Fq(86a)p Fp(i)q Ft(\021)-45 1140
y Fp(h)p FI(tangling:)f(perl)h(modules)g Fq(63b)p Fp(i)-45
1240 y(h)p FI(tangling:)f(mySQL)h(perl)h(scripts)g Fq(46b)p
Fp(i)-45 1339 y(h)p FI(tangling:)e(perl)h(scripts)i Fq(31a)p
Fp(i)-45 1439 y(h)p FI(tangling:)d(perl)h(Tk)h(scripts)g
Fq(76a)p Fp(i)p Black Black -420 1638 a Fq(86b)181 b
Fp(h)p FI(e)n(xamples)21 b(of)f(tangling)f(commands)f
Fq(86b)p Fp(i)r Ft(\021)-45 1738 y Fu(#)50 b(showing)f(line)g
(numbering)f(comments)g(in)i(program)-45 1837 y(notangle)f(-L)g
(-R"humus")f($WORK/$nwfile.nw)f(|)j(\\)105 1937 y(perl)f(-ne)g('$.>1)g
(&&)h(print')e(|)i(cpif)f($BIN/humus)f(;)-45 2037 y(is_exec)h
($BIN/humus)f(;)-45 2136 y(#)i(reformating)e(program)g(with)h(perltidy)
-45 2236 y(notangle)g(-R"humus")f($WORK/$nwfile.nw)f(|)i(\\)155
2336 y(perltidy)f(-)i(|)f(cpif)g($BIN/humus)f(;)-45 2435
y(#)i(html)f(pretty-printing)e(program)i(with)g(perltidy)-45
2535 y(notangle)g(-R"humus")f($WORK/$nwfile.nw)f(|)i(\\)155
2634 y(perltidy)f(-html)h(-)h(|)f(cpif)g($DOCS/html/humus.html)d(;)-45
2734 y(#)-128 3033 y FL(D)n(.2)100 b(Extracting)25 b(differ)n(ent)i
(Con\002g)e(Files)p Black Black -415 3194 a Fq(86c)180
b Fp(h)p FI(tangling)19 b(par)o(am)h(\002les)g Fq(86c)p
Fp(i)q Ft(\021)-45 3294 y Fp(h)p FI(tangling:)f(mySQL)h(scripts)h
Fq(43a)p Fp(i)-45 3393 y(h)p FI(tangling:)e(mySQL)h(par)o(am)f
Fq(43d)p Fp(i)-128 3692 y FL(D)n(.3)100 b(Extracting)25
b(documentation)i(and)e(L)1472 3669 y Ff(A)1505 3692
y FL(T)1554 3715 y(E)1610 3692 y(X'ing)g(it)p Black Black
-420 3853 a Fq(86d)181 b Fp(h)p FI(tangling)19 b(complementary)g(LaT)-8
b(eX)20 b(\002les)h Fq(86d)p Fp(i)q Ft(\021)-45 3953
y Fu(notangle)49 b(-R"HIDE:)f(LaTeX)h(new)g(definitions")f
($WORK/$nwfile.nw)f(|)i(\\)155 4053 y(cpif)g($DOCS/defs.tex)e(;)-45
4152 y(notangle)i(-R"HIDE:)f(TODO")h($WORK/$nwfile.nw)e(|)i(cpif)g
($DOCS/todo.tex)f(;)p Black Black -415 4351 a Fq(86e)180
b Fp(h)p FI(weaving)20 b Fq(86e)p Fp(i)q Ft(\021)-45
4451 y Fp(h)p FI(B)n(ASH)g(script)h(start)g Fq(85e)p
Fp(i)-45 4551 y Fu(#)50 b(weaving)f(and)g(LaTeXing)-45
4650 y Fp(h)p FI(B)n(ASH)20 b(En)m(vir)l(onment)f(V)-9
b(ariables)19 b Fq(87c)p Fp(i)-45 4750 y(h)p FI(tangling)g
(complementary)g(LaT)-8 b(eX)20 b(\002les)h Fq(86d)p
Fp(i)-45 4850 y Fu(noweave)49 b(-v)g(-t4)h(-delay)e(-x)i(-filter)e
('elide)h("HIDE:)g(*"')g(\\)354 4949 y($WORK/$nwfile.nw)e(|)i(cpif)g
($DOCS/$nwfile.tex)e(;)-45 5049 y(#)j(noweave)f(-t4)g(-delay)g(-index)f
($WORK/$nwfile.nw)f(>)j($DOCS/$nwfile.tex)-45 5148 y(pushd)f($DOCS/)g
(;)-45 5248 y(#)-45 5348 y(latex)g($nwfile.tex)f(;)-45
5447 y(dvips)h($nwfile.dvi)f(-o)i($nwfile.ps)d(-t)j(a4)f(;)-45
5547 y(#)-45 5647 y(popd;)-45 5746 y Fp(h)p FI(B)n(ASH)20
b(script)h(end)f Fq(85f)p Fp(i)p Black -128 6076 V -128
6180 a FK(Genome)g(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282
b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 87 92
87 91 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(D.4.)22 b Fx(De\002ning)i(w)o(orking)h(shell)g(v)n(ariables)g(for)
f(the)g(current)h(project)1005 b FG(87)p -128 -243 4016
9 v Black Black Black -415 35 a Fq(87a)180 b Fp(h)p FI(LaT)-8
b(eXing)20 b Fq(87a)p Fp(i)r Ft(\021)-45 134 y Fp(h)p
FI(B)n(ASH)g(script)h(start)g Fq(85e)p Fp(i)-45 234 y
Fu(#)50 b(only)f(LaTeXing)-45 334 y Fp(h)p FI(B)n(ASH)20
b(En)m(vir)l(onment)f(V)-9 b(ariables)19 b Fq(87c)p Fp(i)-45
433 y Fu(pushd)49 b($DOCS/)g(;)-45 533 y(#)-45 632 y(echo)h("###)f
(RUNNING)f(LaTeX)h(on)g($nwfile.tex")f(1>&2)h(;)-45 732
y(latex)g($nwfile.tex)f(;)-45 832 y(latex)h($nwfile.tex)f(;)-45
931 y(latex)h($nwfile.tex)f(;)-45 1031 y(dvips)h($nwfile.dvi)f(-o)i
($nwfile.ps)d(-t)j(a4)f(;)-45 1131 y(#)-45 1230 y(#)h(pdflatex)e
($nwfile.tex)g(;)-45 1330 y(echo)i("###)f(CONVERTING)f(PS)h(to)g(PDF:)g
($nwfile")g(1>&2)g(;)-45 1429 y(ps2pdf)g($nwfile.ps)f($nwfile.pdf)g(;)
-45 1529 y(#)-45 1629 y(popd)i(;)-45 1728 y Fp(h)p FI(B)n(ASH)20
b(script)h(end)f Fq(85f)p Fp(i)-128 2027 y FL(D)n(.4)100
b(De\002ning)25 b(w)o(orking)h(shell)e(v)o(ariables)h(f)n(or)f(the)i
(curr)n(ent)h(pr)n(oject)p Black Black -420 2188 a Fq(87b)181
b Fp(h)p FI(tangling)19 b(shell)i(variables)f Fq(87b)p
Fp(i)q Ft(\021)-45 2288 y Fu(#)-45 2388 y(#)50 b(BASH)f(Environment)f
(Variables)-45 2487 y(echo)i("#)f(Running)f(notangle)h(on)g
($nwfile.nw:)f(.bash_VARS";)-45 2587 y(notangle)h(-R'BASH)f
(Environment)g(Variables')g($WORK/$nwfile.nw)f(|)i(\\)404
2686 y(cpif)g($WORK/.bash_VARS)e(;)-45 2786 y(echo)j("#)f(Running)f
(notangle)h(on)g($nwfile.nw:)f(.project_VARS";)-45 2886
y(notangle)h(-R'BASH)f(Project)h(Variables')f($WORK/$nwfile.nw)f(|)i
(\\)404 2985 y(cpif)g($WORK/.project_VARS)d(;)-45 3085
y(#)k(source)f($WORK/.bash_VARS)e(;)-45 3185 y(#)p Black
Black -415 3384 a Fq(87c)180 b Fp(h)p FI(B)n(ASH)20 b(En)m(vir)l
(onment)f(V)-9 b(ariables)19 b Fq(87c)p Fp(i)q Ft(\021)-45
3484 y Fu(#)-45 3583 y(#)50 b(Setting)f(Global)f(Variables)-45
3683 y(#)i(WORK)f(is)h(set)f(by)g("setcwd")-45 3782 y(WBIN="$WORK/bin")
e(;)-45 3882 y(WPARAM="$BIN/param")g(;)-45 3982 y(WSRC="$WORK/src")g(;)
j(#)g(where)e(to)i(put)f(the)g(distributable)f(files)-45
4081 y(DOCS="$WORK/docs")f(;)-45 4181 y(DATA="$WORK/data")g(;)-45
4281 y(TEST="$WORK/tests")g(;)-45 4380 y(nwfile="humus")h(;)-45
4480 y(export)h(WBIN)g(WPARAM)g(WSRC)g(DOCS)g(DATA)g(TEST)g(nwfile)g(;)
-45 4579 y(#)-45 4679 y(source)g($WORK/.project_VARS)d(;)p
Black Black -420 4878 a Fq(87d)181 b Fp(h)p FI(B)n(ASH)20
b(Pr)l(oject)h(V)-9 b(ariables)19 b Fq(87d)p Fp(i)r Ft(\021)-45
4978 y Fu(#)-45 5078 y(umask)49 b(002)h(;)-45 5177 y(#)-45
5277 y(BASE="/projects")d(;)-45 5376 y(HUMUS="$BASE/H.sapiens")f(;)-45
5476 y(BBIN="/usr/local/molbio/share/sgp")e(;)-45 5576
y(BIN="$BBIN/bin")j(;)-45 5675 y(MySQLPAR="$BBIN/mySQL")f(;)-45
5775 y(LIBPERL="$BBIN/libperl")g(;)-45 5875 y(LIBSTEP="$BBIN/libstep")g
(;)p Black -128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g
(Resear)o(ch)g(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h
(Guig\363,)e(R)1023 b FK(Mar)o(ch)20 b(6,)g(2002)p Black
eop
%%Page: 88 93
88 92 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(D.4.)22 b Fx(De\002ning)i(w)o(orking)h(shell)g(v)n(ariables)g(for)
f(the)g(current)h(project)1005 b FG(88)p -128 -243 4016
9 v Black -45 35 a Fu(SRC="$BBIN/src")47 b(;)-45 134
y(export)i(BASE)g(HUMUS)g(BBIN)g(BIN)g(MySQLPAR)g(LIBPERL)f(LIBSTEP)h
(SRC)g(;)-45 234 y(#)-45 334 y Fp(h)p FI(B)n(ASH)20 b(V)-9
b(ariables:)19 b(P)-7 b(erl)21 b Fq(43c)p Fp(i)-45 433
y Fu(#)-45 533 y Fp(h)p FI(B)n(ASH)f(Basic)h(Shell)e(Functions)g
Fq(88)p Fp(i)-45 632 y(h)p FI(B)n(ASH)h(Functions:)f(Handling)f(lar)m
(g)o(e)i(dir)m(ectories)h Fq(89a)p Fp(i)-45 732 y(h)p
FI(B)n(ASH)f(Functions:)f(F)l(iltering)h(GENEID)g(RA)-8
b(W)21 b(Output)e Fq(89b)p Fp(i)-45 832 y(h)p FI(B)n(ASH)h(Functions:)f
(Get)h(Gene)g(Number)h(fr)l(om)f(GENEID)h(Output)e Fq(89c)p
Fp(i)-45 931 y(h)p FI(B)n(ASH)h(Functions:)f(Gene-Pr)m(ediction)f
(Evaluation)g Fq(90)p Fp(i)-45 1031 y Fu(#)p Black Black
-382 1230 a Fq(88)180 b Fp(h)p FI(B)n(ASH)20 b(Basic)h(Shell)e
(Functions)g Fq(88)p Fp(i)q Ft(\021)-45 1330 y Fu(#)-45
1429 y(#)50 b(BASIC)f(Shell)g(Functions)-45 1529 y(#)-45
1629 y(function)g(TheEnd)f({)55 1728 y(#)55 1828 y(#)i(USAGE:)e(TheEnd)
h(<STATUS_KEY>)55 1928 y(#)h(PSRF)f(is)g(Process)g(Status)f(Reporter)h
(File)55 2027 y(if)h([)f("$PSRF")g(])g(;)55 2127 y(then)205
2227 y(SCODE=`\()f($BIN/exit.pl)f($1)j(|)f(tee)h($PSRF)f(\))g(2>)h
(/dev/null`)e(;)55 2326 y(else)205 2426 y(SCODE=3)g(;)i(#)f
(UNAVAILABLE)55 2525 y(fi)h(;)55 2625 y(exit)f($SCODE)g(;)-45
2725 y(})-45 2824 y(#)-45 2924 y(function)g(CheckDirs)f({)55
3024 y(#)55 3123 y(#)i(USAGE:)e(ChckDirs)h(<path_list>)55
3223 y(#)55 3322 y(for)g(name)g(in)h("$@")f(;)155 3422
y(do)g({)404 3522 y(if)g([)h(-d)f("$name")g(])g(;)404
3621 y(then)503 3721 y(echo)g("###)h(Directory)e(Already)g(Exist:)h
($name")g(;)404 3821 y(elif)g(mkdir)g($name)g(2>)g(/dev/null)f(;)503
3920 y(then)603 4020 y(echo)h("###)g(Making)g(New)g(Directory)148
b(:)49 b($name")g(;)404 4119 y(else)503 4219 y(echo)g("###)h(CANNOT)e
(Create)h(Directory:)f($name")h(;)503 4319 y(TheEnd)g(NONEWDIR)f(;)404
4418 y(fi)h(;)254 4518 y(})h(;)155 4618 y(done)f(;)-45
4717 y(})-45 4817 y(#)-45 4916 y(function)g(is_exec)f(\(\))i({)55
5016 y(#)55 5116 y(#)g(USAGE:)e(is_exec)h(<filename_0>...<filename_N>)
55 5215 y(for)g(file)g(in)h($@;)155 5315 y(do)f({)404
5415 y(if)g([)h(-x)f($file)g(])h(;)404 5514 y(then)553
5614 y(chmod)f(a+x)g($file)g(2>)h(/dev/null)e(;)404 5713
y(fi)h(;)254 5813 y(})h(;)155 5913 y(done)f(;)p Black
-128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g
(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 89 94
89 93 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(D.4.)22 b Fx(De\002ning)i(w)o(orking)h(shell)g(v)n(ariables)g(for)
f(the)g(current)h(project)1005 b FG(89)p -128 -243 4016
9 v Black -45 35 a Fu(})p Black Black -415 234 a Fq(89a)180
b Fp(h)p FI(B)n(ASH)20 b(Functions:)f(Handling)f(lar)m(g)o(e)i(dir)m
(ectories)h Fq(89a)p Fp(i)q Ft(\021)-45 334 y Fu(#)-45
433 y(function)49 b(mega)g(\(\))g({)55 533 y(#)55 632
y(#)h(USAGE:)e(mega)h("<command>)f([<cmd_params>]")f(<input_dir>)h
(<pattern>)g([<output_dir>])55 732 y(#)i(EXAMPLES:)55
832 y(#)548 b(mega)49 b("mv)g(-v")g($IDIR)g("^chr2_")g($ODIR/ori)f(#)h
(moves)g(all)h(chr2_*)e(files)55 931 y(#)548 b(mega)49
b("ls)g(-a")g($IDIR)g("^[^.]*")547 b(#)49 b(lists)g(all)h(files)e
(\(not)h(.*\))55 1031 y(M_CMD="$1")f(;)55 1131 y(I_DIR=`echo)g($2)h(|)h
(sed)f('s/\\/$//'`)f(;)55 1230 y(X_PAT="$3")g(;)55 1330
y([)i("$4")f(])g(&&)h(O_DIR=`echo)e($4)h(|)h(sed)f('s/\\/$//'`)f(||)h
(O_DIR=\224)g(;)55 1429 y(ls)h(-1)f($I_DIR)g(|)g(egrep)g($X_PAT)g(-)g
(|)h(while)f(read)g(n)h(;)155 1529 y(do)f({)404 1629
y([)g("$O_DIR")g(])g(&&)h(T_DIR="$O_DIR/$n")c(||)k(T_DIR=\224)e(;)404
1728 y($M_CMD)g($I_DIR/$n)h($T_DIR)f(;)304 1828 y(})i(;)155
1928 y(done;)-45 2027 y(})-45 2127 y(#)p Black Black
-420 2326 a Fq(89b)181 b Fp(h)p FI(B)n(ASH)20 b(Functions:)f(F)l
(iltering)h(GENEID)g(RA)-8 b(W)21 b(Output)e Fq(89b)p
Fp(i)q Ft(\021)-45 2426 y Fu(#)-45 2525 y(#)50 b(Script)f(from)g
(gparra)g(to)g(retrieve)f(GFF)i(annotation)d(from)j(geneid)e(big)i
(output)-45 2625 y(geneid_raw2GFF)e(\(\))-45 2725 y({)55
2824 y(#)i(USAGE:)98 b(geneid_raw2GFF)47 b(output_dir)h(geneid_file)55
2924 y(#)i(filtering)e(geneid)h(output)f(\(obtained)g(with)h("-D")g
(option)g(->)h(default)e(output+cDNA\))55 3024 y(PD=$1)h(;)55
3123 y(/bin/rm)g(-vf)g($PD/gff/*)f($PD/prot/*)g($PD/cds/*)g(;)55
3223 y(gawk)h('BEGIN{)g(OFS="\\t";)f(odir=ARGV[1];)f(ARGV[1]="")h(})155
3322 y({)h(if)h(\($2=="Sequence"\))d(seqname=$3;)254
3422 y(if)j(\($2=="Gene"\))d(gene=$3;)254 3522 y(if)j(\(NF>8)f(&&)g
(substr\($1,1,1\)!="#")d(&&)k($1!="Annotation"\))354
3621 y(print)f(seqname,"geneid_v1.1",$1,$2,$3,$4,)o($5,$6,)o(seqna)o
(me"_"g)o(ene)44 b(\\)653 3721 y(>)49 b(odir)h("/gff/")e
(seqname"_"gene;)254 3821 y(if)i(\(substr\($1,1,1\)==">"\))c({)354
3920 y(if)j(\(substr\($1,length\($1\)-1,2\)=="NN"\))44
b({)454 4020 y(print)k(">"seqname"_"gene)f(>)j(odir)f("/cds/")f
(seqname"_"gene;)454 4119 y(bol=1;)354 4219 y(})i(else)f(if)g
(\(substr\($1,length\($1\)-1,2\)=="AA"\))44 b({)454 4319
y(print)k(">"seqname"_"gene)f(>)j(odir)f("/prot/")f(seqname"_"gene;)454
4418 y(bol=2;)354 4518 y(};)254 4618 y(})i(else)f({)354
4717 y(if)g(\(bol==1)g(&&)g(NF==1)g(&&)h(substr\($1,1,1\)!=">")c(\))454
4817 y(print)i($0)i(>)g(odir)f("/cds/")f(seqname"_"gene;)254
4916 y(};)254 5016 y(if)i(\(bol==2)e(&&)i(NF==1)f(&&)g
(substr\($1,1,1\)!=">")d(\))354 5116 y(print)j($0)g(>)h(odir)f
("/prot/")f(seqname"_"gene;)155 5215 y(}')h($PD)g($2)h(;)-45
5315 y(})-45 5415 y(#)p Black Black -415 5614 a Fq(89c)180
b Fp(h)p FI(B)n(ASH)20 b(Functions:)f(Get)h(Gene)g(Number)h(fr)l(om)f
(GENEID)h(Output)e Fq(89c)p Fp(i)q Ft(\021)-45 5713 y
Fu(#)-45 5813 y(#)50 b(Counting)e(gene)h(number)g(found)g(in)g(geneid)g
(output)-45 5913 y(get_geneid_genes)e(\(\))p Black -128
6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)
282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Page: 90 95
90 94 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(D.4.)22 b Fx(De\002ning)i(w)o(orking)h(shell)g(v)n(ariables)g(for)
f(the)g(current)h(project)1005 b FG(90)p -128 -243 4016
9 v Black -45 35 a Fu({)55 134 y(#)55 234 y(#)50 b(USAGE:)e
(get_geneid_genes)f(geneid_out.gff)g(>)j(gene_list.rpt)55
334 y(#)55 433 y(gawk)f('{)254 533 y(genes[$9]++;)254
632 y(if)h(\(genes[$9]>1\))d({)354 732 y(min[$9])h(=)i($4<min[$9])e(?)i
($4)f(:)h(min[$9])e(;)354 832 y(max[$9])g(=)i($5>max[$9])e(?)i($5)f(:)h
(max[$9])e(;)254 931 y(})i(else)f({)354 1031 y(min[$9])f(=)i($4)g(;)354
1131 y(max[$9])e(=)i($5)g(;)354 1230 y(strand[$9])e(=)i($7;)254
1330 y(};)254 1429 y(len[$9]+=$5-$4+1)155 1529 y(})155
1629 y(END)f({)254 1728 y(for)h(\(n)f(in)g(genes\))g({)354
1828 y(print)g(n,)g(min[n],)g(max[n],)f(strand[n],)g(len[n],genes[n];)
254 1928 y(};)155 2027 y(})55 2127 y(')i($1)f(|)h(sort)f(+1n)g(+2n)g
(-3)h(-)f(;)-45 2227 y(})-45 2326 y(#)p Black Black -382
2525 a Fq(90)180 b Fp(h)p FI(B)n(ASH)20 b(Functions:)f(Gene-Pr)m
(ediction)f(Evaluation)g Fq(90)p Fp(i)q Ft(\021)-45 2625
y Fu(#)-45 2725 y(#)50 b(PREPARING)e(EVALUATION)g(STUFF)-45
2824 y(export)h(GENEIDVERSION="geneid)d(v1.1")j(;)-45
2924 y(#)-45 3024 y(run_evaluation)f(\(\))-45 3123 y({)55
3223 y(#)55 3322 y(#)i(USAGE:)55 3422 y(#)249 b(run_evaluation)47
b(#chrom)i(program)f(param)348 b(prog_results_dir)47
b(\\)55 3522 y(#)996 b(annotation_dir)545 b(testset)99
b(lenght)55 3621 y(#)50 b(Ex:)f(run_evaluation)e(22)249
b(geneid)98 b(Hsap.masked)48 b($ANALYSIS/geneid)f(\\)55
3721 y(#)996 b($DATASETS/annotation/all)45 b(all)50 b(;)55
3821 y(#)55 3920 y(CHR="$1")e(;)55 4020 y(prog="$2")g(;)55
4119 y(PROG=`echo)g($prog)h(|)h(tr)f(a-z)g(A-Z`)g(;)55
4219 y(RUN="$3")f(;)55 4319 y(BASE="$4")g(;)55 4418 y
(RESULTS="$BASE/gff/chr$CHR")d(;)55 4518 y(SUBSET="$6")j(;)55
4618 y(TESTSET="$5/chr$CHR")e(;)55 4717 y(LENSEQ="$7";)55
4817 y(FINALTESTSET="/tmp/tmp$$")f(;)55 4916 y
(LONG_OUTPUT="$BASE/eval_$prog.$RUN.c)o(hr${C)o(HR}_$)o(SUBSET)o(")f(;)
55 5016 y(SHORT_OUTPUT="$BASE/eval_${prog}_bri)o(ef.$R)o(UN.ch)o
(r${CHR)o(}_$SU)o(BSET")f(;)55 5116 y(GVER="-----------------)j
(<${GENEIDVERSION}>)g(-----------------";)55 5215 y(#)k(EVALUATION)e
(tool)h(command-line)e(options:)55 5315 y(#)100 b(-v:)49
b(Verbose.)f(Print)h(all)g(messages)55 5415 y(#)100 b(-a:)49
b(Average.)f(Print)h(average)f(stats)h(\(more)g(than)g(1)h(sequence\))
55 5514 y(#)100 b(-t:)49 b(Total.)f(Print)h(total)g(stats)g(\(more)g
(than)g(1)h(sequence\))55 5614 y(#)100 b(-s:)49 b(Short.)f(Print)h(a)h
(short)f(output)55 5713 y(#)h(TEMPORAL)e(FILE)h(ADDING)g(A)g(RECORD)g
(WITH)g(THE)g(LENGHT)g(OF)h(THE)f(SEQUENCE)55 5813 y(gawk)g
("BEGIN{OFS=\\"\\t\\";\\)354 5913 y(print)g
(\\"chr\\"$CHR,1,\\"Sequences\\",1,$LEN)o(SEQ,\\")o(.\\",\\)o(".\\",\\)
o(".\\",)o(1}\\)p Black -128 6076 V -128 6180 a FK(Genome)20
b(Inf)n(ormatics)g(Resear)o(ch)g(Lab)282 b Fy(Abril,)20
b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023 b FK(Mar)o(ch)20
b(6,)g(2002)p Black eop
%%Page: 91 96
91 95 bop Black -128 -285 a FD(Human)22 b(+)h(Mouse)91
b FG(D.5.)22 b Fx(Extracting)k(code)e(blocks)h(for)f(all)g(the)g
(scripts)1539 b FG(91)p -128 -243 4016 9 v Black 354
35 a Fu({print}")48 b($TESTSET)h(>)g(/tmp/tmp$$;)55 134
y(#)h(/tmp/tmp$$)e(temporal)g(file)h(containing)f(lenght+annotation)f
(gff)i(records)55 234 y({)h(echo)f("###")g(;)g(echo)g("###)g
(EVALUATION)f(of)i($PROG)f(RESULTS)f(on)i(CHR)f($CHR)g(\($RUN\)")f(;)i
(echo)f("###")g(;)155 334 y(echo)g("###)g($LONG_OUTPUT")e(;)j(echo)f
("###")g(;)155 433 y(echo)g("###)g("`whoami`")f(-)h("`date`)g(;)h(echo)
f("###")f(;)155 533 y(echo)h("###)g($GVER")g(;)g(echo)g("###")g(;)h(})f
(>)h($LONG_OUTPUT)e(;)55 632 y($SGPBIN/evaluation)f(-ta)i($RESULTS)f
($FINALTESTSET)f(\273)j($LONG_OUTPUT)e(;)55 732 y({)i(echo)f("###")g(;)
g(echo)g("###)g(EVALUATION)f(of)i($PROG)f(RESULTS)f(on)i(CHR)f($CHR)g
(\($RUN\)")f(;)i(echo)f("###")g(;)155 832 y(echo)g("###)g
($SHORT_OUTPUT")e(;)j(echo)f("###")g(;)155 931 y(echo)g("###)g
("`whoami`")f(-)h("`date`)g(;)h(echo)f("###")f(;)155
1031 y(echo)h("###)g($GVER")g(;)g(echo)g("###")g(;)h(})f(>)h
($SHORT_OUTPUT)d(;)55 1131 y($SGPBIN/evaluation)g(-tsa)i($RESULTS)f
($FINALTESTSET)f(\273)j($SHORT_OUTPUT)d(;)-45 1230 y(})-45
1330 y(#)-128 1629 y FL(D)n(.5)100 b(Extracting)25 b(code)h(blocks)f(f)
n(or)g(all)f(the)i(scripts)-128 1803 y FG(Remember)19
b(to)f(set)g(W)o(ORK)e(v)n(ariable)k(at)e(the)g(v)o(ery)h(be)o
(ggining,)i(mo)o(ving)e(into)f(the)h(corresponding)j(")p
FB(/WORK/PATH/.../)o FG(")-128 1916 y(directory)k(and)e(e)o(x)o
(ecuting)i FB(setcwd)20 b FG(\(a)j(shell)i(function)g(that)f(sets)h
FB($WORK)20 b FG(and)k(sources)h FB(.bash_VARS)p FG(\).)p
Black Black -382 2065 a Fq(91)180 b Fp(h)p FI(tangling)19
b Fq(91)p Fp(i)q Ft(\021)-45 2165 y Fu(#)-45 2265 y(#)50
b(tangling)e(all)i(.*_VARS)-45 2364 y(notangle)f(-R'tangling)f(shell)g
(variables')g($WORK/$nwfile.nw)f(|)j(bash)f(;)-45 2464
y(source)g($WORK/.bash_VARS)e(;)-45 2564 y(#)-45 2663
y(notangle)i(-Rweaving)98 b($WORK/$nwfile.nw)47 b(|)i(cpif)g
($WORK/nw2tex)f(;)-45 2763 y(notangle)h(-RLaTeXing)f($WORK/$nwfile.nw)f
(|)i(cpif)g($WORK/ltx)f(;)-45 2863 y(is_exec)h($WORK/nw2tex)f
($WORK/ltx;)-45 2962 y(#)-45 3062 y(#)i(tangling)e(all)i(steps)-45
3161 y({)g(cat)f($WORK/.bash_VARS)e(;)55 3261 y(notangle)h(-R'JOB)h
(COLLECTOR')397 b($WORK/$nwfile.nw)47 b(;)i(})h(|)f(bash)h(;)-45
3361 y(#)g(tangling)e(all)i(scripts)-45 3460 y({)g(cat)f
($WORK/.bash_VARS)e(;)55 3560 y(notangle)h(-R'tangling)g(programs')198
b($WORK/$nwfile.nw)47 b(;)i(})h(|)f(bash)h(;)-45 3660
y(#)g(tangling)e(all)i(param)f(files)-45 3759 y({)h(cat)f
($WORK/.bash_VARS)e(;)55 3859 y(notangle)h(-R'tangling)g(param)h
(files')g($WORK/$nwfile.nw)e(;)i(})h(|)f(bash)h(;)p Black
-128 6076 V -128 6180 a FK(Genome)20 b(Inf)n(ormatics)g(Resear)o(ch)g
(Lab)282 b Fy(Abril,)20 b(JF;)h(P)o(arra,)f(G;)h(Guig\363,)e(R)1023
b FK(Mar)o(ch)20 b(6,)g(2002)p Black eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
